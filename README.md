# 🔍 Citizen Intelligence Agency

> An independent, volunteer-driven OSINT platform monitoring Swedish political activity

## 🎯 Mission
The Citizen Intelligence Agency is a volunteer-driven, open-source intelligence (OSINT) project that provides comprehensive analysis of political activities in Sweden. Through advanced monitoring of key political figures and institutions, we deliver:

- 📊 Financial performance metrics
- ⚠️ Risk assessment analytics
- 📈 Political trend analysis
- 🏆 Politician ranking system
- 📉 Performance comparisons
- 🔍 Transparency insights

Our initiative remains strictly independent and non-partisan, focused on fostering informed decision-making and enhancing democratic engagement.

## ✨ Features
Explore our [comprehensive feature set](https://hack23.com/cia-features.html) including:
- 📊 Interactive dashboards
- 🏆 Political scoreboard systems
- 📈 Critical analytics tools
- 🔍 Transparency metrics
- ⚖️ Accountability measures
- 📱 Data-driven insights

For a conceptual view of our system architecture and components, see our [Architecture Documentation](ARCHITECTURE.md) and [System Mindmaps](MINDMAP.md).

## 🏢 About Hack23
- 🌐 **Website**: [www.hack23.com](https://www.hack23.com)
- 💼 **LinkedIn**: [James Sörling](https://www.linkedin.com/in/jamessorling)

## 📚 Data Sources

Our analysis is powered by authoritative Swedish government and international data sources:

| Source | Description |
|--------|-------------|
| 🏛️ [Swedish Parliament Open Data](http://data.riksdagen.se/) | Parliamentary members, committees, and official documents |
| 🗳️ [Swedish Election Authority](http://www.val.se/) | Election data, political parties, and voting results |
| 🌍 [World Bank Open Data](http://data.worldbank.org/) | Global economic indicators and demographic data |
| 💹 [Swedish Financial Management Authority](https://www.esv.se/) | Government finances and economic trends |

For more details on our data integration approach, see the [Data Integration Documentation](DATA_INTEGRATION.md).

## 🏆 Project Status

<div align="center">

[![GitHub Release](https://img.shields.io/github/v/release/Hack23/cia)](https://github.com/Hack23/cia/releases)
[![CII Best Practices](https://bestpractices.coreinfrastructure.org/projects/770/badge)](https://bestpractices.coreinfrastructure.org/projects/770)
[![OpenSSF Scorecard](https://api.securityscorecards.dev/projects/github.com/Hack23/cia/badge)](https://scorecard.dev/viewer/?uri=github.com/Hack23/cia)
[![SLSA 3](https://slsa.dev/images/gh-badge-level3.svg)](https://slsa.dev/spec/v1.0/levels)

[![Verify & Release](https://github.com/Hack23/cia/actions/workflows/release.yml/badge.svg)](https://github.com/Hack23/cia/actions/workflows/release.yml)
[![Verify PR](https://github.com/Hack23/cia/actions/workflows/codeql-analysis.yml/badge.svg)](https://github.com/Hack23/cia/actions/workflows/codeql-analysis.yml)
[![Lines of Code](https://sonarcloud.io/api/project_badges/measure?project=Hack23_cia&metric=ncloc)](https://sonarcloud.io/summary/new_code?id=Hack23_cia)

[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=Hack23_cia&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=Hack23_cia)
[![Security Rating](https://sonarcloud.io/api/project_badges/measure?project=Hack23_cia&metric=security_rating)](https://sonarcloud.io/summary/new_code?id=Hack23_cia)
[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=Hack23_cia&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=Hack23_cia)
[![Reliability Rating](https://sonarcloud.io/api/project_badges/measure?project=Hack23_cia&metric=reliability_rating)](https://sonarcloud.io/summary/new_code?id=Hack23_cia)

[![Average time to resolve an issue](https://isitmaintained.com/badge/resolution/Hack23/cia.svg)](https://isitmaintained.com/project/Hack23/cia "Average time to resolve an issue")
[![Percentage of issues still open](https://isitmaintained.com/badge/open/Hack23/cia.svg)](https://isitmaintained.com/project/Hack23/cia "Percentage of issues still open")
[![license](https://img.shields.io/github/license/Hack23/cia.svg)](https://raw.githubusercontent.com/Hack23/cia/master/citizen-intelligence-agency/LICENSE.txt)
[![FOSSA Status](https://app.fossa.io/api/projects/git%2Bgithub.com%2FHack23%2Fcia.svg?type=shield)](https://app.fossa.io/projects/git%2Bgithub.com%2FHack23%2Fcia?ref=badge_shield)
[![CLA assistant](https://cla-assistant.io/readme/badge/Hack23/cia)](https://cla-assistant.io/Hack23/cia)

</div>

## 🚀 Runtime Environment

<div align="center">

| JDK Version | Status | Release Info |
|-------------|--------|--------------|
| ![JDK-21](https://img.shields.io/badge/JDK-21-brightgreen.svg) | Supported | LTS Release |
| ![JDK-22](https://img.shields.io/badge/JDK-22-orange.svg) | Compatible | Feature Release |
| ![JDK-23](https://img.shields.io/badge/JDK-23-orange.svg) | Compatible | Feature Release |
| ![JDK-24](https://img.shields.io/badge/JDK-24-brightgreen.svg) | Supported | Future LTS |

</div>

For details on our technology lifecycle management, see the [End-of-Life Strategy](End-of-Life-Strategy.md).


## 📚 Architecture Documentation Map

<div class="documentation-map">

| Document                                            | Focus           | Description                               | Documentation Link                                                              |
| --------------------------------------------------- | --------------- | ----------------------------------------- | ------------------------------------------------------------------------------- |
| **[Architecture](ARCHITECTURE.md)**                 | 🏛️ Architecture | C4 model showing current system structure | [View Source](https://github.com/Hack23/cia/blob/master/ARCHITECTURE.md)         |
| **[Future Architecture](FUTURE_ARCHITECTURE.md)**   | 🏛️ Architecture | C4 model showing future system structure | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_ARCHITECTURE.md)         |
| **[Security Architecture](SECURITY_ARCHITECTURE.md)** | 🔐 Security     | Security architecture                     | [View Source](https://github.com/Hack23/cia/blob/master/SECURITY_ARCHITECTURE.md)         |
| **[Future Security Architecture](FUTURE_SECURITY_ARCHITECTURE.md)** | 🔐 Security     | Future Security architecture  | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_SECURITY_ARCHITECTURE.md)         |
| **[Mindmaps](MINDMAP.md)**                          | 🧠 Concept      | Current system component relationships    | [View Source](https://github.com/Hack23/cia/blob/master/MINDMAP.md)             |
| **[Future Mindmaps](FUTURE_MINDMAP.md)**            | 🧠 Concept      | Future capability evolution               | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_MINDMAP.md)      |
| **[SWOT Analysis](SWOT.md)**                        | 💼 Business     | Current strategic assessment              | [View Source](https://github.com/Hack23/cia/blob/master/SWOT.md)                |
| **[Future SWOT Analysis](FUTURE_SWOT.md)**          | 💼 Business     | Future strategic opportunities            | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_SWOT.md)         |
| **[Data Model](DATA_MODEL.md)**                     | 📊 Data         | Current data structures and relationships | [View Source](https://github.com/Hack23/cia/blob/master/DATA_MODEL.md)          |
| **[Future Data Model](FUTURE_DATA_MODEL.md)**       | 📊 Data         | Enhanced political data architecture      | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_DATA_MODEL.md)   |
| **[Flowcharts](FLOWCHART.md)**                      | 🔄 Process      | Current data processing workflows         | [View Source](https://github.com/Hack23/cia/blob/master/FLOWCHART.md)           |
| **[Future Flowcharts](FUTURE_FLOWCHART.md)**        | 🔄 Process      | Enhanced AI-driven workflows              | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_FLOWCHART.md)    |
| **[State Diagrams](STATEDIAGRAM.md)**               | 🔄 Behavior     | Current system state transitions          | [View Source](https://github.com/Hack23/cia/blob/master/STATEDIAGRAM.md)        |
| **[Future State Diagrams](FUTURE_STATEDIAGRAM.md)** | 🔄 Behavior     | Enhanced adaptive state transitions       | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_STATEDIAGRAM.md) |
| **[CI/CD Workflows](WORKFLOWS.md)**                 | 🔧 DevOps       | Current automation processes              | [View Source](https://github.com/Hack23/cia/blob/master/WORKFLOWS.md)           |
| **[Future Workflows](FUTURE_WORKFLOWS.md)**         | 🔧 DevOps       | Enhanced CI/CD with ML                    | [View Source](https://github.com/Hack23/cia/blob/master/FUTURE_WORKFLOWS.md)    |
| **[End-of-Life Strategy](End-of-Life-Strategy.md)** | 📅 Lifecycle    | Maintenance and EOL planning              | [View Source](https://github.com/Hack23/cia/blob/master/End-of-Life-Strategy.md) |
| **[Financial Security Plan](FinancialSecurityPlan.md)** | 💰 Security | Cost and security implementation          | [View Source](https://github.com/Hack23/cia/blob/master/FinancialSecurityPlan.md) |
| **[CIA Features](https://hack23.com/cia-features.html)** | 🚀 Features | Platform features overview                | [View on hack23.com](https://hack23.com/cia-features.html)                     |

</div>

## 🔒 Reporting Security Issues

Please follow the instructions in our [SECURITY.md](https://github.com/Hack23/cia/blob/master/SECURITY.md) file for reporting security issues.

## 🔧 Project Technology Stack

<div align="center">

### 📚 Core Technology Stack

This document provides a high-level overview of the key technologies used within the **Citizen Intelligence Agency (CIA)** project. Each technology plays a vital role in supporting CIA’s goals for data analysis, security, and scalability within the political intelligence domain.

| **Category**              | **Technologies**                                                                                                                                                   |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Core Framework**        | [Spring Framework](https://spring.io/projects/spring-framework)                                                                                                   |
| **Security**              | [Spring Security](https://spring.io/projects/spring-security), [Bouncy Castle](https://www.bouncycastle.org/)                                                     |
| **Data Access**           | [Hibernate](https://hibernate.org/orm/), [JPA](https://jakarta.ee/specifications/persistence/), [PostgreSQL](https://www.postgresql.org/), [JDBC](https://docs.oracle.com/javase/tutorial/jdbc/overview/index.html) |
| **Transaction Management**| [Narayana](https://narayana.io/) (Integrated with Spring `JpaTransactionManager`)                                           |
| **Data Auditing**         | [Javers](https://javers.org/)                                                                                                                                     |
| **Business Rules Engine** | [Drools](https://www.drools.org/)                                                                                                                                 |
| **Messaging**             | [ActiveMQ Artemis](https://activemq.apache.org/components/artemis/), [Spring JMS](https://spring.io/projects/spring-framework)                                    |
| **Web/UI Layer**          | [Vaadin](https://vaadin.com/), [Vaadin Sass Compiler](http://vaadin.com/), [Vaadin Themes](https://vaadin.com/)                                                  |
| **Monitoring**            | [JavaMelody](https://github.com/javamelody/javamelody), [AWS SDK for CloudWatch](https://aws.amazon.com/cloudwatch/)                                              |
| **Testing**               | [JUnit](https://junit.org/), [Mockito](https://site.mockito.org/), [Spring Test](https://docs.spring.io/spring-framework/docs/current/reference/html/testing.html), [Selenium WebDriver](https://www.selenium.dev/documentation/en/webdriver/) |
| **Utilities**             | [Apache Commons](https://commons.apache.org/), [Google Guava](https://guava.dev/), [SLF4J](http://www.slf4j.org/), [Logback](https://logback.qos.ch/), [Jackson](https://github.com/FasterXML/jackson) |
| **Build & Dependency Management** | [Maven](https://maven.apache.org/)                                                                                                                           |

## Stack Summary

This stack comprises:

- **Core Framework**: The project uses **Spring Framework** to provide a foundation for dependency injection, component management, and service configuration across modules.
- **Security**: **Spring Security** manages authentication and authorization, complemented by **Bouncy Castle** for cryptographic operations.
- **Data Access**: A combination of **Hibernate**, **JPA**, and **PostgreSQL** supports robust ORM-based data persistence, with **JDBC** facilitating additional database connectivity needs.
- **Transaction Management**: The project uses **Narayana** as the transaction manager implementation, integrated with **Spring’s JpaTransactionManager** for distributed transaction support and ensuring transactional integrity.
- **Data Auditing**: **Javers** provides auditing and historical versioning, allowing for tracking and comparing changes to data over time.
- **Business Rules Engine** : **Drools** is integrated into the CIA project to enable a robust business rules engine.
- **Messaging**: **ActiveMQ Artemis** and **Spring JMS** enable asynchronous communication between application components, supporting distributed and event-driven designs.
- **Web/UI Layer**: **Vaadin** powers the UI with a server-driven architecture, providing components like **Vaadin Themes** and **Sass Compiler** for a rich, interactive frontend experience directly in Java.
- **Monitoring**: **JavaMelody** and **AWS SDK for CloudWatch** provide real-time application monitoring and logging capabilities, supporting both local and cloud environments.
- **Testing**: **JUnit**, **Mockito**, **Spring Test** and **Selenium WebDriver** are used extensively for unit, integration, system, browser and mock testing to ensure application reliability and robustness.
- **Utilities**: **Apache Commons**, **Google Guava**, **SLF4J**, and **Logback** offer utility functions and structured logging, enhancing application maintainability and monitoring.
- **Build & Dependency Management**: **Maven** handles project builds, dependency management, and plugin configurations, enabling smooth project management and modular builds.

</div>

## ☁️ AWS Services Stack

<div align="center">

### AWS Infrastructure Components

This document provides a comprehensive summary of the AWS services utilized in the **Citizen Intelligence Agency (CIA)** project infrastructure, as defined by its CloudFormation template. These services work together to ensure a secure, resilient, and scalable deployment environment.

| **Category**                  | **AWS Services**                                                                                                                                                                                                                       | **NIST CSF Function, Category & Subcategory**                                                                                                                                                                                                                                     | **ISO 27001:2022 Control & Link**                                                                                                                                                                                                                                                                                            |
|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Networking and Security**   | - [Amazon VPC](https://aws.amazon.com/vpc/): Configures a custom network environment with public/private subnets, route tables, NAT Gateway, Network ACLs (NACLs) for traffic control, and VPC Flow Logs.<br> - [VPC Endpoints](https://docs.aws.amazon.com/vpc/latest/privatelink/): Enables private access to AWS services (e.g., S3, EC2, SSM, CloudWatch Logs).<br> - [AWS WAF](https://aws.amazon.com/waf/): Protects against web attacks at the ALB layer.<br> - [AWS IAM](https://aws.amazon.com/iam/): Manages role-based access control.<br> - [AWS KMS](https://aws.amazon.com/kms/): Manages encryption for data at rest. | **[Identify (ID)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/)**:<br> - [Asset Management (ID.AM-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/am/2/)<br> **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Access Control (PR.AC-1, PR.AC-3, PR.AC-5)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ac/)<br> - [Data Security (PR.DS-1, PR.DS-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ds/)<br> - [Protective Technology (PR.PT-3)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pt/3/)<br> **[Detect (DE)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/)**:<br> - [Security Continuous Monitoring (DE.CM-3)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/cm/3/) | - **A.8.1**: Asset management<br> - **A.9.4.1**: Access control policy<br> - **A.13.1.1**: Network controls<br> - **A.13.1.3**: Segregation in networks<br> - **A.18.1.5**: Regulation and compliance (see [ISO 27001](https://www.iso.org/standard/82875.html)) |
| **Domain and SSL Management** | - [Amazon Route 53](https://aws.amazon.com/route53/): Manages domain registration and DNS routing.<br> - [AWS Certificate Manager (ACM)](https://aws.amazon.com/certificate-manager/): Issues and manages SSL/TLS certificates.                    | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Data Security (PR.DS-5)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ds/5/)<br> **[Detect (DE)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/)**:<br> - [Anomalies and Events (DE.AE-3)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/ae/3/) | - **A.10.1.1**: Cryptographic controls for data protection<br> - **A.12.4.3**: Security of network services |
| **Compute**                   | - [Amazon EC2](https://aws.amazon.com/ec2/): Provides scalable compute instances.                                                                                                                                                      | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Protective Technology (PR.PT-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pt/1/)<br> **[Respond (RS)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/)**:<br> - [Analysis (RS.AN-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/an/1/), [Mitigation (RS.MI-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/mi/2/) | - **A.12.1.3**: Capacity management for IT infrastructure and services |
| **Load Balancing**            | - [Application Load Balancer (ALB)](https://aws.amazon.com/elasticloadbalancing/application-load-balancer/): Distributes HTTP/HTTPS traffic across EC2 instances.                                                                      | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Protective Technology (PR.PT-3)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pt/3/)<br> **[Respond (RS)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/)**:<br> - [Communications (RS.CO-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/co/2/) | - **A.13.1.1**: Network controls<br> - **A.13.2.1**: Information transfer policies |
| **Data Storage**              | - [Amazon S3](https://aws.amazon.com/s3/): Stores application artifacts and logs with encryption, access control, and lifecycle policies.<br> - [Amazon RDS](https://aws.amazon.com/rds/): PostgreSQL database with multi-AZ deployment. | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Data Security (PR.DS-1, PR.DS-5)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ds/)<br> - [Information Protection Processes and Procedures (PR.IP-3, PR.IP-4)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ip/)<br> - [Maintenance (PR.MA-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ma/1/)<br> **[Recover (RC)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/)**:<br> - [Recovery Planning (RC.RP-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/rp/1/), [Communications (RC.CO-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/co/2/) | - **A.8.2.3**: Information backup<br> - **A.10.1.1**: Use of cryptographic controls |
| **Secrets Management**        | - [AWS Secrets Manager](https://aws.amazon.com/secrets-manager/): Securely stores and rotates sensitive credentials with Lambda rotation support.                                                | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Access Control (PR.AC-1, PR.AC-4)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ac/)<br> - [Data Security (PR.DS-6)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ds/6/)<br> - [Identity Management and Access Control (PR.AC-7)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ac/7/) | - **A.9.2.2**: User access provisioning<br> - **A.10.1.1**: Management of encryption keys and secret information |
| **Monitoring and Alarms**     | - [Amazon CloudWatch](https://aws.amazon.com/cloudwatch/): Provides real-time metrics, logs, and alarms to monitor performance and health.                                                                | **[Detect (DE)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/)**:<br> - [Security Continuous Monitoring (DE.CM-3)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/cm/3/) | - **A.12.4.1**: Monitoring activities |
| **Resilience and Disaster Recovery** | - [AWS Resilience Hub](https://aws.amazon.com/resilience-hub/): Assesses and improves the architecture’s resilience, recommending strategies for fault tolerance and disaster recovery. | **[Recover (RC)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/)**:<br> - [Recovery Planning (RC.RP-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/rp/1/)<br> - [Improvements (RC.IM-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rc/im/1/) | - **A.17.1.2**: Implementing continuity controls<br> - **A.17.2.1**: Availability of information processing facilities |
| **Automation and Maintenance** | - [AWS Systems Manager (SSM)](https://aws.amazon.com/systems-manager/): Automates inventory, patching, and maintenance tasks, with **SSM Maintenance Windows** and **SSM Patch Baselines** for streamlined operations. | **[Protect (PR)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/)**:<br> - [Maintenance (PR.MA-1, PR.MA-2)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/ma/)<br> - [Protective Technology (PR.PT-1)](https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pt/1) | - **A.12.6.1**: Control of technical vulnerabilities<br> - **A.12.7.1**: Information systems audit considerations |

## AWS Stack Summary

- **Networking and Security**: [Amazon VPC](https://aws.amazon.com/vpc/) creates an isolated network environment with NAT Gateway, NACLs, and VPC Flow Logs. [VPC Endpoints](https://docs.aws.amazon.com/vpc/latest/privatelink/) provide private access to AWS services (e.g., S3, EC2, SSM), [AWS WAF](https://aws.amazon.com/waf/) protects against web attacks, [AWS IAM](https://aws.amazon.com/iam/) secures access control, and [AWS KMS](https://aws.amazon.com/kms/) encrypts data at rest.

- **Domain and SSL Management**: [Amazon Route 53](https://aws.amazon.com/route53/) handles DNS and domain registration, while [AWS Certificate Manager (ACM)](https://aws.amazon.com/certificate-manager/) provides SSL/TLS certificates for HTTPS security.

- **Compute Layer**: [Amazon EC2](https://aws.amazon.com/ec2/) instances host the application, providing flexible and scalable compute resources.

- **Load Balancing**: The [Application Load Balancer (ALB)](https://aws.amazon.com/elasticloadbalancing/application-load-balancer/) distributes HTTP/HTTPS traffic across EC2 instances, optimizing for high availability and resilience.

- **Data Storage**: [Amazon RDS](https://aws.amazon.com/rds/) offers a resilient PostgreSQL setup with multi-AZ deployment and custom parameter groups. [Amazon S3](https://aws.amazon.com/s3/) securely stores artifacts and logs, with lifecycle policies and KMS-managed encryption keys for compliance.

- **Secrets Management**: [AWS Secrets Manager](https://aws.amazon.com/secrets-manager/) securely stores and rotates credentials, such as database passwords, with automated Lambda support for rotation.

- **Monitoring and Alarms**: [Amazon CloudWatch](https://aws.amazon.com/cloudwatch/) monitors infrastructure health through metrics, logs, and alarms, enabling proactive management.

- **Resilience and Disaster Recovery**: [AWS Resilience Hub](https://aws.amazon.com/resilience-hub/) assesses and recommends enhancements to improve the system's resilience, providing disaster recovery and fault-tolerant strategies.

- **Automation and Maintenance**: [AWS Systems Manager (SSM)](https://aws.amazon.com/systems-manager/) automates inventory, patching, and other maintenance tasks, increasing operational efficiency.

</div>

For detailed security implementation, see the [Financial Security Plan](FinancialSecurityPlan.md).

## 🚀 Deployment Options

### AWS CloudFormation Deployment

The Citizen Intelligence Agency can be deployed on AWS using our provided CloudFormation template:

1. Download the [CloudFormation stack file](cia-dist-cloudformation/src/main/resources/cia-dist-cloudformation.json)
2. Create a new stack in the AWS CloudFormation console
3. Upload the template file and configure parameters
4. Acknowledge IAM resource creation and launch the stack
5. Access the application via the URL in the stack outputs

#### CloudFormation Stack Diagram
![Cloudformation stack Diagram](cia-dist-cloudformation/src/main/resources/cia-dist-cloudformation.png)

### Debian/Ubuntu Installation

For local or self-hosted deployment on Debian/Ubuntu 24.4+:

1. Install prerequisites:
   ```bash
   sudo apt-get install openjdk-21-jdk postgresql-16 postgresql-contrib postgresql-16-pgaudit
   ```

2. Configure PostgreSQL as detailed below.

## PostgreSQL 16 Configuration Guide

A step-by-step guide to configure PostgreSQL 16 with SSL, prepared transactions, and required extensions.

### 1. Enable Prepared Transactions and Required Extensions

1. **Edit** `/etc/postgresql/16/main/postgresql.conf` and add or update the following lines:
   ```ini
   max_prepared_transactions = 100
   shared_preload_libraries = 'pg_stat_statements, pgaudit, pgcrypto'
   pgaudit.log = ddl
   pg_stat_statements.track = all
   pg_stat_statements.max = 10000
   ```
2. **Save and close** the file.

### 2. Update `pg_hba.conf` for IPv6 Loopback Access

1. **Edit** `/etc/postgresql/16/main/pg_hba.conf` and add the following line:
   ```ini
   host all all ::1/128 md5
   ```
2. **Save and close** the file.

### 3. Generate SSL Certificates and Keys

1. Generate a secure random passphrase:
   ```bash
   openssl rand -base64 48 > passphrase.txt
   ```

2. Create a passphrase-protected private key:
   ```bash
   openssl genrsa -des3 -passout file:passphrase.txt -out server.pass.key 2048
   ```

3. Remove the passphrase protection from the private key:
   ```bash
   openssl rsa -passin file:passphrase.txt -in server.pass.key -out server.key
   rm server.pass.key
   ```

4. Create a Certificate Signing Request (CSR):
   ```bash
   openssl req -new -key server.key -out server.csr \
       -subj "/C=UK/ST=Postgresqll/L=Docker/O=Hack23/OU=demo/CN=127.0.0.1"
   ```

5. Self-sign the certificate (valid for 10 years / 3650 days):
   ```bash
   openssl x509 -req -days 3650 -in server.csr -signkey server.key -out server.crt
   ```

6. Clean up temporary files:
   ```bash
   rm passphrase.txt
   rm server.csr
   ```

### 4. Deploy the SSL Certificate and Key for PostgreSQL

1. Copy the new certificate and key into the PostgreSQL data directory:
   ```bash
   cp server.crt /var/lib/postgresql/16/main/server.crt
   cp server.key /var/lib/postgresql/16/main/server.key
   rm server.key
   ```

2. Secure the certificate and key:
   ```bash
   chmod 700 /var/lib/postgresql/16/main/server.key
   chmod 700 /var/lib/postgresql/16/main/server.crt
   chown -R postgres:postgres /var/lib/postgresql/16/main/
   ```

3. Enable SSL in PostgreSQL by adding the following lines to
   `/etc/postgresql/16/main/postgresql.conf`:
   ```bash
   echo "ssl_cert_file = '/var/lib/postgresql/16/main/server.crt'" \
       >> /etc/postgresql/16/main/postgresql.conf
   echo "ssl_key_file = '/var/lib/postgresql/16/main/server.key'" \
       >> /etc/postgresql/16/main/postgresql.conf
   ```

### 5. Provide SSL Certificate to the `cia` User

1. Create a `.postgresql` directory for the `cia` user:
   ```bash
   mkdir -p /opt/cia/.postgresql
   ```

2. Copy the server certificate into this directory:
   ```bash
   cp server.crt /opt/cia/.postgresql/root.crt
   chmod 700 /opt/cia/.postgresql/root.crt
   chown -R cia:cia /opt/cia/.postgresql/root.crt
   ```

3. Remove the server certificate from the current directory (if desired):
   ```bash
   rm server.crt
   ```

### Final Steps

1. **Restart PostgreSQL** to apply all changes:
   ```bash
   systemctl restart postgresql
   ```

2. Verify that PostgreSQL is running with SSL by checking the logs or using an SSL-enabled client.

3. Confirm that prepared transactions and required extensions are enabled:
   ```sql
   SHOW max_prepared_transactions;
   \dx
   ```

4. Confirm the new IPv6 entry in `pg_hba.conf` is functioning as expected by connecting via `psql` over `::1`.

## Database Setup

Create an empty database:

Below instructions set the default username/password and database name used for development. We recommend using custom credentials and updating the configuration at `/opt/cia/webapps/cia/WEB-INF/database.properties` to define your own username/password and database name.

```bash
$ sudo su - postgres
$ psql
postgres=# CREATE USER eris WITH password 'discord';
postgres=# CREATE DATABASE cia_dev;
postgres=# GRANT ALL PRIVILEGES ON DATABASE cia_dev to eris;
```

## Install CIA Debian Package

1. Download the CIA Debian package:
   ```bash
   wget https://github.com/Hack23/cia/releases/download/2025.1.2/cia-dist-deb-2025.1.2.all.deb
   ```

2. Install the Debian package:
   ```bash
   sudo dpkg -i cia-dist-deb-2025.1.2.all.deb
   ```

3. Access the server at [https://localhost:28443/cia/](https://localhost:28443/cia/).

## 📊 Political Dashboards

- **English**: Our [dashboard](https://github.com/Hack23/cia/blob/master/dashboard.md) provides comprehensive analytics on Swedish political figures and institutions.

- **Swedish**: Vår [dashboard](https://github.com/Hack23/cia/blob/master/dashboard_sv.md) erbjuder en detaljerad översikt över politiska figurer och olika departement i Sverige.

## 🤖 AI and Data Visualization

This project is powered by advanced AI technologies for data processing and analysis. We integrate data from various open sources and visualize findings through modern data visualization tools.

For our future vision incorporating more advanced AI capabilities, see our [Future Architecture Vision](FUTURE_MINDMAP.md).

## 🔗 Key Documentation Links

- [Architecture Documentation](ARCHITECTURE.md) - C4 model architecture 
- [System Mindmaps](MINDMAP.md) - Conceptual overview and relationships
- [Future Vision](FUTURE_MINDMAP.md) - AI-enhanced capabilities roadmap
- [Entity Model](https://hack23.github.io/cia/service.data.impl/hbm2doc/entities/index.html) - Database entity documentation
- [API Documentation](https://hack23.github.io/cia/apidocs/index.html) - API reference
- [Financial Security Plan](FinancialSecurityPlan.md) - AWS deployment and security
- [End-of-Life Strategy](End-of-Life-Strategy.md) - Technology maintenance planning
- [CIA Features](https://hack23.com/cia-features.html) - Detailed feature showcase
- [Package Overview Diagram](https://hack23.github.io/cia/apidocs/package-dependencies.svg) - Visual code package dependencies
