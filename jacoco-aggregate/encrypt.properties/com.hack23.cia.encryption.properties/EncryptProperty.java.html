<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>EncryptProperty.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Citizen Intelligence Agency</a> &gt; <a href="../index.html" class="el_bundle">encrypt.properties</a> &gt; <a href="index.source.html" class="el_package">com.hack23.cia.encryption.properties</a> &gt; <span class="el_source">EncryptProperty.java</span></div><h1>EncryptProperty.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2014 James Pether SÃ¶rling
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 *	$Id$
 *  $HeadURL$
*/
package com.hack23.cia.encryption.properties;

import java.security.Security;

import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.jasypt.encryption.pbe.StandardPBEStringEncryptor;

/**
 * The Class EncryptProperty.
 */
public final class EncryptProperty {

	/** The Constant EXPECTED_NUMBER_ARGS. */
	private static final int EXPECTED_NUMBER_ARGS = 2;

	/** The Constant PBEWITHSHA256AND128BITAES_CBC_BC. */
	private static final String PBEWITHSHA256AND128BITAES_CBC_BC = &quot;PBEWITHSHA256AND128BITAES-CBC-BC&quot;;
	
	/** The Constant BC_PROVIDER_NAME. */
	private static final String BC_PROVIDER_NAME = &quot;BC&quot;;
	
	/** The Constant ENC_CONTENT_SUFFIX. */
	private static final String ENC_CONTENT_SUFFIX = &quot;)&quot;;
	
	/** The Constant ENC_CONTENT_PREFIX. */
	private static final String ENC_CONTENT_PREFIX = &quot;ENC(&quot;;
	
	/** The Constant ENCRYPTED_PROPERTY_VALUE. */
	private static final String ENCRYPTED_PROPERTY_VALUE = &quot;Encrypted property value:&quot;;
	
	/** The Constant ENCRYPTED_VALUE. */
	private static final String ENCRYPTED_VALUE = &quot;Encrypted value:&quot;;
	
	/** The Constant HELP_MESSAGE. */
	private static final String HELP_MESSAGE = &quot;Encrypt property value with PBEWITHSHA256AND128BITAES_CBC_BC, using symmetric key and value as arguments. ./encryptProperty [key] [value]&quot;;
	
	
	/**
	 * Instantiates a new encrypt property.
	 */
	public EncryptProperty() {
<span class="nc" id="L60">		super();</span>
<span class="nc" id="L61">	}</span>

	/**
	 * The main method.
	 *
	 * @param args the arguments
	 */
	public static void main(String[] args) {
<span class="nc bnc" id="L69" title="All 2 branches missed.">		if (args.length == EXPECTED_NUMBER_ARGS) {</span>
<span class="nc" id="L70">			final String encryptValue = new EncryptProperty().encryptValue(args[0], args[1]);</span>
<span class="nc" id="L71">			System.out.println(ENCRYPTED_VALUE +encryptValue);</span>
<span class="nc" id="L72">			System.out.println(ENCRYPTED_PROPERTY_VALUE + ENC_CONTENT_PREFIX +encryptValue +ENC_CONTENT_SUFFIX);</span>
<span class="nc" id="L73">		} else {</span>
<span class="nc" id="L74">			System.out.println(HELP_MESSAGE);</span>
		}
<span class="nc" id="L76">	}</span>
	
	/**
	 * Encrypt value.
	 *
	 * @param symmetricKey
	 *            the symmetric key
	 * @param value
	 *            the value
	 * @return the string
	 */
	public String encryptValue(final String symmetricKey,final String value) {
<span class="nc" id="L88">		return getEncryptor(symmetricKey).encrypt(value);</span>
		
	}

	/**
	 * Gets the encryptor.
	 *
	 * @param symmetricKey
	 *            the symmetric key
	 * @return the encryptor
	 */
	private static StandardPBEStringEncryptor getEncryptor(final String symmetricKey) {
<span class="nc" id="L100">		Security.addProvider(new BouncyCastleProvider());</span>
<span class="nc" id="L101">		final StandardPBEStringEncryptor mySecondEncryptor = new StandardPBEStringEncryptor();</span>
<span class="nc" id="L102">		mySecondEncryptor.setProviderName(BC_PROVIDER_NAME);</span>
<span class="nc" id="L103">		mySecondEncryptor.setAlgorithm(PBEWITHSHA256AND128BITAES_CBC_BC);</span>
<span class="nc" id="L104">		mySecondEncryptor.setPassword(symmetricKey);</span>
<span class="nc" id="L105">		return mySecondEncryptor;</span>
	}


	/**
	 * Decrypt value.
	 *
	 * @param symmetricKey
	 *            the symmetric key
	 * @param value
	 *            the value
	 * @return the string
	 */
	public String decryptValue(final String symmetricKey,final String value) {
<span class="nc" id="L119">		return getEncryptor(symmetricKey).decrypt(value);</span>
		
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>