userid,dbid,toplevel,queryid,query,plans,total_plan_time,min_plan_time,max_plan_time,mean_plan_time,stddev_plan_time,calls,total_exec_time,min_exec_time,max_exec_time,mean_exec_time,stddev_exec_time,rows,shared_blks_hit,shared_blks_read,shared_blks_dirtied,shared_blks_written,local_blks_hit,local_blks_read,local_blks_dirtied,local_blks_written,temp_blks_read,temp_blks_written,blk_read_time,blk_write_time,temp_blk_read_time,temp_blk_write_time,wal_records,wal_fpi,wal_bytes,jit_functions,jit_generation_time,jit_inlining_count,jit_inlining_time,jit_optimization_count,jit_optimization_time,jit_emission_count,jit_emission_time
10,16385,t,4851728793435663200,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5]) AS col
WHERE EXISTS (SELECT $6 FROM information_schema.columns WHERE table_schema = $7 AND table_name = $8 AND column_name = col)",0,0,0,0,0,0,1,0.204532,0.204532,0.204532,0.204532,0,1,23,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7990421590574882029,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $1 ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.106178,0.106178,0.106178,0.106178,0,5,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3734896786789908294,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_activity_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,39.379138,39.379138,39.379138,39.379138,0,2,208,4792,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2729959030575642582,REFRESH MATERIALIZED VIEW public.view_riksdagen_party_document_daily_summary,0,0,0,0,0,0,1,2671.407807,2671.407807,2671.407807,2671.407807,0,8557,2421,6630,72,129,0,0,0,0,1316,1320,0,0,0,0,8729,3,830765,0,0,0,0,0,0,0,0
10,16385,t,-5500508798982911983,"COPY  ( SELECT role_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE role_code IS NOT NULL GROUP BY role_code ORDER BY count DESC, role_code LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,6.565322,6.565322,6.565322,6.565322,0,75,481,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-470677346542522305,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'week' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '6 months' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 50 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.513429,0.513429,0.513429,0.513429,0,8,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7531823756005243466,SET row_security = off,0,0,0,0,0,0,2,0.0020740000000000003,0.000992,0.001082,0.0010370000000000002,4.5000000000000064e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2055942241530764054,COPY  ( SELECT * FROM public.jv_commit_property ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,13086.282751,13086.282751,13086.282751,13086.282751,0,200,0,26168,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.231672,0,0,1,0.172783,1,1.704043
10,16385,t,-1145031465870977432,COPY  ( SELECT * FROM public.view_riksdagen_politician_document_daily_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,147.791106,147.791106,147.791106,147.791106,0,500,188,526,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5682503274876892782,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_data WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.707501,0.707501,0.707501,0.707501,0,63,339,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6648683783610817785,"SELECT name, year, documents_produced, propositions, government_bills, productivity_quartile FROM view_ministry_productivity_matrix ORDER BY year DESC, documents_produced DESC LIMIT $1",0,0,0,0,0,0,1,67.06351500000001,67.06351500000001,67.06351500000001,67.06351500000001,0,29,7149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,985150727636610821,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,15.449485000000001,15.449485000000001,15.449485000000001,15.449485000000001,0,26,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2476162423012049141,"CREATE OR REPLACE FUNCTION cia_classify_temporal_view(p_viewname text)
RETURNS TABLE (temporal_granularity text, samples_per_bucket integer)
LANGUAGE sql
IMMUTABLE
AS $$
    SELECT
        CASE 
            -- Daily granularity: 2 samples per day over last 30 days (60 samples max)
            WHEN p_viewname LIKE '%_daily%' THEN 'daily'
            -- Weekly granularity: 2 samples per week over last 6 months (52 samples max)
            WHEN p_viewname LIKE '%_weekly%' THEN 'weekly'
            -- Monthly granularity: 2 samples per month over last 3 years (72 samples max)
            WHEN p_viewname LIKE '%_monthly%' THEN 'monthly'
            -- Annual granularity: 2 samples per year over full history
            WHEN p_viewname LIKE '%_annual%' THEN 'annual'
            -- Temporal trend views: mixed strategy (all available time periods)
            WHEN p_viewname LIKE '%_temporal%' OR p_viewname LIKE '%_trend%' 
                 OR p_viewname LIKE '%_evolution%' OR p_viewname LIKE '%_momentum%' THEN 'temporal_trend'
            -- Non-temporal views: use random sampling
            ELSE 'non_temporal'
        END AS temporal_granularity,
        CASE 
            WHEN p_viewname LIKE '%_daily%' THEN 2
            WHEN p_viewname LIKE '%_weekly%' THEN 2
            WHEN p_viewname LIKE '%_monthly%' THEN 2
            WHEN p_viewname LIKE '%_annual%' THEN 2
            WHEN p_viewname LIKE '%_temporal%' OR p_viewname LIKE '%_trend%' 
                 OR p_viewname LIKE '%_evolution%' OR p_viewname LIKE '%_momentum%' THEN 1
            ELSE 0
        END AS samples_per_bucket;
$$",0,0,0,0,0,0,1,0.63863,0.63863,0.63863,0.63863,0,0,72,1,2,1,0,0,0,0,0,0,0,0,0,0,6,0,2200,0,0,0,0,0,0,0,0
10,16385,t,-3014072469484784579,COPY  ( SELECT * FROM public.person_data ORDER BY random ( ) LIMIT 2132 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,16.502134,16.502134,16.502134,16.502134,0,2132,84,354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4970847001277719138,"SELECT p.tableoid, p.oid, p.proname AS aggname, p.pronamespace AS aggnamespace, p.pronargs, p.proargtypes, p.proowner, p.proacl AS aggacl, acldefault($1, p.proowner) AS acldefault FROM pg_proc p LEFT JOIN pg_init_privs pip ON (p.oid = pip.objoid AND pip.classoid = $2::regclass AND pip.objsubid = $3) WHERE p.prokind = $4 AND (p.pronamespace != (SELECT oid FROM pg_namespace WHERE nspname = $5) OR p.proacl IS DISTINCT FROM pip.initprivs)",0,0,0,0,0,0,2,0.8278960000000001,0.314087,0.5138090000000001,0.41394800000000004,0.09986100000000003,8,222,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7529151913415909719,SELECT COUNT(*) FROM public.view_audit_data_summary,0,0,0,0,0,0,1,18.21949,18.21949,18.21949,18.21949,0,1,323,25,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,550768861245194729,COPY  ( SELECT * FROM public.vote_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1935.401673,1935.401673,1935.401673,1935.401673,0,300,0,87278,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.461572,0,0,1,0.301212,1,3.204796
10,16385,f,-8152647009651529817,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_weekly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,27.109640000000002,27.109640000000002,27.109640000000002,27.109640000000002,0,670,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,f,1484064514370518425,"SELECT pg_catalog.upper(object_type),
       object_identity
  FROM pg_catalog.pg_event_trigger_dropped_objects()
 WHERE pg_catalog.lower(object_type) operator(pg_catalog.<>) $1
   AND schema_name operator(pg_catalog.<>) $2",0,0,0,0,0,0,5,0.431875,0.024516,0.118822,0.08637500000000001,0.03370331447202189,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,10833512468253048,COPY  ( SELECT * FROM public.person_detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.791186,1.791186,1.791186,1.791186,0,2487,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,378134943487131039,ANALYZE public.view_riksdagen_vote_data_ballot_summary_weekly,0,0,0,0,0,0,1,5.388494,5.388494,5.388494,5.388494,0,0,3230,16,3,3,0,0,0,0,0,0,0,0,0,0,60,0,29700,0,0,0,0,0,0,0,0
10,16385,t,-7981421453796156825,"SELECT tableoid, oid, cfgname, cfgnamespace, cfgowner, cfgparser FROM pg_ts_config",0,0,0,0,0,0,2,0.035598,0.017643,0.017955,0.017799,0.0001559999999999999,58,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-311473351152926507,"COPY  ( SELECT origin AS value, COUNT ( * ) AS count FROM document_element WHERE origin IS NOT NULL GROUP BY origin ORDER BY count DESC, origin LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,62.781257,62.781257,62.781257,62.781257,0,36,1197,34371,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5890592883540513887,SELECT viewname FROM pg_views WHERE schemaname = $1 AND (viewname LIKE $2 OR viewname LIKE $3 OR viewname LIKE $4 OR viewname LIKE $5 OR viewname LIKE $6 OR viewname LIKE $7 OR viewname LIKE $8 OR viewname LIKE $9 OR viewname LIKE $10) ORDER BY viewname,0,0,0,0,0,0,1,1.137225,1.137225,1.137225,1.137225,0,15,308,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7451793817315958939,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,10.618832999999999,10.618832999999999,10.618832999999999,10.618832999999999,0,91,6,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3802367180998153294,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_monthly ORDER BY random ( ) LIMIT 220 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,7.804031,7.804031,7.804031,7.804031,0,220,1217,215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6155922738193590589,SELECT * FROM view_ministry_productivity_matrix,0,0,0,0,0,0,1,296.99722,296.99722,296.99722,296.99722,0,3,17,7132,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,76,3.5349,0,0,1,1.705175,1,35.927712
16384,16385,t,2247467723989480173,select setting from pg_settings where name = $1,0,0,0,0,0,0,1,0.729654,0.729654,0.729654,0.729654,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3871816553898186591,COPY  ( SELECT * FROM public.document_attachment_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,190.687269,190.687269,190.687269,190.687269,0,300,0,304,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-3951009253567799617,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB7zE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB9QAAAAAAAAAA',0,0,0,0,0,0,1,0.001212,0.001212,0.001212,0.001212,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3863031927776322127,COPY  ( SELECT * FROM public.agency ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.245624,2.245624,2.245624,2.245624,0,1,49,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1837889133032424416,"SELECT tableoid, oid, castsource, casttarget, castfunc, castcontext, castmethod FROM pg_cast c WHERE NOT EXISTS ( SELECT $1 FROM pg_range r WHERE c.castsource = r.rngtypid AND c.casttarget = r.rngmultitypid ) ORDER BY 3,4",0,0,0,0,0,0,2,0.415706,0.206956,0.20875000000000002,0.207853,0.0008970000000000089,492,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8790876383867405784,"COPY  ( SELECT document_name AS value, COUNT ( * ) AS count FROM document_element WHERE document_name IS NOT NULL GROUP BY document_name ORDER BY count DESC, document_name LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,66.315528,66.315528,66.315528,66.315528,0,95,911,34660,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8430272080165128853,COPY  ( SELECT * FROM public.document_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,359.350997,359.350997,359.350997,359.350997,0,300,89,3745,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1822349172987761615,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document,0,0,0,0,0,0,1,2735.355848,2735.355848,2735.355848,2735.355848,0,227973,32258,34466,6418,11655,0,0,0,0,6476,6464,0,0,0,0,229579,1345,67154192,0,0,0,0,0,0,0,0
10,16385,t,5771079333835366015,"SELECT $1 || $2 ||
       $3 || $4
WHERE EXISTS (SELECT $5 FROM information_schema.tables WHERE table_schema = $6 AND table_name = $7)",0,0,0,0,0,0,1,0.019417,0.019417,0.019417,0.019417,0,1,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8045536100700691924,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary LIMIT $2),0,0,0,0,0,0,1,0.003998,0.003998,0.003998,0.003998,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8024243936388867082,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_element WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.098091,58.098091,58.098091,58.098091,0,311,236,35338,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3020197419609077668,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM document_element WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,56.220607,56.220607,56.220607,56.220607,0,60,331,35240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8581205701506090238,"COPY  ( SELECT document_format AS value, COUNT ( * ) AS count FROM document_element WHERE document_format IS NOT NULL GROUP BY document_format ORDER BY count DESC, document_format LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.565159,55.565159,55.565159,55.565159,0,1,812,34756,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-849877900115281201,"SELECT COUNT(*) FROM vote_data WHERE vote IN ($1, $2)",0,0,0,0,0,0,1,0.044513,0.044513,0.044513,0.044513,0,1,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8821829679960084638,"SELECT pg_get_viewdef($1, $2)",0,0,0,0,0,0,5,10.543213,1.942588,2.536628,2.1086426,0.22325877393697213,5,2908,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5373081623865433604,COPY  ( SELECT * FROM public.qrtz_job_details ORDER BY random ( ) LIMIT 4 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.02514,3.02514,3.02514,3.02514,0,4,65,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5827178464283574856,"SELECT a.attname,
  pg_catalog.format_type(a.atttypid, a.atttypmod),
  (SELECT pg_catalog.pg_get_expr(d.adbin, d.adrelid, $1)
   FROM pg_catalog.pg_attrdef d
   WHERE d.adrelid = a.attrelid AND d.adnum = a.attnum AND a.atthasdef),
  a.attnotnull,
  (SELECT c.collname FROM pg_catalog.pg_collation c, pg_catalog.pg_type t
   WHERE c.oid = a.attcollation AND t.oid = a.atttypid AND a.attcollation <> t.typcollation) AS attcollation,
  a.attidentity,
  a.attgenerated
FROM pg_catalog.pg_attribute a
WHERE a.attrelid = $2 AND a.attnum > $3 AND NOT a.attisdropped
ORDER BY a.attnum",0,0,0,0,0,0,2,0.199482,0.088204,0.111278,0.099741,0.011536999999999995,26,119,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6741457284548202857,"SELECT tableoid, oid, tmplname, tmplnamespace, tmplinit::oid, tmpllexize::oid FROM pg_ts_template",0,0,0,0,0,0,2,0.10302099999999999,0.0074329999999999995,0.09558799999999999,0.051510499999999994,0.0440775,10,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5999925436368480335,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_daily_summary,0,0,0,0,0,0,1,0.223628,0.223628,0.223628,0.223628,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8740800287404131890,"SELECT schemaname, matviewname
            FROM pg_matviews
            WHERE schemaname = $1
            ORDER BY matviewname",0,0,0,0,0,0,3,2.5183229999999996,0.587428,1.1642899999999998,0.8394409999999999,0.24106880612942572,84,777,155,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4875488109093304211,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.281062,57.281062,57.281062,57.281062,0,7,0,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5042802913910178751,ANALYZE public.view_riksdagen_committee_decisions,0,0,0,0,0,0,1,241.274061,241.274061,241.274061,241.274061,0,0,2754,1408,4,4,0,0,0,0,0,0,0,0,0,0,78,0,35839,0,0,0,0,0,0,0,0
10,16385,f,454986626092375764,COPY  ( SELECT * FROM public.committee_proposal_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,29.449552999999998,29.449552999999998,29.449552999999998,29.449552999999998,0,500,0,2831,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1782096248570751468,COPY  ( SELECT * FROM public.view_riksdagen_politician_document_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,147.276166,147.276166,147.276166,147.276166,0,500,0,448,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-7920108659891754442,select * from jv_commit where $1<$2,0,0,0,0,0,0,1,0.000871,0.000871,0.000871,0.000871,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4590939273026221284,SELECT MAX(ORDEREXECUTED) FROM public.databasechangelog,0,0,0,0,0,0,1,0.12332,0.12332,0.12332,0.12332,0,1,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2858588860614356452,"SELECT s.tableoid, s.oid, s.subname,
 s.subowner,
 s.subconninfo, s.subslotname, s.subsynccommit,
 s.subpublications,
 s.subbinary,
 s.substream,
 s.subtwophasestate,
 s.subdisableonerr,
 s.subpasswordrequired,
 s.subrunasowner,
 s.suborigin
FROM pg_subscription s
WHERE s.subdbid = (SELECT oid FROM pg_database
                   WHERE datname = current_database())",0,0,0,0,0,0,2,0.008235,0.0034860000000000004,0.004749,0.0041175,0.0006314999999999995,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8917112057706856151,"COPY  ( SELECT country_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE country_value IS NOT NULL GROUP BY country_value ORDER BY count DESC, country_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,65.169198,65.169198,65.169198,65.169198,0,6,54,10351,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4568741846396245076,ANALYZE public.view_riksdagen_vote_data_ballot_summary_monthly,0,0,0,0,0,0,1,2.555553,2.555553,2.555553,2.555553,0,0,3237,8,4,4,0,0,0,0,0,0,0,0,0,0,60,0,28991,0,0,0,0,0,0,0,0
10,16385,f,8177634166909195455,"COPY  ( SELECT target AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE target IS NOT NULL GROUP BY target ORDER BY count DESC, target LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005961,0.005961,0.005961,0.005961,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1012848628955209790,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_annual,0,0,0,0,0,0,1,3652.163592,3652.163592,3652.163592,3652.163592,0,9655,9125,24061,436,451,0,0,0,0,13463,13493,0,0,0,0,10009,47,3829296,0,0,0,0,0,0,0,0
10,16385,f,273869920055177729,"COPY  ( SELECT chamber AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE chamber IS NOT NULL GROUP BY chamber ORDER BY count DESC, chamber LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2059.205175,2059.205175,2059.205175,2059.205175,0,25,0,2721,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6564855795827845044,COPY  ( SELECT * FROM public.view_riksdagen_party_coalation_against_annual_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,15.904635,15.904635,15.904635,15.904635,0,278,0,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2671739184911010757,ANALYZE public.view_riksdagen_committee_ballot_decision_politician_summary,0,0,0,0,0,0,1,36038.076597,36038.076597,36038.076597,36038.076597,0,0,6980,30426,25,9,0,0,0,0,0,0,0,0,0,0,208,15,205716,0,0,0,0,0,0,0,0
10,16385,f,-345123517048346952,SELECT COUNT(*) FROM public.view_application_action_event_page_element_hourly_summary,0,0,0,0,0,0,1,0.111167,0.111167,0.111167,0.111167,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1387078167722322660,COPY  ( SELECT * FROM public.view_riksdagen_document_type_daily_summary ORDER BY random ( ) LIMIT 300 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,18.992122,18.992122,18.992122,18.992122,0,300,115,324,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6647975046885821357,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC LIMIT 500 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,56.780439,56.780439,56.780439,56.780439,0,500,1079,0,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4155045913258407966,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_decision_type_summary,0,0,0,0,0,0,1,40.114683,40.114683,40.114683,40.114683,0,3343,3881,34,31,34,0,0,0,0,0,0,0,0,0,0,3532,14,410166,0,0,0,0,0,0,0,0
16384,16385,t,758923338704292835,SELECT * FROM QRTZ_JOB_DETAILS WHERE SCHED_NAME = $3 AND JOB_NAME = $1 AND JOB_GROUP = $2,0,0,0,0,0,0,4,0.67399,0.006874,0.647349,0.16849749999999997,0.27646867038644724,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3138527841665450892,COPY  ( SELECT * FROM public.committee_proposal_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.737415,3.737415,3.737415,3.737415,0,500,0,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1655523342019290992,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0048389999999999996,0.0048389999999999996,0.0048389999999999996,0.0048389999999999996,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1708046091108478277,REFRESH MATERIALIZED VIEW public.view_riksdagen_org_document_daily_summary,0,0,0,0,0,0,1,229.812916,229.812916,229.812916,229.812916,0,66625,2714,35512,500,515,0,0,0,0,153,311,0,0,0,0,66791,2,5832076,0,0,0,0,0,0,0,0
10,16385,t,8847338302768701162,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,27.088343,27.088343,27.088343,27.088343,0,76,3733,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1037297504142501368,COPY  ( SELECT * FROM public.view_riksdagen_document_type_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,18.360832000000002,18.360832000000002,18.360832000000002,18.360832000000002,0,300,0,222,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,2108463211818937805,SELECT MD5SUM FROM public.databasechangelog WHERE MD5SUM IS NOT NULL AND MD5SUM NOT LIKE $1,0,0,0,0,0,0,1,141.728676,141.728676,141.728676,141.728676,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-16034182130646267,"COPY  ( SELECT domain_org AS value, COUNT ( * ) AS count FROM document_element WHERE domain_org IS NOT NULL GROUP BY domain_org ORDER BY count DESC, domain_org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,60.190528,60.190528,60.190528,60.190528,0,1,1004,34564,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3880271657754320343,"COPY  ( SELECT debate_name AS value, COUNT ( * ) AS count FROM document_element WHERE debate_name IS NOT NULL GROUP BY debate_name ORDER BY count DESC, debate_name LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,63.551165,63.551165,63.551165,63.551165,0,89,718,34853,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,5302268511581926622,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABajE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABcAAAAAAAAAAA',0,0,0,0,0,0,1,68.754655,68.754655,68.754655,68.754655,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,f,487241132909465451,SELECT COUNT(*) FROM public.view_committee_productivity,0,0,0,0,0,0,1,748.676193,748.676193,748.676193,748.676193,0,1,479,8651,0,0,0,0,0,0,1394,1399,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7042627767204709204,COPY  ( SELECT * FROM public.detail_data ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,6.947125,6.947125,6.947125,6.947125,0,200,13,520,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6518599406465570533,"DO $$
DECLARE
    view_record RECORD;
    view_count INTEGER := 0;
    file_name TEXT;
    explain_query TEXT;
BEGIN
    RAISE NOTICE 'Generating individual query plan files...';
    RAISE NOTICE '';
    
    FOR view_record IN 
        SELECT schemaname, viewname AS object_name, 'VIEW' AS object_type
        FROM pg_views
        WHERE schemaname = 'public'
        UNION ALL
        SELECT schemaname, matviewname AS object_name, 'MATERIALIZED VIEW' AS object_type
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY object_name
    LOOP
        BEGIN
            view_count := view_count + 1;
            file_name := '/workspaces/cia/service.data.impl/sample-data/view_plans/explain_' || view_record.object_name || '.txt';
            
            RAISE NOTICE '[%] %.%', view_count, view_record.schemaname, view_record.object_name;
            
            -- Execute EXPLAIN and write to file using psql \o command
            explain_query := 'EXPLAIN (ANALYZE, BUFFERS, VERBOSE, FORMAT TEXT) SELECT * FROM ' || 
                            quote_ident(view_record.schemaname) || '.' || 
                            quote_ident(view_record.object_name) || ' LIMIT 1';
            
            -- This approach won't work in DO block, skip EXPLAIN generation
            RAISE NOTICE '  ℹ️  Skipping EXPLAIN (requires psql \\o command)';
            
        EXCEPTION WHEN OTHERS THEN
            RAISE NOTICE '  ✗ ERROR: %', SQLERRM;
        END;
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE '  Note: EXPLAIN plans require manual execution with psql \\o command';
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,2.903055,2.903055,2.903055,2.903055,0,0,643,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8694190517236404501,SELECT COUNT(*) FROM public.view_ministry_productivity_matrix,0,0,0,0,0,0,1,100.776391,100.776391,100.776391,100.776391,0,1,7135,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,2.831005,0,0,1,1.155278,1,29.783172
10,16385,f,-3759299313536402344,"COPY  ( SELECT income_level_value AS value, COUNT ( * ) AS count FROM country_element WHERE income_level_value IS NOT NULL GROUP BY income_level_value ORDER BY count DESC, income_level_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.776099,0.776099,0.776099,0.776099,0,3,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1489029959333921050,SELECT COUNT(*) FROM public.view_riksdagen_politician,0,0,0,0,0,0,1,12.281919,12.281919,12.281919,12.281919,0,1,905,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1606293634827055830,"SELECT TRIGGER_NAME, TRIGGER_GROUP, NEXT_FIRE_TIME, PRIORITY FROM QRTZ_TRIGGERS WHERE SCHED_NAME = $4 AND TRIGGER_STATE = $1 AND NEXT_FIRE_TIME <= $2 AND (MISFIRE_INSTR = $5 OR (MISFIRE_INSTR <> $6 AND NEXT_FIRE_TIME >= $3)) ORDER BY NEXT_FIRE_TIME ASC, PRIORITY DESC",0,0,0,0,0,0,1,221.85351,221.85351,221.85351,221.85351,0,0,69,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3341724097351342929,COPY  ( SELECT * FROM public.qrtz_job_details ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.074309,0.074309,0.074309,0.074309,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5924296848305665803,"COPY  ( SELECT electoral_region AS value, COUNT ( * ) AS count FROM vote_data WHERE electoral_region IS NOT NULL GROUP BY electoral_region ORDER BY count DESC, electoral_region LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,330.518227,330.518227,330.518227,330.518227,0,30,16,87278,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.725755,0,0,1,0.404656,1,5.477773
10,16385,t,-7136541895028488704,"CREATE OR REPLACE VIEW view_ministry_productivity_matrix AS
WITH ministry_base AS (
    SELECT DISTINCT
        org_code,
        org_code AS short_code,
        detail AS name,
        LOWER(detail) AS name_lower
    FROM assignment_data
    WHERE assignment_type = 'Departement'
        AND org_code IS NOT NULL
        AND detail IS NOT NULL
),
ministry_document_data AS (
    SELECT 
        dsc.hjid AS id,
        dd.document_type,
        dd.made_public_date,
        dd.org,
        LOWER(dd.org) AS org_lower,
        dpr.person_reference_id
    FROM document_status_container dsc
    LEFT JOIN document_data dd 
        ON dsc.document_document_status_con_0 = dd.id
    LEFT JOIN document_person_reference_co_0 dprc 
        ON dsc.hjid = dprc.hjid
    LEFT JOIN document_person_reference_da_0 dpr 
        ON dpr.document_person_reference_li_1 = dprc.hjid
    WHERE dd.made_public_date IS NOT NULL
),
ministry_annual_metrics AS (
    SELECT
        m.org_code,
        m.short_code,
        m.name,
        EXTRACT(YEAR FROM doc.made_public_date) AS year,
        COUNT(DISTINCT doc.id) AS documents_produced,
        COUNT(DISTINCT CASE WHEN LOWER(doc.document_type) = 'prop' THEN doc.id END) AS propositions,
        COUNT(DISTINCT CASE WHEN LOWER(doc.document_type) = 'ds' THEN doc.id END) AS government_bills,
        COUNT(DISTINCT doc.person_reference_id) AS unique_contributors,
        MIN(doc.made_public_date) AS earliest_document,
        MAX(doc.made_public_date) AS latest_document
    FROM ministry_base m
    LEFT JOIN ministry_document_data doc 
        ON doc.org_lower = m.name_lower
        AND doc.made_public_date >= CURRENT_DATE - INTERVAL '3 years'
    GROUP BY m.org_code, m.short_code, m.name, EXTRACT(YEAR FROM doc.made_public_date)
),
productivity_benchmarks AS (
    SELECT
        year,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY documents_produced) AS p25_documents,
        PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY documents_produced) AS median_documents,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY documents_produced) AS p75_documents,
        AVG(documents_produced) AS avg_documents
    FROM ministry_annual_metrics
    WHERE year IS NOT NULL
    GROUP BY year
)
SELECT
    mam.org_code,
    mam.short_code,
    mam.name,
    mam.year,
    mam.documents_produced,
    mam.propositions,
    mam.government_bills,
    mam.unique_contributors,
    mam.earliest_document,
    mam.latest_document,
    pb.median_documents,
    pb.avg_documents,
    pb.p25_documents,
    pb.p75_documents,
    ROUND((CAST(mam.documents_produced AS NUMERIC) - pb.avg_documents) / NULLIF(pb.avg_documents, 0) * 100, 2) AS pct_vs_average,
    CASE
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p75_documents THEN 'TOP_QUARTILE'
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.median_documents THEN 'ABOVE_MEDIAN'
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p25_documents THEN 'BELOW_MEDIAN'
        ELSE 'BOTTOM_QUARTILE'
    END AS productivity_quartile,
    CASE
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p75_documents THEN 'High-performing ministry'
        WHEN CAST(mam.documents_produced AS NUMERIC) < pb.p25_documents THEN 'Underperforming ministry - review needed'
        ELSE 'Standard ministry performance'
    END AS performance_assessment
FROM ministry_annual_metrics mam
LEFT JOIN productivity_benchmarks pb ON pb.year = mam.year
WHERE mam.year IS NOT NULL
ORDER BY mam.year DESC, mam.documents_produced DESC",0,0,0,0,0,0,1,15.321664,15.321664,15.321664,15.321664,0,0,1347,44,34,3,0,0,0,0,0,0,0,0,0,0,107,27,162843,0,0,0,0,0,0,0,0
10,16385,t,-1369514515616296413,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_data WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,25.788495,25.788495,25.788495,25.788495,0,4,104,3738,0,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6348816182703925285,SELECT COUNT(*) FROM public.view_decision_temporal_trends,0,0,0,0,0,0,1,339.10851199999996,339.10851199999996,339.10851199999996,339.10851199999996,0,1,295984,7952,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-8719185560936294843,"SELECT c.oid, a.attnum, a.attname, c.relname, n.nspname, a.attnotnull OR (t.typtype = $1 AND t.typnotnull), a.attidentity != $2 OR pg_catalog.pg_get_expr(d.adbin, d.adrelid) LIKE $3 FROM pg_catalog.pg_class c JOIN pg_catalog.pg_namespace n ON (c.relnamespace = n.oid) JOIN pg_catalog.pg_attribute a ON (c.oid = a.attrelid) JOIN pg_catalog.pg_type t ON (a.atttypid = t.oid) LEFT JOIN pg_catalog.pg_attrdef d ON (d.adrelid = a.attrelid AND d.adnum = a.attnum) JOIN (SELECT $4 AS oid , $5 AS attnum) vals ON (c.oid = vals.oid AND a.attnum = vals.attnum) where c.oid in ($6)",0,0,0,0,0,0,2,0.09930499999999998,0.034483999999999994,0.06482099999999999,0.04965249999999999,0.0151685,2,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,3643110636234912028,select documentre0_.hjid as hjid1_31_0_ from document_reference_container documentre0_ where documentre0_.hjid=$1,0,0,0,0,0,0,1,101.337675,101.337675,101.337675,101.337675,0,1,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9016860247513676657,SELECT EXISTS(SELECT $1 FROM public.view_worldbank_indicator_data_country_summary LIMIT $2),0,0,0,0,0,0,1,0.009127,0.009127,0.009127,0.009127,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8159804249260329490,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8, $9, $10, $11]) AS col
WHERE EXISTS (SELECT $12 FROM information_schema.columns WHERE table_schema = $13 AND table_name = $14 AND column_name = col)",0,0,0,0,0,0,1,0.48128899999999997,0.48128899999999997,0.48128899999999997,0.48128899999999997,0,7,524,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7312423823288968736,"SELECT vote, COUNT(*) FROM vote_data GROUP BY vote ORDER BY COUNT(*) DESC LIMIT $1",0,0,0,0,0,0,1,1166.3942220000001,1166.3942220000001,1166.3942220000001,1166.3942220000001,0,4,11238,76059,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0.484916,0,0,1,0.333022,1,5.635967
10,16385,t,5822468714011873705,"SELECT classid, objid, refclassid, refobjid, deptype FROM pg_depend WHERE deptype != $1 AND deptype != $2
UNION ALL
SELECT $3::regclass AS classid, amopfamily AS objid, refclassid, refobjid, deptype FROM pg_depend d, pg_amop o WHERE deptype NOT IN ($4, $5, $6) AND classid = $7::regclass AND objid = o.oid AND NOT (refclassid = $8::regclass AND amopfamily = refobjid)
UNION ALL
SELECT $9::regclass AS classid, amprocfamily AS objid, refclassid, refobjid, deptype FROM pg_depend d, pg_amproc p WHERE deptype NOT IN ($10, $11, $12) AND classid = $13::regclass AND objid = p.oid AND NOT (refclassid = $14::regclass AND amprocfamily = refobjid)
ORDER BY 1,2",0,0,0,0,0,0,2,8.653711999999999,4.184315,4.469397,4.326855999999999,0.1425409999999998,10874,277,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6801007170207045690,"COPY  ( SELECT lending_type_value AS value, COUNT ( * ) AS count FROM country_element WHERE lending_type_value IS NOT NULL GROUP BY lending_type_value ORDER BY count DESC, lending_type_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.151283,0.151283,0.151283,0.151283,0,1,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5448743280689360884,COPY  ( SELECT * FROM public.view_riksdagen_party_momentum_analysis ORDER BY random ( ) LIMIT 441 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3876.242925,3876.242925,3876.242925,3876.242925,0,441,155,87280,0,0,0,0,0,0,39498,39562,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8233927595262170592,COPY  ( SELECT * FROM public.user_account ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.428752,0.428752,0.428752,0.428752,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2575218263585380758,"SELECT format_type(seqtypid, $1), seqstart, seqincrement, seqmax, seqmin, seqcache, seqcycle FROM pg_catalog.pg_sequence WHERE seqrelid = $2::oid",0,0,0,0,0,0,4,0.222495,0.00584,0.201146,0.05562375,0.08402757332083023,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-3136912395674931128,SET application_name = 'PostgreSQL JDBC Driver',0,0,0,0,0,0,9,0.06643600000000001,0.00524,0.012584,0.007381777777777777,0.0020576881189970767,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4413695709520866804,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABjzE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABlQAAAAAAAAAA',0,0,0,0,0,0,1,35.479438,35.479438,35.479438,35.479438,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,t,491826440264380884,COPY  ( SELECT * FROM public.language_data ORDER BY random ( ) LIMIT 135 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.238354,2.238354,2.238354,2.238354,0,135,57,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7419431320792419525,"COPY  ( SELECT database_source AS value, COUNT ( * ) AS count FROM document_element WHERE database_source IS NOT NULL GROUP BY database_source ORDER BY count DESC, database_source LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.432354,58.432354,58.432354,58.432354,0,5,620,34948,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,6378455590359230354,SELECT * FROM QRTZ_CRON_TRIGGERS WHERE SCHED_NAME = $3 AND TRIGGER_NAME = $1 AND TRIGGER_GROUP = $2,0,0,0,0,0,0,4,118.93831999999999,0.022412,118.785795,29.734579999999994,51.41374605667333,4,55,39,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-5443578753862467377,"select string_agg(word, $1) from pg_catalog.pg_get_keywords() where word <> ALL ($2::text[])",0,0,0,0,0,0,1,0.33768,0.33768,0.33768,0.33768,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8343709998364821431,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_monthly LIMIT $2),0,0,0,0,0,0,1,0.003658,0.003658,0.003658,0.003658,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8482561184163264767,ANALYZE public.view_riksdagen_politician_document_daily_summary,0,0,0,0,0,0,1,53.352117,53.352117,53.352117,53.352117,0,0,746,448,0,0,0,0,0,0,0,0,0,0,0,0,15,0,6593,0,0,0,0,0,0,0,0
10,16385,t,4227764554284604772,COPY  ( SELECT * FROM public.topics ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,93.019353,93.019353,93.019353,93.019353,0,200,35,113,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5957480074603075920,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_monthly,0,0,0,0,0,0,1,12.122015,12.122015,12.122015,12.122015,0,220,3178,434,7,10,0,0,0,0,0,0,0,0,0,0,445,4,72107,0,0,0,0,0,0,0,0
10,16385,t,-2491580708582908732,COPY  ( SELECT * FROM public.assignment_data ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.64543,11.64543,11.64543,11.64543,0,200,490,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6522154970503463608,COPY  ( SELECT * FROM public.rule_violation ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,163.20447199999998,163.20447199999998,163.20447199999998,163.20447199999998,0,2244,0,370,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2928089318155368361,COPY  ( SELECT * FROM public.document_attachment ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,39.15187400000001,39.15187400000001,39.15187400000001,39.15187400000001,0,300,0,3432,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8518528821204987524,SELECT $1 FROM view_party_effectiveness_trends LIMIT $2,0,0,0,0,0,0,1,29.141868000000002,29.141868000000002,29.141868000000002,29.141868000000002,0,1,2611,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7844532379763956202,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_element WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.358176,58.358176,58.358176,58.358176,0,98,425,35143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8550563833149535129,COPY  ( SELECT * FROM public.document_detail_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,208.130174,208.130174,208.130174,208.130174,0,300,0,390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6035531942033281810,ANALYZE public.view_riksdagen_org_document_daily_summary,0,0,0,0,0,0,1,66.041817,66.041817,66.041817,66.041817,0,0,716,512,1,1,0,0,0,0,0,0,0,0,0,0,13,0,6922,0,0,0,0,0,0,0,0
10,16385,f,-1739559353426161799,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_monthly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,116.290479,116.290479,116.290479,116.290479,0,500,0,3136,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7396582140474543806,ANALYZE public.view_riksdagen_vote_data_ballot_summary_annual,0,0,0,0,0,0,1,1.164275,1.164275,1.164275,1.164275,0,0,2081,4,1,0,0,0,0,0,0,0,0,0,0,0,60,1,19295,0,0,0,0,0,0,0,0
10,16385,t,-741854569545780071,COPY  ( SELECT * FROM public.portal ORDER BY random ( ) LIMIT 2 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.556663,3.556663,3.556663,3.556663,0,2,55,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3033227397386527857,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_data WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,4.039345,4.039345,4.039345,4.039345,0,6,516,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-3581113891881914687,SELECT COUNT(*) FROM public.databasechangelog,0,0,0,0,0,0,2,0.168263,0.081141,0.08712199999999999,0.0841315,0.002990499999999993,2,38,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3851409644044613228,"SELECT oid, tableoid, defaclrole, defaclnamespace, defaclobjtype, defaclacl, CASE WHEN defaclnamespace = $1 THEN acldefault(CASE WHEN defaclobjtype = $2 THEN $3::""char"" ELSE defaclobjtype END, defaclrole) ELSE $4 END AS acldefault FROM pg_default_acl",0,0,0,0,0,0,2,0.02178,0.009677999999999999,0.012102,0.01089,0.0012120000000000008,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6117209581952584091,ANALYZE public.view_riksdagen_politician_document_summary,0,0,0,0,0,0,1,10.400425,10.400425,10.400425,10.400425,0,0,3120,47,3,3,0,0,0,0,0,0,0,0,0,0,59,0,26820,0,0,0,0,0,0,0,0
10,16385,t,-496150737613603716,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,15.668675,15.668675,15.668675,15.668675,0,26,2837,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5380443545716551162,COPY  ( SELECT * FROM public.topic ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.166551,2.166551,2.166551,2.166551,0,200,0,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-600281715843379118,"SELECT tableoid, oid, prpubid, prrelid, pg_catalog.pg_get_expr(prqual, prrelid) AS prrelqual, (CASE
  WHEN pr.prattrs IS NOT NULL THEN
    (SELECT array_agg(attname)
       FROM
         pg_catalog.generate_series($1, pg_catalog.array_upper(pr.prattrs::pg_catalog.int2[], $2)) s,
         pg_catalog.pg_attribute
      WHERE attrelid = pr.prrelid AND attnum = prattrs[s])
  ELSE $3 END) prattrs FROM pg_catalog.pg_publication_rel pr",0,0,0,0,0,0,2,0.007875,0.003277,0.004598,0.0039375,0.0006605,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1255500683556144466,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_hourly_summary,0,0,0,0,0,0,1,0.222015,0.222015,0.222015,0.222015,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4823922465950100819,SET lock_timeout = 0,0,0,0,0,0,0,2,0.012162,0.004588,0.007574,0.006081,0.0014929999999999998,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1571796541742608062,COPY  ( SELECT * FROM public.jv_commit ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,23873.175871,23873.175871,23873.175871,23873.175871,0,200,0,59503,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.254084,0,0,1,0.184505,1,1.888626
10,16385,f,-8795427016998702943,COPY  ( SELECT * FROM public.committee_proposal_component_0 ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.9488,1.9488,1.9488,1.9488,0,500,0,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4013217689487553624,COPY  ( SELECT * FROM public.qrtz_locks ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.245075,1.245075,1.245075,1.245075,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1527424656654204357,DELETE FROM QRTZ_FIRED_TRIGGERS WHERE SCHED_NAME = $2 AND INSTANCE_NAME = $1,0,0,0,0,0,0,1,0.007554,0.007554,0.007554,0.007554,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1558782015711004274,SELECT COUNT(*) FROM public.view_riksdagen_party_coalation_against_annual_summary,0,0,0,0,0,0,1,48.279046,48.279046,48.279046,48.279046,0,1,0,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7723160828937076576,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary LIMIT $2),0,0,0,0,0,0,1,0.006061,0.006061,0.006061,0.006061,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4536902960160041435,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary_annual,0,0,0,0,0,0,1,219.372224,219.372224,219.372224,219.372224,0,0,7556,416,12,11,0,0,0,0,0,0,0,0,0,0,152,1,91252,0,0,0,0,0,0,0,0
10,16385,f,-1621204135258975379,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_element WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.839066,57.839066,57.839066,57.839066,0,311,232,35336,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3415800228619780236,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_daily,0,0,0,0,0,0,1,334.967114,334.967114,334.967114,334.967114,0,10619,7956,74,356,386,0,0,0,0,1525,1528,0,0,0,0,10934,28,3291649,0,0,0,0,0,0,0,0
10,16385,t,-8405950114680010935,"SELECT a.tableoid, a.oid, adrelid, adnum, pg_catalog.pg_get_expr(adbin, adrelid) AS adsrc
FROM unnest($1::pg_catalog.oid[]) AS src(tbloid)
JOIN pg_catalog.pg_attrdef a ON (src.tbloid = a.adrelid)
ORDER BY a.adrelid, a.adnum",0,0,0,0,0,0,1,0.10999500000000001,0.10999500000000001,0.10999500000000001,0.10999500000000001,0,1,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4736996810827546882,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC, intressent_id LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.194257,7.194257,7.194257,7.194257,0,2000,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7404828307920337430,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,106.732957,106.732957,106.732957,106.732957,0,91,301,494,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1844430570536601985,ANALYZE public.view_worldbank_indicator_data_country_summary,0,0,0,0,0,0,1,22.601523,22.601523,22.601523,22.601523,0,0,1740,431,6,6,0,0,0,0,0,0,0,0,0,0,102,0,51233,0,0,0,0,0,0,0,0
10,16385,t,3561734606649502704,"LOCK TABLE public.databasechangelog, public.databasechangeloglock IN ACCESS SHARE MODE",0,0,0,0,0,0,1,0.028494,0.028494,0.028494,0.028494,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5230479192573646767,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , assessment_period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , assessment_period_end ) ORDER BY random ( ) ) AS rn FROM public.view_risk_score_evolution ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 200 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,644.5583,644.5583,644.5583,644.5583,0,26,9641,17643,0,0,0,0,0,0,3042,3049,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4560142462202344260,"COPY  ( SELECT indicator_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE indicator_value IS NOT NULL GROUP BY indicator_value ORDER BY count DESC, indicator_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,63.891141,63.891141,63.891141,63.891141,0,1000,116,10255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2624935064464699498,SELECT COUNT(*) FROM public.view_ministry_decision_impact,0,0,0,0,0,0,1,220.53247100000002,220.53247100000002,220.53247100000002,220.53247100000002,0,1,303936,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6891615386937920207,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_element WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005511,0.005511,0.005511,0.005511,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,4525192573619947469,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABuTE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABvwAAAAAAAAAA',0,0,0,0,0,0,1,11.99378,11.99378,11.99378,11.99378,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
16384,16385,t,-6501983440586955713,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABRjE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABTAAAAAAAAAAA',0,0,0,0,0,0,1,18.201435,18.201435,18.201435,18.201435,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,t,4046484958314256116,"CREATE VIEW view_riksdagen_politician_influence_metrics AS
WITH co_voting_pairs AS (
    SELECT
        v1.embedded_id_intressent_id AS person_1,
        v2.embedded_id_intressent_id AS person_2,
        COUNT(*) AS co_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END) AS aligned_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END)::DOUBLE PRECISION / 
            NULLIF(COUNT(*), 0)::DOUBLE PRECISION AS alignment_rate
    FROM vote_data v1
    JOIN vote_data v2 
        ON v1.embedded_id_ballot_id = v2.embedded_id_ballot_id
        AND v1.embedded_id_intressent_id < v2.embedded_id_intressent_id
    WHERE v1.vote_date >= CURRENT_DATE - INTERVAL '3 years'
        AND UPPER(v1.vote) IN ('JA', 'NEJ')
        AND UPPER(v2.vote) IN ('JA', 'NEJ')
    GROUP BY v1.embedded_id_intressent_id, v2.embedded_id_intressent_id
    HAVING COUNT(*) >= 10
),
network_connections AS (
    SELECT person_1 AS person_id FROM co_voting_pairs WHERE alignment_rate >= 0.7
    UNION ALL
    SELECT person_2 AS person_id FROM co_voting_pairs WHERE alignment_rate >= 0.7
),
influence_metrics AS (
    SELECT person_id, COUNT(*) AS strong_connections
    FROM network_connections GROUP BY person_id
),
network_median AS (
    SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY strong_connections) AS median_connections
    FROM influence_metrics
)
SELECT
    p.id AS person_id, p.first_name, p.last_name, p.party,
    COALESCE(im.strong_connections, 0) AS network_connections,
    ROUND((SELECT median_connections FROM network_median)::NUMERIC, 2) AS network_median,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) * 2 THEN 'HIGHLY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) * 1.5 THEN 'INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) THEN 'MODERATELY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) > 0 THEN 'LIMITED_INFLUENCE'
        ELSE 'MINIMAL_INFLUENCE'
    END AS influence_classification,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= 20 THEN 'STRONG_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 10 THEN 'MODERATE_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 5 THEN 'WEAK_BROKER'
        ELSE 'NON_BROKER'
    END AS broker_classification,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) * 2 THEN 'High influence - extensive cross-party network connections'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) * 1.5 THEN 'Notable influence - above-average network centrality'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT median_connections FROM network_median) THEN 'Standard influence - typical network engagement'
        WHEN COALESCE(im.strong_connections, 0) > 0 THEN 'Limited influence - below-average network connections'
        ELSE 'Minimal network influence detected'
    END AS influence_assessment
FROM person_data p
LEFT JOIN influence_metrics im ON im.person_id = p.id
WHERE p.status IN ('Tjänstgörande riksdagsledamot', 'Tjänstgörande ersättare', 'Tillgänglig ersättare')
ORDER BY COALESCE(im.strong_connections, 0) DESC, p.last_name, p.first_name",0,0,0,0,0,0,1,348.441321,348.441321,348.441321,348.441321,0,0,1280,43,32,3,0,0,0,0,0,0,0,0,0,0,84,28,156221,0,0,0,0,0,0,0,0
10,16385,f,6955794514210982921,SELECT COUNT(*) FROM public.view_riksdagen_party_momentum_analysis,0,0,0,0,0,0,1,3270.409056,3270.409056,3270.409056,3270.409056,0,1,130,87278,0,0,0,0,0,0,36089,36152,0,0,0,0,0,0,0,13,1.164687,1,12.752277,1,98.350831,1,65.346566
10,16385,f,4580536228023179256,SELECT COUNT(*) FROM public.view_riksdagen_party_ballot_support_annual_summary,0,0,0,0,0,0,1,1004.2887810000001,1004.2887810000001,1004.2887810000001,1004.2887810000001,0,1,352454,3044,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3626419790848417270,COPY  ( SELECT * FROM public.indicator_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,12.177655000000001,12.177655000000001,12.177655000000001,12.177655000000001,0,300,0,1191,0,51,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3253083052894592554,SELECT COUNT(*) FROM public.pg_stat_statements_info,0,0,0,0,0,0,1,0.00577,0.00577,0.00577,0.00577,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4301436274434778961,"SELECT $1 ||
       $2 ||
       $3",0,0,0,0,0,0,2,0.003916,0.001893,0.002023,0.001958,6.500000000000012e-05,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,5735613436416174444,SELECT * FROM QRTZ_FIRED_TRIGGERS WHERE SCHED_NAME = $2 AND INSTANCE_NAME = $1,0,0,0,0,0,0,1,0.0109,0.0109,0.0109,0.0109,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4570799927402708811,SET extra_float_digits TO 3,0,0,0,0,0,0,2,0.012453,0.005981,0.006472,0.0062265,0.00024550000000000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6291436438045175693,"COPY  ( SELECT $1 AS info, COUNT ( * ) AS file_count FROM ( SELECT $2 ) x ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0043479999999999994,0.0043479999999999994,0.0043479999999999994,0.0043479999999999994,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3460631476371876721,REFRESH MATERIALIZED VIEW public.view_worldbank_indicator_data_country_summary,0,0,0,0,0,0,1,7226.44697,7226.44697,7226.44697,7226.44697,0,4111,2863,11701,468,514,0,0,0,0,0,0,0,0,0,0,4299,3,3666450,0,0,0,0,0,0,0,0
10,16385,f,-1578374773981578026,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_daily ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,95.114718,95.114718,95.114718,95.114718,0,500,0,354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-698687744414785459,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_element WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,60.568855,60.568855,60.568855,60.568855,0,43,16,35552,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9161374730088552495,SELECT COUNT(*) FROM public.view_party_performance_metrics,0,0,0,0,0,0,1,16.163588999999998,16.163588999999998,16.163588999999998,16.163588999999998,0,1,332,1694,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2974440911579314790,"COPY  ( SELECT against_proposal_parties AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE against_proposal_parties IS NOT NULL GROUP BY against_proposal_parties ORDER BY count DESC, against_proposal_parties LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,14.956836,14.956836,14.956836,14.956836,0,205,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,4354231258506336052,"CREATE VIEW public.view_riksdagen_politician_influence_metrics AS WITH co_voting_pairs AS (
    SELECT
        v1.embedded_id_intressent_id AS person_1,
        v2.embedded_id_intressent_id AS person_2,
        COUNT(*) AS co_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END) AS aligned_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END)::DOUBLE PRECISION / 
            NULLIF(COUNT(*), 0)::DOUBLE PRECISION AS alignment_rate
    FROM vote_data v1
    JOIN vote_data v2 
        ON v1.embedded_id_ballot_id = v2.embedded_id_ballot_id
        AND v1.embedded_id_intressent_id < v2.embedded_id_intressent_id
    WHERE v1.vote_date >= CURRENT_DATE - INTERVAL '3 years'
        AND UPPER(v1.vote) IN ('JA', 'NEJ')
        AND UPPER(v2.vote) IN ('JA', 'NEJ')
    GROUP BY v1.embedded_id_intressent_id, v2.embedded_id_intressent_id
    HAVING COUNT(*) >= 10
),
network_connections AS (
    SELECT person_1 AS person_id
    FROM co_voting_pairs
    WHERE alignment_rate >= 0.7
    
    UNION ALL
    
    SELECT person_2 AS person_id
    FROM co_voting_pairs
    WHERE alignment_rate >= 0.7
),
influence_metrics AS (
    SELECT
        person_id,
        COUNT(*) AS strong_connections
    FROM network_connections
    GROUP BY person_id
),
network_percentiles AS (
    SELECT 
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY strong_connections) AS p50,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY strong_connections) AS p75,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY strong_connections) AS p90
    FROM influence_metrics
)
SELECT
    p.id AS person_id,
    p.first_name,
    p.last_name,
    p.party,
    
    COALESCE(im.strong_connections, 0) AS network_connections,
    ROUND((SELECT p50 FROM network_percentiles)::NUMERIC, 2) AS network_median,
    
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p90 FROM network_percentiles) THEN 'HIGHLY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p75 FROM network_percentiles) THEN 'INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p50 FROM network_percentiles) THEN 'MODERATELY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) > 0 THEN 'LIMITED_INFLUENCE'
        ELSE 'MINIMAL_INFLUENCE'
    END AS influence_classification,
    
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= 20 THEN 'STRONG_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 10 THEN 'MODERATE_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 5 THEN 'WEAK_BROKER'
        ELSE 'NON_BROKER'
    END AS broker_classification,
    
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p90 FROM network_percentiles) 
            THEN 'High influence - top 10% network connections'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p75 FROM network_percentiles) 
            THEN 'Notable influence - top 25% network centrality'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p50 FROM network_percentiles) 
            THEN 'Standard influence - above median engagement'
        WHEN COALESCE(im.strong_connections, 0) > 0 
            THEN 'Limited influence - below median connections'
        ELSE 'Minimal network influence detected'
    END AS influence_assessment

FROM person_data p
LEFT JOIN influence_metrics im ON im.person_id = p.id
WHERE p.status IN ('Tjänstgörande riksdagsledamot', 'Tjänstgörande ersättare', 'Tillgänglig ersättare')
ORDER BY 
    COALESCE(im.strong_connections, 0) DESC,
    p.last_name, p.first_name",0,0,0,0,0,0,1,8.279424,8.279424,8.279424,8.279424,0,0,753,5,27,1,0,0,0,0,0,0,0,0,0,0,83,24,143388,0,0,0,0,0,0,0,0
10,16385,f,3598628838190182473,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_weekly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,612.050022,612.050022,612.050022,612.050022,0,500,0,9088,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7652294891628938372,COPY  ( SELECT * FROM public.document_status_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,27.441222,27.441222,27.441222,27.441222,0,300,0,1079,0,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5263177254193876653,SELECT COUNT(*) FROM public.view_risk_score_evolution,0,0,0,0,0,0,1,661.03476,661.03476,661.03476,661.03476,0,1,8991,17781,0,0,0,0,0,0,2724,2731,0,0,0,0,0,0,0,73,3.400925,0,0,1,1.581314,1,33.554789
10,16385,f,1727930464514963854,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document_summary,0,0,0,0,0,0,1,435.262042,435.262042,435.262042,435.262042,0,1346,4450,4011,48,66,0,0,0,0,1852,1858,0,0,0,0,1566,1,425208,0,0,0,0,0,0,0,0
10,16385,f,-7368150425044334427,COPY  ( SELECT * FROM public.person_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,9.748447,9.748447,9.748447,9.748447,0,2132,0,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6444382014529650695,SELECT pg_catalog.pg_get_viewdef($1::pg_catalog.oid) AS viewdef,0,0,0,0,0,0,81,223.94224899999998,0.067236,104.756615,2.76471912345679,14.13132095563508,81,3014,68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-371640136827155683,SELECT MAX(commit_id) FROM jv_commit WHERE $1 = $2,0,0,0,0,0,0,10,161.187619,0.018935,160.970745,16.118761899999996,48.283994637345366,10,36,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1765737068544824848,SELECT COUNT(*) FROM public.view_document_data_committee_report_url,0,0,0,0,0,0,1,12.026881999999999,12.026881999999999,12.026881999999999,12.026881999999999,0,1,3692,37,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5318790267498464729,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM document_element WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.9811,55.9811,55.9811,55.9811,0,60,328,35240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3856618091206863206,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_annual LIMIT $2),0,0,0,0,0,0,1,0.004068,0.004068,0.004068,0.004068,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5598976059954092027,COPY  ( SELECT * FROM public.qrtz_scheduler_state ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,22.415468,22.415468,22.415468,22.415468,0,1,330,427,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6070794187734313968,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'year' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 20 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.505976,0.505976,0.505976,0.505976,0,2,26,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7178746570199941007,"SELECT tableoid, oid, lanname, lanpltrusted, lanplcallfoid, laninline, lanvalidator, lanacl, acldefault($1, lanowner) AS acldefault, lanowner FROM pg_language WHERE lanispl ORDER BY oid",0,0,0,0,0,0,2,0.9454659999999999,0.012173,0.9332929999999999,0.47273299999999996,0.46055999999999997,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4827987536070876738,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM vote_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,337.26363,337.26363,337.26363,337.26363,0,9,10029,77268,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-6104492693943295281,DROP VIEW IF EXISTS view_riksdagen_politician_influence_metrics CASCADE,0,0,0,0,0,0,1,2.019241,2.019241,2.019241,2.019241,0,0,383,0,8,0,0,0,0,0,0,0,0,0,0,0,34,8,43772,0,0,0,0,0,0,0,0
10,16385,t,6880796086792617624,"SELECT tableoid, oid, amname, amtype, amhandler::pg_catalog.regproc AS amhandler FROM pg_am",0,0,0,0,0,0,2,0.151603,0.065001,0.086602,0.0758015,0.010800499999999994,18,111,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7149767135925760901,DROP TABLE IF EXISTS cia_view_row_counts,0,0,0,0,0,0,1,33.584341,33.584341,33.584341,33.584341,0,0,36,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4782678155027226578,"SELECT label, provider, classoid, objoid, objsubid FROM pg_catalog.pg_seclabels ORDER BY classoid, objoid, objsubid",0,0,0,0,0,0,2,0.07796600000000001,0.038923,0.039043,0.038983000000000004,5.999999999999929e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7472345096064734668,"SET TRANSACTION ISOLATION LEVEL REPEATABLE READ, READ ONLY",0,0,0,0,0,0,2,0.006862,0.003296,0.003566,0.003431,0.00013500000000000014,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3625861076909970526,COPY  ( SELECT * FROM public.indicator_element ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,12.467556,12.467556,12.467556,12.467556,0,300,78,1202,0,51,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1072807306216464732,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_daily ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,1317.384057,1317.384057,1317.384057,1317.384057,0,500,0,22592,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4638273750838203895,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,17.096241000000003,17.096241000000003,17.096241000000003,17.096241000000003,0,4,2721,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8973944630144950548,COPY  ( SELECT * FROM public.jv_snapshot ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,395093.458375,395093.458375,395093.458375,395093.458375,0,200,117,918398,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1523430487889920892,COPY  ( SELECT * FROM public.qrtz_scheduler_state ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,21.201359999999998,21.201359999999998,21.201359999999998,21.201359999999998,0,1,0,123,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,652895491626851819,"LOCK TABLE public.databasechangelog, public.databasechangeloglock, public.against_proposal_container, public.against_proposal_data, public.agency, public.application_action_event, public.application_session, public.application_view, public.assignment_data, public.assignment_element, public.committee_document_data, public.committee_proposal_component_0, public.committee_proposal_container, public.committee_proposal_data, public.countries_element, public.country_element, public.data_element, public.data_source_content, public.detail_data, public.detail_element, public.document_activity_container, public.document_activity_data, public.document_attachment, public.document_attachment_container, public.document_container_element, public.document_content_data, public.document_data, public.document_detail_container, public.document_detail_data, public.document_element, public.document_person_reference_co_0, public.document_person_reference_da_0, public.document_reference_container, public.document_reference_data, public.document_status_container, public.domain_portal, public.indicator_element, public.indicators_element, public.language_content_data, public.language_data, public.operational_information_cont_0, public.performance_indicator_content, public.person_assignment_data, public.person_assignment_element, public.person_container_data, public.person_container_element, public.person_data, public.person_detail_data, public.person_detail_element, public.person_element, public.portal, public.quality_assurance_content, public.sweden_county_data, public.sweden_county_data_container, public.sweden_county_electoral_area, public.sweden_county_electoral_regi_0, public.sweden_county_electoral_regi_1, public.sweden_election_region, public.sweden_election_type, public.sweden_election_type_contain_0, public.sweden_municipality_data, public.sweden_municipality_election_0, public.sweden_parliament_electoral__0, public.sweden_parliament_electoral__1, public.sweden_political_party, public.target_profile_content, public.topic, public.topics, public.user_account, public.user_account_address, public.vote_data, public.vote_meta_data, public.world_bank_data, public.document_proposal_container, public.document_proposal_data, public.application_configuration, public.qrtz_calendars, public.qrtz_cron_triggers, public.qrtz_fired_triggers, public.qrtz_paused_trigger_grps, public.qrtz_scheduler_state, public.qrtz_locks, public.qrtz_job_details, public.qrtz_simple_triggers, public.qrtz_simprop_triggers, public.qrtz_blob_triggers, public.qrtz_triggers, public.encrypted_value, public.jv_commit, public.jv_commit_property, public.jv_global_id, public.jv_snapshot, public.rule_violation IN ACCESS SHARE MODE",0,0,0,0,0,0,1,0.577899,0.577899,0.577899,0.577899,0,0,586,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5225463843642660833,COPY  ( SELECT * FROM public.application_configuration ORDER BY random ( ) LIMIT 14 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.511615,0.511615,0.511615,0.511615,0,14,65,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4505663544546256099,COPY  ( SELECT * FROM public.against_proposal_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,12.477554999999999,12.477554999999999,12.477554999999999,12.477554999999999,0,300,0,675,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-11929036931261372,SELECT COUNT(*) FROM public.view_application_action_event_page_element_annual_summary,0,0,0,0,0,0,1,0.11995399999999999,0.11995399999999999,0.11995399999999999,0.11995399999999999,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1029439511594715833,"SELECT c.tableoid, c.oid, c.relname, c.relnamespace, c.relkind, c.reltype, c.relowner, c.relchecks, c.relhasindex, c.relhasrules, c.relpages, c.relhastriggers, c.relpersistence, c.reloftype, c.relacl, acldefault(CASE WHEN c.relkind = $1 THEN $2::""char"" ELSE $3::""char"" END, c.relowner) AS acldefault, CASE WHEN c.relkind = $4 THEN (SELECT ftserver FROM pg_catalog.pg_foreign_table WHERE ftrelid = c.oid) ELSE $5 END AS foreignserver, c.relfrozenxid, tc.relfrozenxid AS tfrozenxid, tc.oid AS toid, tc.relpages AS toastpages, tc.reloptions AS toast_reloptions, d.refobjid AS owning_tab, d.refobjsubid AS owning_col, tsp.spcname AS reltablespace, $6 AS relhasoids, c.relispopulated, c.relreplident, c.relrowsecurity, c.relforcerowsecurity, c.relminmxid, tc.relminmxid AS tminmxid, array_remove(array_remove(c.reloptions,$7),$8) AS reloptions, CASE WHEN $9 = ANY (c.reloptions) THEN $10::text WHEN $11 = ANY (c.reloptions) THEN $12::text ELSE $13 END AS checkoption, am.amname, (d.deptype = $14) IS TRUE AS is_identity_sequence, c.relispartition AS ispartition 
FROM pg_class c
LEFT JOIN pg_depend d ON (c.relkind = $15 AND d.classid = $16::regclass AND d.objid = c.oid AND d.objsubid = $17 AND d.refclassid = $18::regclass AND d.deptype IN ($19, $20))
LEFT JOIN pg_tablespace tsp ON (tsp.oid = c.reltablespace)
LEFT JOIN pg_am am ON (c.relam = am.oid)
LEFT JOIN pg_class tc ON (c.reltoastrelid = tc.oid AND tc.relkind = $21 AND c.relkind <> $22)
WHERE c.relkind IN ($23, $24, $25, $26, $27, $28, $29)
ORDER BY c.oid",0,0,0,0,0,0,2,190.027752,3.5472949999999996,186.480457,95.013876,91.466581,778,1406,100,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,4657953789397675476,"SELECT * FROM public.databasechangelog ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC",0,0,0,0,0,0,2,1.306249,0.633953,0.672296,0.6531245,0.019171500000000008,904,44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8204129127152496996,"COPY  ( SELECT ballot_summary_item AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE ballot_summary_item IS NOT NULL GROUP BY ballot_summary_item ORDER BY count DESC, ballot_summary_item LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,36.817805,36.817805,36.817805,36.817805,0,1000,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7431099454512653578,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_daily LIMIT $2),0,0,0,0,0,0,1,0.007284,0.007284,0.007284,0.007284,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6935556497914484849,COPY  ( SELECT * FROM public.document_activity_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,143.196326,143.196326,143.196326,143.196326,0,300,38,396,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-3134125971358746080,"UPDATE public.databasechangeloglock SET LOCKED = $1, LOCKEDBY = $2, LOCKGRANTED = $3 WHERE ID = $4",0,0,0,0,0,0,1,0.032750999999999995,0.032750999999999995,0.032750999999999995,0.032750999999999995,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,69,0,0,0,0,0,0,0,0
16384,16385,t,7348123062353672566,"SELECT pid, query_start, state, query 
FROM pg_stat_activity 
WHERE state = $1 AND query NOT LIKE $2",0,0,0,0,0,0,1,0.081372,0.081372,0.081372,0.081372,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3811993232039139646,ANALYZE public.view_riksdagen_party_document_daily_summary,0,0,0,0,0,0,1,11.061841,11.061841,11.061841,11.061841,0,0,1008,70,1,1,0,0,0,0,0,0,0,0,0,0,18,0,7980,0,0,0,0,0,0,0,0
10,16385,f,-4482854031880361909,SELECT COUNT(*) FROM public.view_application_action_event_page_element_weekly_summary,0,0,0,0,0,0,1,0.13431099999999999,0.13431099999999999,0.13431099999999999,0.13431099999999999,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6145455670024909418,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary_weekly,0,0,0,0,0,0,1,1770.14955,1770.14955,1770.14955,1770.14955,0,0,7307,9424,22,10,0,0,0,0,0,0,0,0,0,0,163,12,167191,0,0,0,0,0,0,0,0
10,16385,f,-8892824731550586216,SELECT COUNT(*) FROM public.view_application_action_event_page_element_daily_summary,0,0,0,0,0,0,1,0.09553800000000001,0.09553800000000001,0.09553800000000001,0.09553800000000001,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3551006506809048098,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_element WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.105788,0.105788,0.105788,0.105788,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1424311604901364407,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM committee_document_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.8910820000000002,1.8910820000000002,1.8910820000000002,1.8910820000000002,0,27,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-148635312786774389,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_element WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.008065,0.008065,0.008065,0.008065,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6135164882767620145,"COPY  ( SELECT outcome AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE outcome IS NOT NULL GROUP BY outcome ORDER BY count DESC, outcome LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.107,0.107,0.107,0.107,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4146625008955279614,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_annual ORDER BY random ( ) LIMIT 24 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3.388511,3.388511,3.388511,3.388511,0,24,749,98,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-706298722487152081,COPY  ( SELECT * FROM public.committee_proposal_data ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,83.476746,83.476746,83.476746,83.476746,0,500,55,2850,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1984321517201349341,"SELECT influence_classification, COUNT(*) FROM view_riksdagen_politician_influence_metrics GROUP BY influence_classification ORDER BY count DESC",0,0,0,0,0,0,2,67028.370912,33217.23403,33811.136882,33514.185456,296.9514259999996,8,60854,145301,0,0,0,0,0,0,1535466,1538220,0,0,0,0,0,0,0,130,6.5623830000000005,0,0,2,2.774132,2,69.35347
10,16385,t,4960414832108494333,"COPY  ( SELECT file_type AS value, COUNT ( * ) AS count FROM document_attachment WHERE file_type IS NOT NULL GROUP BY file_type ORDER BY count DESC, file_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,87.285656,87.285656,87.285656,87.285656,0,4,56,3435,0,61,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,430446580820009749,ANALYZE public.view_riksdagen_politician_document,0,0,0,0,0,0,1,317.777006,317.777006,317.777006,317.777006,0,0,3321,6465,4,4,0,0,0,0,0,0,0,0,0,0,81,0,35305,0,0,0,0,0,0,0,0
10,16385,f,4335700726042933519,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_daily,0,0,0,0,0,0,1,26591.743371,26591.743371,26591.743371,26591.743371,0,458976,52875,159543,22606,43140,0,0,0,0,174949,175157,0,0,0,0,461587,2304,209462573,0,0,0,0,0,0,0,0
10,16385,f,-6054154482591023259,COPY  ( SELECT * FROM public.view_riksdagen_party_momentum_analysis ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3861.187978,3861.187978,3861.187978,3861.187978,0,441,130,87278,0,0,0,0,0,0,39498,39562,0,0,0,0,0,0,0,36,2.835021,1,13.510612,1,257.096582,1,181.179462
10,16385,t,-5430280821704565097,DROP VIEW IF EXISTS view_ministry_productivity_matrix CASCADE,0,0,0,0,0,0,1,102.217437,102.217437,102.217437,102.217437,0,0,463,26,9,0,0,0,0,0,0,0,0,0,0,0,46,9,69649,0,0,0,0,0,0,0,0
10,16385,t,7307336668807190247,"WITH RECURSIVE w AS ( SELECT d1.objid, d2.refobjid, c2.relkind AS refrelkind FROM pg_depend d1 JOIN pg_class c1 ON c1.oid = d1.objid AND c1.relkind = $1 JOIN pg_rewrite r1 ON r1.ev_class = d1.objid JOIN pg_depend d2 ON d2.classid = $2::regclass AND d2.objid = r1.oid AND d2.refobjid <> d1.objid JOIN pg_class c2 ON c2.oid = d2.refobjid AND c2.relkind IN ($3,$4) WHERE d1.classid = $5::regclass UNION SELECT w.objid, d3.refobjid, c3.relkind FROM w JOIN pg_rewrite r3 ON r3.ev_class = w.refobjid JOIN pg_depend d3 ON d3.classid = $6::regclass AND d3.objid = r3.oid AND d3.refobjid <> w.refobjid JOIN pg_class c3 ON c3.oid = d3.refobjid AND c3.relkind IN ($7,$8) ) SELECT $9::regclass::oid AS classid, objid, refobjid FROM w WHERE refrelkind = $10",0,0,0,0,0,0,1,14.915387,14.915387,14.915387,14.915387,0,50,50391,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3314904168006488151,"COPY  ( SELECT born_year AS value, COUNT ( * ) AS count FROM person_element WHERE born_year IS NOT NULL GROUP BY born_year ORDER BY count DESC, born_year LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.495613,0.495613,0.495613,0.495613,0,0,37,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2223834402937852280,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM committee_document_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3.394959,3.394959,3.394959,3.394959,0,113,303,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7201423780298819011,SELECT COUNT(*) FROM public.view_riksdagen_politician_influence_metrics,0,0,0,0,0,0,1,39805.505213000004,39805.505213000004,39805.505213000004,39805.505213000004,0,1,381,102686,0,0,0,0,0,0,767784,769122,0,0,0,0,0,0,0,63,3.095956,0,0,1,1.367183,1,29.988906
16384,16385,t,2323669589107905898,SHOW SEARCH_PATH,0,0,0,0,0,0,5,0.019697,0.003336,0.004358,0.0039394,0.00036893229731212206,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5090431266680043341,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_annual ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,77.007244,77.007244,77.007244,77.007244,0,500,0,415,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5679122347572929819,COPY  ( SELECT * FROM public.document_reference_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,52.955636,52.955636,52.955636,52.955636,0,300,0,3266,0,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8001273667366129500,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM document_activity_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,344.87521,344.87521,344.87521,344.87521,0,33,56,4989,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-7347557956666089713,SELECT COUNT(TRIGGER_NAME) FROM QRTZ_TRIGGERS WHERE SCHED_NAME = $3 AND NOT (MISFIRE_INSTR = $4) AND NEXT_FIRE_TIME < $1 AND TRIGGER_STATE = $2,0,0,0,0,0,0,1631,591.0604829999993,0.157013,223.29588,0.3623914671980382,5.522128326036724,1631,102749,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5963933463454577571,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_politician_document_summary LIMIT $2),0,0,0,0,0,0,1,0.010189,0.010189,0.010189,0.010189,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-7365961848139521725,SELECT DISTINCT INSTANCE_NAME FROM QRTZ_FIRED_TRIGGERS WHERE SCHED_NAME = $1,0,0,0,0,0,0,1,59.183147999999996,59.183147999999996,59.183147999999996,59.183147999999996,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6003873705085801111,"COPY  ( SELECT election_type AS value, COUNT ( * ) AS count FROM sweden_election_type WHERE election_type IS NOT NULL GROUP BY election_type ORDER BY count DESC, election_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004919,0.004919,0.004919,0.004919,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2614040841085614376,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_element WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.115165,0.115165,0.115165,0.115165,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1413818481440887269,"SELECT $1 ||
       $2",0,0,0,0,0,0,1,0.003196,0.003196,0.003196,0.003196,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5732500202216659553,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.635636,58.635636,58.635636,58.635636,0,500,130,35438,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7817136189600111777,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.438396,1.438396,1.438396,1.438396,0,17,0,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,885099156377194574,"SELECT influence_classification, COUNT(*) FROM view_riksdagen_politician_influence_metrics GROUP BY influence_classification ORDER BY count DESC",0,0,0,0,0,0,1,33545.744137,33545.744137,33545.744137,33545.744137,0,5,30121,72957,0,0,0,0,0,0,767783,769164,0,0,0,0,0,0,0,73,3.632718,0,0,1,1.402549,1,34.569906
10,16385,t,-6104492693943295281,DROP VIEW IF EXISTS view_riksdagen_politician_influence_metrics CASCADE,0,0,0,0,0,0,2,132.362151,23.928019,108.434132,66.1810755,42.25305650000001,0,874,73,16,0,0,0,0,0,0,0,0,0,0,0,68,16,94280,0,0,0,0,0,0,0,0
10,16385,f,913358644736709385,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_weekly_summary,0,0,0,0,0,0,1,0.161802,0.161802,0.161802,0.161802,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2872076666696036723,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM document_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,25.415588999999997,25.415588999999997,25.415588999999997,25.415588999999997,0,28,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,3056798788834760739,select current_schema(),0,0,0,0,0,0,1,0.012313000000000001,0.012313000000000001,0.012313000000000001,0.012313000000000001,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1458370435439558615,SELECT COUNT(*) FROM public.view_riksdagen_politician_decision_pattern,0,0,0,0,0,0,1,804.58302,804.58302,804.58302,804.58302,0,1,1161672,1110,0,0,0,0,0,0,1890,1893,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3924792710864715419,COPY  ( SELECT * FROM public.application_action_event ORDER BY random ( ) LIMIT 241 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,191.944963,191.944963,191.944963,191.944963,0,241,197,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2983169621472336468,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_decision_type_org_summary,0,0,0,0,0,0,1,72.359729,72.359729,72.359729,72.359729,0,7210,4105,71,70,129,0,0,0,0,0,0,0,0,0,0,7401,12,814226,0,0,0,0,0,0,0,0
16384,16385,t,-6247289422746723154,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABjzE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABlQAAAAAAAAAA',0,0,0,0,0,0,1,0.000671,0.000671,0.000671,0.000671,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1188608791102666321,SELECT COUNT(*) FROM public.view_politician_risk_summary,0,0,0,0,0,0,1,795.3879860000001,795.3879860000001,795.3879860000001,795.3879860000001,0,1,11565,11700,0,50,0,0,0,0,2227,2234,0,0,0,0,0,0,0,81,3.995301,0,0,1,1.548623,1,36.077316
10,16385,f,-155783409164599480,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_data WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,26.84534,26.84534,26.84534,26.84534,0,16,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4658353193032237161,SELECT COUNT(*) FROM public.view_riksdagen_party,0,0,0,0,0,0,1,84.677864,84.677864,84.677864,84.677864,0,1,0,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7711212152828324339,"SELECT party, COUNT(*) as cnt, MIN(network_connections) as min_conn, MAX(network_connections) as max_conn FROM view_riksdagen_politician_influence_metrics GROUP BY party ORDER BY cnt DESC LIMIT $1",0,0,0,0,0,0,1,2.181224,2.181224,2.181224,2.181224,0,9,346,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-691775195328610,ANALYZE public.view_riksdagen_committee_decision_type_org_summary,0,0,0,0,0,0,1,11.53819,11.53819,11.53819,11.53819,0,0,1106,68,0,0,0,0,0,0,0,0,0,0,0,0,18,0,5718,0,0,0,0,0,0,0,0
10,16385,t,6937149974915068530,SELECT pg_catalog.pg_is_in_recovery(),0,0,0,0,0,0,2,0.0045379999999999995,0.001883,0.002655,0.0022689999999999997,0.0003859999999999999,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4822073321403193724,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_ballot_decision_summary,0,0,0,0,0,0,1,361.058764,361.058764,361.058764,361.058764,0,4522,7534,837,213,259,0,0,0,0,0,0,0,0,0,0,4794,26,1800007,0,0,0,0,0,0,0,0
10,16385,t,-2732772957681720059,COPY  ( SELECT * FROM public.against_proposal_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,113.972739,113.972739,113.972739,113.972739,0,300,130,45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2425967663550371356,RESET search_path,0,0,0,0,0,0,2,0.001603,0.000732,0.000871,0.0008015,6.950000000000001e-05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2010345667430201340,"COPY  ( SELECT role_description AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE role_description IS NOT NULL GROUP BY role_description ORDER BY count DESC, role_description LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,33.341763,33.341763,33.341763,33.341763,0,1,3592,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4785649713190980458,"SELECT broker_classification, COUNT(*) as cnt FROM view_riksdagen_politician_influence_metrics GROUP BY broker_classification ORDER BY cnt DESC",0,0,0,0,0,0,1,1.820209,1.820209,1.820209,1.820209,0,1,346,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4464193089502122941,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_annual LIMIT $2),0,0,0,0,0,0,1,0.003907,0.003907,0.003907,0.003907,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2777911020036200922,SELECT COUNT(*) FROM public.view_audit_author_summary,0,0,0,0,0,0,1,1459.9763619999999,1459.9763619999999,1459.9763619999999,1459.9763619999999,0,1,48,59471,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3396217302353414303,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_weekly ORDER BY random ( ) LIMIT 670 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,34.153996,34.153996,34.153996,34.153996,0,670,1119,319,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4742177102316246047,"COPY  ( SELECT chamber AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE chamber IS NOT NULL GROUP BY chamber ORDER BY count DESC, chamber LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2144.854703,2144.854703,2144.854703,2144.854703,0,25,62,2729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6582359452251153988,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,276.304394,276.304394,276.304394,276.304394,0,17,0,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,3152028911534560268,DELETE FROM QRTZ_SCHEDULER_STATE WHERE SCHED_NAME = $2 AND INSTANCE_NAME = $1,0,0,0,0,0,0,1,0.016531,0.016531,0.016531,0.016531,0,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,54,0,0,0,0,0,0,0,0
10,16385,f,2944368422948160087,SELECT COUNT(*) FROM public.view_riksdagen_goverment,0,0,0,0,0,0,1,401.668491,401.668491,401.668491,401.668491,0,1,845,968,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,1.903584,1,20.190721,1,178.674232,1,112.87618
16384,16385,t,359198940688990261,"CREATE VIEW public.view_ministry_productivity_matrix AS WITH ministry_base AS (
    -- Get distinct ministry assignments from assignment_data
    -- Uses assignment_type = 'Departement' to identify ministries
    SELECT DISTINCT
        org_code,
        org_code AS short_code,
        detail AS name,
        LOWER(detail) AS name_lower
    FROM assignment_data
    WHERE assignment_type = 'Departement'
        AND org_code IS NOT NULL
        AND detail IS NOT NULL
),
ministry_document_data AS (
    -- Direct query to base tables instead of materialized view
    SELECT 
        dsc.hjid AS id,
        dd.document_type,
        dd.made_public_date,
        dd.org,
        LOWER(dd.org) AS org_lower,
        dpr.person_reference_id
    FROM document_status_container dsc
    LEFT JOIN document_data dd 
        ON dsc.document_document_status_con_0 = dd.id
    LEFT JOIN document_person_reference_co_0 dprc 
        ON dsc.hjid = dprc.hjid
    LEFT JOIN document_person_reference_da_0 dpr 
        ON dpr.document_person_reference_li_1 = dprc.hjid
    WHERE dd.made_public_date IS NOT NULL
),
ministry_annual_metrics AS (
    -- Calculate annual document metrics per ministry
    -- Join on full ministry name (detail) instead of org_code
    SELECT
        m.org_code,
        m.short_code,
        m.name,
        EXTRACT(YEAR FROM doc.made_public_date) AS year,
        COUNT(DISTINCT doc.id) AS documents_produced,
        COUNT(DISTINCT CASE WHEN LOWER(doc.document_type) = 'prop' THEN doc.id END) AS propositions,
        COUNT(DISTINCT CASE WHEN LOWER(doc.document_type) = 'ds' THEN doc.id END) AS government_bills,
        COUNT(DISTINCT doc.person_reference_id) AS unique_contributors,
        MIN(doc.made_public_date) AS earliest_document,
        MAX(doc.made_public_date) AS latest_document
    FROM ministry_base m
    LEFT JOIN ministry_document_data doc 
        ON doc.org_lower = m.name_lower
        AND doc.made_public_date >= CURRENT_DATE - INTERVAL '3 years'
    GROUP BY m.org_code, m.short_code, m.name, EXTRACT(YEAR FROM doc.made_public_date)
),
productivity_benchmarks AS (
    -- Calculate productivity benchmarks per year for quartile analysis
    SELECT
        year,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY documents_produced) AS p25_documents,
        PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY documents_produced) AS median_documents,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY documents_produced) AS p75_documents,
        AVG(documents_produced) AS avg_documents
    FROM ministry_annual_metrics
    WHERE year IS NOT NULL
    GROUP BY year
)
SELECT
    mam.org_code,
    mam.short_code,
    mam.name,
    mam.year,
    mam.documents_produced,
    mam.propositions,
    mam.government_bills,
    mam.unique_contributors,
    mam.earliest_document,
    mam.latest_document,
    pb.median_documents,
    pb.avg_documents,
    pb.p25_documents,
    pb.p75_documents,
    ROUND((CAST(mam.documents_produced AS NUMERIC) - pb.avg_documents) / NULLIF(pb.avg_documents, 0) * 100, 2) AS pct_vs_average,
    
    -- Productivity quartile classification
    CASE
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p75_documents THEN 'TOP_QUARTILE'
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.median_documents THEN 'ABOVE_MEDIAN'
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p25_documents THEN 'BELOW_MEDIAN'
        ELSE 'BOTTOM_QUARTILE'
    END AS productivity_quartile,
    
    -- Performance assessment
    CASE
        WHEN CAST(mam.documents_produced AS NUMERIC) >= pb.p75_documents THEN 'High-performing ministry'
        WHEN CAST(mam.documents_produced AS NUMERIC) < pb.p25_documents THEN 'Underperforming ministry - review needed'
        ELSE 'Standard ministry performance'
    END AS performance_assessment
FROM ministry_annual_metrics mam
LEFT JOIN productivity_benchmarks pb ON pb.year = mam.year
WHERE mam.year IS NOT NULL
ORDER BY mam.year DESC, mam.documents_produced DESC",0,0,0,0,0,0,1,4.111599,4.111599,4.111599,4.111599,0,0,600,0,7,2,0,0,0,0,0,0,0,0,0,0,109,4,47976,0,0,0,0,0,0,0,0
16384,16385,t,-6090167246029394158,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABgjE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABiAAAAAAAAAAA',0,0,0,0,0,0,1,12.206773,12.206773,12.206773,12.206773,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
16384,16385,t,774241145234966444,"SELECT current_database() AS ""TABLE_CAT"", n.nspname AS ""TABLE_SCHEM"", c.relname AS ""TABLE_NAME"",  CASE n.nspname ~ $3 OR n.nspname = $4  WHEN $5 THEN CASE  WHEN n.nspname = $6 OR n.nspname = $7 THEN CASE c.relkind   WHEN $8 THEN $9   WHEN $10 THEN $11   WHEN $12 THEN $13   ELSE $14   END  WHEN n.nspname = $15 THEN CASE c.relkind   WHEN $16 THEN $17   WHEN $18 THEN $19   ELSE $20   END  ELSE CASE c.relkind   WHEN $21 THEN $22   WHEN $23 THEN $24   WHEN $25 THEN $26   WHEN $27 THEN $28   WHEN $29 THEN $30   ELSE $31   END  END  WHEN $32 THEN CASE c.relkind  WHEN $33 THEN $34  WHEN $35 THEN $36  WHEN $37 THEN $38  WHEN $39 then $40  WHEN $41 THEN $42  WHEN $43 THEN $44  WHEN $45 THEN $46  WHEN $47 THEN $48  WHEN $49 THEN $50  ELSE $51  END  ELSE $52  END  AS ""TABLE_TYPE"", d.description AS ""REMARKS"",  $53 as ""TYPE_CAT"", $54 as ""TYPE_SCHEM"", $55 as ""TYPE_NAME"", $56 AS ""SELF_REFERENCING_COL_NAME"", $57 AS ""REF_GENERATION""  FROM pg_catalog.pg_namespace n, pg_catalog.pg_class c  LEFT JOIN pg_catalog.pg_description d ON (c.oid = d.objoid AND d.objsubid = $58  and d.classoid = $59::regclass)  WHERE c.relnamespace = n.oid  AND n.nspname LIKE $1 AND c.relname LIKE $2 AND ($60  OR ( c.relkind = $61 AND n.nspname !~ $62 AND n.nspname <> $63 )  OR ( c.relkind = $64 AND n.nspname !~ $65 AND n.nspname <> $66 ) )  ORDER BY ""TABLE_TYPE"",""TABLE_SCHEM"",""TABLE_NAME""",0,0,0,0,0,0,1,0.189755,0.189755,0.189755,0.189755,0,1,15,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8387063386570418912,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_element WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.48146,61.48146,61.48146,61.48146,0,43,62,35554,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1050309689711967465,COPY  ( SELECT * FROM public.jv_snapshot ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,395087.85250599997,395087.85250599997,395087.85250599997,395087.85250599997,0,200,31,918390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.344504,1,1.34932,1,18.302083,1,11.32911
10,16385,t,-633881492024641539,"SELECT classid, objid, refobjid FROM pg_depend WHERE refclassid = $1::regclass AND deptype = $2 ORDER BY 3",0,0,0,0,0,0,2,3.6516599999999997,0.167563,3.4840969999999998,1.8258299999999998,1.658267,566,16,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4246814279823315451,"COPY  ( SELECT document_format AS value, COUNT ( * ) AS count FROM document_element WHERE document_format IS NOT NULL GROUP BY document_format ORDER BY count DESC, document_format LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.824364,55.824364,55.824364,55.824364,0,1,814,34757,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-247354889969116302,SELECT COUNT(*) FROM public.view_riksdagen_party_role_member,0,0,0,0,0,0,1,0.536712,0.536712,0.536712,0.536712,0,1,169,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6802490887002930205,COPY  ( SELECT * FROM public.assignment_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.427374,11.427374,11.427374,11.427374,0,200,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1287974992885619896,UPDATE QRTZ_SCHEDULER_STATE SET LAST_CHECKIN_TIME = $1 WHERE SCHED_NAME = $3 AND INSTANCE_NAME = $2,0,0,0,0,0,0,1,0.013865,0.013865,0.013865,0.013865,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-8150942465235553317,select count(swedenpoli0_.hjid) as col_0_0_ from sweden_political_party swedenpoli0_,0,0,0,0,0,0,1,0.056986,0.056986,0.056986,0.056986,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5223633756975509111,COPY  ( SELECT * FROM public.country_element ORDER BY random ( ) LIMIT 211 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.5565,0.5565,0.5565,0.5565,0,211,35,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-9111518282906181666,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_element WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.577346,58.577346,58.577346,58.577346,0,98,428,35143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1681869960115804855,SELECT COUNT(*) FROM public.view_riksdagen_committee,0,0,0,0,0,0,1,381.782191,381.782191,381.782191,381.782191,0,1,152,6791,0,0,0,0,0,0,1394,1399,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7412288205320054606,COPY  ( SELECT * FROM public.agency ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.066775,0.066775,0.066775,0.066775,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1553221953313226905,"CREATE TEMP TABLE IF NOT EXISTS tmp_mv_refresh_state (
        schemaname  text NOT NULL,
        matviewname text NOT NULL,
        PRIMARY KEY (schemaname, matviewname)
    ) ON COMMIT PRESERVE ROWS",0,0,0,0,0,0,1,82.41471,82.41471,82.41471,82.41471,0,0,652,10,24,0,0,0,0,0,0,0,0,0,0,0,116,27,140060,0,0,0,0,0,0,0,0
10,16385,t,-485540537845669407,COPY  ( SELECT * FROM public.document_attachment_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,191.697817,191.697817,191.697817,191.697817,0,300,38,306,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5949357486154155233,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_annual ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,48.917844,48.917844,48.917844,48.917844,0,201,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4423377233317020540,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM committee_document_data WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.641956,1.641956,1.641956,1.641956,0,3,305,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,8563293836346705030,select documentat0_.hjid as hjid1_20_0_ from document_attachment_container documentat0_ where documentat0_.hjid=$1,0,0,0,0,0,0,1,89.64158,89.64158,89.64158,89.64158,0,1,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4016122779216772803,SELECT COUNT(*) FROM public.pg_stat_statements,0,0,0,0,0,0,1,31.24074,31.24074,31.24074,31.24074,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-2885330479908940062,select version(),0,0,0,0,0,0,2,0.007665000000000001,0.001884,0.0057810000000000005,0.0038325000000000004,0.0019485000000000004,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3883939240977404316,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_daily ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,248.914629,248.914629,248.914629,248.914629,0,500,2049,1036,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,238410598408167409,ANALYZE public.view_riksdagen_committee_ballot_decision_party_summary,0,0,0,0,0,0,1,586.151262,586.151262,586.151262,586.151262,0,0,6231,2082,24,9,0,0,0,0,0,0,0,0,0,0,167,2,89864,0,0,0,0,0,0,0,0
10,16385,f,7016553147023918732,COPY  ( SELECT * FROM public.sweden_political_party ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.625926,1.625926,1.625926,1.625926,0,40,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7164510840411247759,"WITH view_counts AS (
    SELECT schemaname,
           viewname,
           row_count
    FROM cia_view_row_counts
    WHERE viewname != $1
      AND viewname != $2
),
-- ============================================================================
-- TEMPORAL VIEW CLASSIFICATION
-- ============================================================================
-- Identify views by temporal granularity based on naming patterns
-- This enables stratified sampling across time periods
-- Uses reusable cia_classify_temporal_view() function
-- ============================================================================
view_temporal_classification AS (
    SELECT 
        vc.schemaname,
        vc.viewname,
        vc.row_count,
        c.temporal_granularity,
        c.samples_per_bucket
    FROM view_counts vc
    CROSS JOIN LATERAL cia_classify_temporal_view(vc.viewname) AS c
    WHERE vc.row_count > $3
),
-- ============================================================================
-- TEMPORAL COLUMN DETECTION
-- ============================================================================
-- Automatically detect temporal columns in each view
-- ============================================================================
view_temporal_columns AS (
    SELECT 
        c.table_schema AS schemaname,
        c.table_name AS viewname,
        c.column_name AS temporal_column,
        c.data_type,
        -- Prioritize common temporal column names
        CASE 
            WHEN c.column_name IN ($4, $5) THEN $6
            WHEN c.column_name IN ($7, $8, $9) THEN $10
            WHEN c.column_name IN ($11, $12, $13) THEN $14
            WHEN c.column_name LIKE $15 THEN $16
            ELSE $17
        END AS priority
    FROM information_schema.columns c
    WHERE c.table_schema = $18
      AND c.data_type IN ($19, $20, $21)
      AND c.column_name NOT IN ($22, $23) -- Exclude technical columns
),
view_primary_temporal_column AS (
    SELECT DISTINCT ON (schemaname, viewname)
        schemaname,
        viewname,
        temporal_column
    FROM view_temporal_columns
    ORDER BY schemaname, viewname, priority
),
-- ============================================================================
-- GENERATE STRATIFIED SAMPLING QUERIES
-- ============================================================================
view_extract AS (
    SELECT 
        vtc.schemaname,
        vtc.viewname,
        vtc.row_count,
        vtc.temporal_granularity,
        vtc.samples_per_bucket,
        vptc.temporal_column,
        -- Smart sample size calculation:
        -- 1. Complete extraction for small views (< threshold)
        -- 2. Extended samples for party/committee/person views
        -- 3. Extended samples for document/voting/worldbank views
        -- 4. Default sample size for others
        CASE 
            -- Complete extraction for small views
            WHEN vtc.row_count <= $24::int THEN vtc.row_count
            -- Extended samples for party-related views
            WHEN vtc.viewname ILIKE $25 OR vtc.viewname ILIKE $26 THEN 
                LEAST($27::int, vtc.row_count)
            -- Extended samples for committee-related views
            WHEN vtc.viewname ILIKE $28 OR vtc.viewname ILIKE $29 THEN 
                LEAST($30::int, vtc.row_count)
            -- Extended samples for person/politician views
            WHEN vtc.viewname ILIKE $31 OR vtc.viewname ILIKE $32 
                OR vtc.viewname ILIKE $33 THEN 
                LEAST($34::int, vtc.row_count)
            -- Extended samples for document-related views
            WHEN vtc.viewname ILIKE $35 OR vtc.viewname ILIKE $36 THEN 
                LEAST($37::int, vtc.row_count)
            -- Extended samples for voting-related views
            WHEN vtc.viewname ILIKE $38 OR vtc.viewname ILIKE $39 THEN 
                LEAST($40::int, vtc.row_count)
            -- Extended samples for worldbank data
            WHEN vtc.viewname ILIKE $41 OR vtc.viewname ILIKE $42 
                OR vtc.viewname ILIKE $43 THEN 
                LEAST($44::int, vtc.row_count)
            -- Default sample size
            ELSE LEAST($45::int, vtc.row_count)
        END AS sample_rows,
        -- Extraction type for logging
        CASE 
            WHEN vtc.row_count <= $46::int THEN $47
            WHEN vtc.viewname ILIKE $48 OR vtc.viewname ILIKE $49 THEN $50
            WHEN vtc.viewname ILIKE $51 OR vtc.viewname ILIKE $52 THEN $53
            WHEN vtc.viewname ILIKE $54 OR vtc.viewname ILIKE $55 
                OR vtc.viewname ILIKE $56 THEN $57
            WHEN vtc.viewname ILIKE $58 OR vtc.viewname ILIKE $59 THEN $60
            WHEN vtc.viewname ILIKE $61 OR vtc.viewname ILIKE $62 THEN $63
            WHEN vtc.viewname ILIKE $64 OR vtc.viewname ILIKE $65 
                OR vtc.viewname ILIKE $66 THEN $67
            ELSE $68
        END AS extraction_type,
        CASE WHEN vtc.viewname LIKE $69 THEN vtc.viewname ELSE $70 || vtc.viewname END AS file_prefix
    FROM view_temporal_classification vtc
    LEFT JOIN view_primary_temporal_column vptc 
        ON vtc.schemaname = vptc.schemaname 
        AND vtc.viewname = vptc.viewname
)
-- ============================================================================
-- GENERATE EXTRACTION COMMANDS WITH TEMPORAL STRATIFICATION
-- ============================================================================
SELECT 
    CASE 
        -- =====================================================================
        -- DAILY VIEWS: Stratified sampling by day
        -- =====================================================================
        WHEN temporal_granularity = $71 AND temporal_column IS NOT NULL THEN
            format(
                $72 || $73 ||
                $74 ||
                $75 ||
                $76 ||
                $77 ||
                $78 ||
                $79 ||
                $80 ||
                $81 ||
                $82 || $83 ||
                $84 || $85,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- WEEKLY VIEWS: Stratified sampling by week
        -- =====================================================================
        WHEN temporal_granularity = $86 AND temporal_column IS NOT NULL THEN
            format(
                $87 || $88 ||
                $89 ||
                $90 ||
                $91 ||
                $92 ||
                $93 ||
                $94 ||
                $95 ||
                $96 ||
                $97 || $98 ||
                $99 || $100,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- MONTHLY VIEWS: Stratified sampling by month
        -- =====================================================================
        WHEN temporal_granularity = $101 AND temporal_column IS NOT NULL THEN
            format(
                $102 || $103 ||
                $104 ||
                $105 ||
                $106 ||
                $107 ||
                $108 ||
                $109 ||
                $110 ||
                $111 ||
                $112 || $113 ||
                $114 || $115,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- ANNUAL VIEWS: Stratified sampling by year
        -- =====================================================================
        WHEN temporal_granularity = $116 AND temporal_column IS NOT NULL THEN
            format(
                $117 || $118 ||
                $119 ||
                $120 ||
                $121 ||
                $122 ||
                $123 ||
                $124 ||
                $125 ||
                $126 || $127 ||
                $128 || $129,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- TEMPORAL TREND VIEWS: Sample across all time periods
        -- =====================================================================
        WHEN temporal_granularity = $130 AND temporal_column IS NOT NULL THEN
            format(
                $131 || $132 ||
                $133 ||
                $134 ||
                $135 ||
                $136 ||
                $137 ||
                $138 ||
                $139 ||
                $140 ||
                $141 || $142 ||
                $143 || $144,
                viewname,
                temporal_column, temporal_column, schemaname, viewname,
                sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- NON-TEMPORAL VIEWS: Use random sampling with smart sample sizes
        -- =====================================================================
        ELSE
            format(
                $145 || $146 ||
                $147 || $148 ||
                $149 || $150,
                extraction_type,
                viewname,
                sample_rows,
                row_count,
                schemaname,
                viewname,
                sample_rows,
                file_prefix,
                file_prefix
            )
    END AS extraction_command
FROM view_extract
ORDER BY 
    CASE temporal_granularity
        WHEN $151 THEN $152
        WHEN $153 THEN $154
        WHEN $155 THEN $156
        WHEN $157 THEN $158
        WHEN $159 THEN $160
        ELSE $161
    END,
    viewname",0,0,0,0,0,0,1,1396.679928,1396.679928,1396.679928,1396.679928,0,81,4554,117,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1984321517201349341,"SELECT influence_classification, COUNT(*) 
FROM view_riksdagen_politician_influence_metrics 
GROUP BY influence_classification 
ORDER BY count DESC",0,0,0,0,0,0,2,66492.550945,33136.73873,33355.812215,33246.2754725,109.5367425000004,8,60915,145240,0,0,0,0,0,0,1535524,1538236,0,0,0,0,0,0,0,130,6.490178,0,0,2,2.7235560000000003,2,67.152531
10,16385,f,-4431046026996336314,SELECT COUNT(*) FROM public.view_application_action_event_page_hourly_summary,0,0,0,0,0,0,1,0.20467200000000002,0.20467200000000002,0.20467200000000002,0.20467200000000002,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5042771115056134026,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,17.262822,17.262822,17.262822,17.262822,0,4,2725,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3724125379468931867,COPY  ( SELECT * FROM public.view_riksdagen_party_document_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,19.856809,19.856809,19.856809,19.856809,0,500,0,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2761361339680794055,SELECT COUNT(*) FROM public.view_riksdagen_party_member,0,0,0,0,0,0,1,2.047504,2.047504,2.047504,2.047504,0,1,0,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,3749380189022910195,ROLLBACK,0,0,0,0,0,0,1,0.001853,0.001853,0.001853,0.001853,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7647301951479565237,SELECT COUNT(*) FROM public.view_riksdagen_committee_role_member,0,0,0,0,0,0,1,49.770046,49.770046,49.770046,49.770046,0,1,810,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-3419376815619156565,select documentde0_.hjid as hjid1_24_0_ from document_detail_container documentde0_ where documentde0_.hjid=$1,0,0,0,0,0,0,1,124.164243,124.164243,124.164243,124.164243,0,1,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1128968875247936686,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8]) AS col
WHERE EXISTS (SELECT $9 FROM information_schema.columns WHERE table_schema = $10 AND table_name = $11 AND column_name = col)",0,0,0,0,0,0,4,16.001535999999998,0.269002,14.575453,4.000384,6.10693030084784,16,1076,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4413869161178316406,select commit_id from jv_commit where $1<$2,0,0,0,0,0,0,1,0.003106,0.003106,0.003106,0.003106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8802433035748453179,"COPY  ( SELECT document_committee_proposal__0 AS value, COUNT ( * ) AS count FROM committee_proposal_component_0 WHERE document_committee_proposal__0 IS NOT NULL GROUP BY document_committee_proposal__0 ORDER BY count DESC, document_committee_proposal__0 LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,189.576644,189.576644,189.576644,189.576644,0,1000,0,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8144817099404001016,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_annual LIMIT $2),0,0,0,0,0,0,1,0.004008,0.004008,0.004008,0.004008,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4163036327226108106,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary_annual,0,0,0,0,0,0,1,49.680879,49.680879,49.680879,49.680879,0,0,5225,9,4,3,0,0,0,0,0,0,0,0,0,0,107,1,43466,0,0,0,0,0,0,0,0
16384,16385,t,6365692396663016237,select documentac0_.hjid as hjid1_17_0_ from document_activity_container documentac0_ where documentac0_.hjid=$1,0,0,0,0,0,0,1,45.912968,45.912968,45.912968,45.912968,0,1,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,183099703863422154,"SELECT org, COUNT(*) FROM document_data WHERE org LIKE $1 AND made_public_date >= CURRENT_DATE - INTERVAL $2 GROUP BY org ORDER BY COUNT(*) DESC",0,0,0,0,0,0,1,5.154337,5.154337,5.154337,5.154337,0,10,1969,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,77651703591085973,ANALYZE public.view_riksdagen_committee_ballot_decision_summary,0,0,0,0,0,0,1,55.887813,55.887813,55.887813,55.887813,0,0,4867,194,7,7,0,0,0,0,0,0,0,0,0,0,137,0,58822,0,0,0,0,0,0,0,0
10,16385,t,-4641253426442325352,"COPY  ( SELECT role_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE role_code IS NOT NULL GROUP BY role_code ORDER BY count DESC, role_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.120335,0.120335,0.120335,0.120335,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5530595455947026008,COPY  ( SELECT * FROM public.qrtz_triggers ORDER BY random ( ) LIMIT 4 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,24.175453,24.175453,24.175453,24.175453,0,4,364,145,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5991189070693713151,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'year' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 30 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.400618,0.400618,0.400618,0.400618,0,2,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5813578205475048036,COPY  ( SELECT * FROM public.view_riksdagen_party_ballot_support_annual_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,1559.943346,1559.943346,1559.943346,1559.943346,0,500,352454,3044,0,0,0,0,0,0,2112,2123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1149026059251716015,"SELECT COALESCE(c.reltuples, $10)::BIGINT                            FROM pg_class c
            JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE n.nspname = view_record.schemaname
              AND c.relname = view_record.object_name",0,0,0,0,0,0,28,414.698985,0.040295,350.11154999999997,14.810678035714284,65.56331427108239,28,1036,227,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,2064869707185898531,COMMIT,0,0,0,0,0,0,3,0.003396,0.000441,0.001913,0.001132,0.0006043018009791686,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3741356661484990041,"COPY  ( SELECT document_committee_proposal__0 AS value, COUNT ( * ) AS count FROM committee_proposal_component_0 WHERE document_committee_proposal__0 IS NOT NULL GROUP BY document_committee_proposal__0 ORDER BY count DESC, document_committee_proposal__0 LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,193.511704,193.511704,193.511704,193.511704,0,1000,44,79,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7832858577965349251,COPY  ( SELECT * FROM public.detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,6.1133869999999995,6.1133869999999995,6.1133869999999995,6.1133869999999995,0,200,0,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5646524526612452380,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_start ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_start ) ORDER BY random ( ) ) AS rn FROM public.view_ministry_effectiveness_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,62.59300399999999,62.59300399999999,62.59300399999999,62.59300399999999,0,11,22535,3957,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4643149224077084558,"COPY  ( SELECT election_code AS value, COUNT ( * ) AS count FROM sweden_election_type WHERE election_code IS NOT NULL GROUP BY election_code ORDER BY count DESC, election_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.006542,0.006542,0.006542,0.006542,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3382272513411956864,"SELECT schemaname, viewname AS object_name, $1 AS object_type
        FROM pg_views
        WHERE schemaname = $2
        UNION ALL
        SELECT schemaname, matviewname AS object_name, $3 AS object_type
        FROM pg_matviews
        WHERE schemaname = $4
        ORDER BY object_name",0,0,0,0,0,0,1,1.110275,1.110275,1.110275,1.110275,0,83,624,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,991592556007266272,"COPY  ( SELECT reference_type AS value, COUNT ( * ) AS count FROM document_reference_data WHERE reference_type IS NOT NULL GROUP BY reference_type ORDER BY count DESC, reference_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2245.12417,2245.12417,2245.12417,2245.12417,0,2,16,3266,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1226741241711699549,"COPY  ( SELECT process AS value, COUNT ( * ) AS count FROM document_activity_data WHERE process IS NOT NULL GROUP BY process ORDER BY count DESC, process LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,41.606798,41.606798,41.606798,41.606798,0,6,115,4893,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4161448351504743469,"DO $$
DECLARE
    table_count INTEGER;
    empty_count INTEGER := 0;
    non_empty_count INTEGER := 0;
    table_rec RECORD;
    row_count BIGINT;
BEGIN
    SELECT COUNT(*) INTO table_count 
    FROM pg_tables 
    WHERE schemaname = 'public';
    
    RAISE NOTICE 'Found % tables in public schema', table_count;
    RAISE NOTICE '';
    RAISE NOTICE 'Getting row counts from statistics (fast)...';
    RAISE NOTICE '';
    
    -- Count empty vs non-empty tables using pg_class statistics (fast)
    FOR table_rec IN 
        SELECT t.tablename,
               COALESCE(c.reltuples, 0)::BIGINT AS row_count
        FROM pg_tables t
        JOIN pg_class c ON c.relname = t.tablename
        JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
        WHERE t.schemaname = 'public'
        ORDER BY t.tablename
    LOOP
        IF table_rec.row_count > 0 THEN
            non_empty_count := non_empty_count + 1;
        ELSE
            empty_count := empty_count + 1;
        END IF;
    END LOOP;
    
    RAISE NOTICE '✓ Row count analysis complete';
    RAISE NOTICE '  Tables with data: %', non_empty_count;
    RAISE NOTICE '  Empty tables: %', empty_count;
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,2.557687,2.557687,2.557687,2.557687,0,0,1034,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7904999696634058772,"COPY  ( SELECT origin AS value, COUNT ( * ) AS count FROM document_element WHERE origin IS NOT NULL GROUP BY origin ORDER BY count DESC, origin LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,62.990568,62.990568,62.990568,62.990568,0,36,1200,34371,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5175985179183360965,"COPY  ( SELECT committee AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE committee IS NOT NULL GROUP BY committee ORDER BY count DESC, committee LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,18.411397,18.411397,18.411397,18.411397,0,71,2724,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6648837438572709230,"SELECT name, year, documents_produced FROM view_ministry_productivity_matrix ORDER BY year DESC, documents_produced DESC LIMIT $1",0,0,0,0,0,0,1,91.078518,91.078518,91.078518,91.078518,0,29,7144,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,2.873638,0,0,1,1.132715,1,28.169705
10,16385,f,6953922560316133934,ANALYZE public.view_riksdagen_document_type_daily_summary,0,0,0,0,0,0,1,47.125316,47.125316,47.125316,47.125316,0,0,632,222,1,1,0,0,0,0,0,0,0,0,0,0,9,0,4851,0,0,0,0,0,0,0,0
10,16385,t,-8472757511439754250,"SELECT $1 || $2 ||
       $3 || $4
WHERE EXISTS (SELECT $5 FROM information_schema.columns WHERE table_schema = $6 AND table_name = $7 AND column_name = $8)",0,0,0,0,0,0,1,0.060584,0.060584,0.060584,0.060584,0,1,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5312542210899176867,COPY  ( SELECT * FROM public.document_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,346.43303,346.43303,346.43303,346.43303,0,300,0,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1902870634554830662,COPY  ( SELECT * FROM public.sweden_political_party ORDER BY random ( ) LIMIT 40 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.842992,1.842992,1.842992,1.842992,0,40,36,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3692657799899278746,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM vote_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,336.125454,336.125454,336.125454,336.125454,0,9,10026,77268,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.860385,0,0,1,0.410596,1,6.236267
10,16385,t,-8650412745489689526,"SELECT partrelid FROM pg_partitioned_table WHERE
(SELECT c.oid FROM pg_opclass c JOIN pg_am a ON c.opcmethod = a.oid
WHERE opcname = $1 AND opcnamespace = $2::regnamespace AND amname = $3) = ANY(partclass)",0,0,0,0,0,0,1,0.003978,0.003978,0.003978,0.003978,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2168659935316841993,"COPY  ( SELECT committee_report AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE committee_report IS NOT NULL GROUP BY committee_report ORDER BY count DESC, committee_report LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,14.693723,14.693723,14.693723,14.693723,0,778,2839,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5548817353774115488,SELECT * FROM pg_catalog.pg_rewrite WHERE ev_class = $1 AND rulename = $2,0,0,0,0,0,0,86,0.558478,0.004549,0.018485,0.006493930232558138,0.0028355296859288327,86,172,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6457694864673531750,"COPY  ( SELECT document_name AS value, COUNT ( * ) AS count FROM document_element WHERE document_name IS NOT NULL GROUP BY document_name ORDER BY count DESC, document_name LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,66.094336,66.094336,66.094336,66.094336,0,95,908,34660,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6605880769510741236,SELECT pg_catalog.current_schemas($1),0,0,0,0,0,0,2,0.008596,0.0037270000000000003,0.004869,0.004298,0.0005709999999999997,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,f,8002530467409987423,"select $1[s],
        s operator(pg_catalog.-) pg_catalog.array_lower($1,$2) operator(pg_catalog.+) $3
        from pg_catalog.generate_series(pg_catalog.array_lower($1,$4),
                                        pg_catalog.array_upper($1,$5),
                                        $6) as g(s)",0,0,0,0,0,0,3,0.025326,0.002394,0.019837,0.008442,0.008062562413195118,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4166589360465058498,"SELECT set_config(name, $1, $2) FROM pg_settings WHERE name = $3",0,0,0,0,0,0,2,1.453795,0.717439,0.736356,0.7268975,0.009458500000000009,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1693720041558248909,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.857979,58.857979,58.857979,58.857979,0,500,132,35439,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-9013909438124481434,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAAaTE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAAkgAAAAAAAAAA',0,0,0,0,0,0,1,0.000751,0.000751,0.000751,0.000751,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6965465689985754863,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC, intressent_id LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,8.410509,8.410509,8.410509,8.410509,0,2000,483,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-2661236621137201057,"SELECT     tmp.TABLE_CAT AS ""TABLE_CAT"",     tmp.TABLE_SCHEM AS ""TABLE_SCHEM"",     tmp.TABLE_NAME AS ""TABLE_NAME"",     tmp.NON_UNIQUE AS ""NON_UNIQUE"",     tmp.INDEX_QUALIFIER AS ""INDEX_QUALIFIER"",     tmp.INDEX_NAME AS ""INDEX_NAME"",     tmp.TYPE AS ""TYPE"",     tmp.ORDINAL_POSITION AS ""ORDINAL_POSITION"",     trim(both $2 from pg_catalog.pg_get_indexdef(tmp.CI_OID, tmp.ORDINAL_POSITION, $3)) AS ""COLUMN_NAME"",   CASE tmp.AM_NAME     WHEN $4 THEN CASE tmp.I_INDOPTION[tmp.ORDINAL_POSITION - $5] & $6::smallint       WHEN $7 THEN $8       ELSE $9     END     ELSE $10   END AS ""ASC_OR_DESC"",     tmp.CARDINALITY AS ""CARDINALITY"",     tmp.PAGES AS ""PAGES"",     tmp.FILTER_CONDITION AS ""FILTER_CONDITION"",     tmp.REMARKS AS ""REMARKS""FROM (SELECT current_database() AS TABLE_CAT,  n.nspname AS TABLE_SCHEM,   ct.relname AS TABLE_NAME, NOT i.indisunique AS NON_UNIQUE,   $11 AS INDEX_QUALIFIER, ci.relname AS INDEX_NAME,   CASE i.indisclustered     WHEN $12 THEN $13    ELSE CASE am.amname       WHEN $14 THEN $15      ELSE $16    END   END AS TYPE,   (information_schema._pg_expandarray(i.indkey)).n AS ORDINAL_POSITION,   ci.reltuples AS CARDINALITY,   ci.relpages AS PAGES,   pg_catalog.pg_get_expr(i.indpred, i.indrelid) AS FILTER_CONDITION,   ci.oid AS CI_OID,   i.indoption AS I_INDOPTION,   am.amname AS AM_NAME,   d.description AS REMARKS FROM pg_catalog.pg_class ct   JOIN pg_catalog.pg_namespace n ON (ct.relnamespace = n.oid)   JOIN pg_catalog.pg_index i ON (ct.oid = i.indrelid)   JOIN pg_catalog.pg_class ci ON (ci.oid = i.indexrelid)   JOIN pg_catalog.pg_am am ON (ci.relam = am.oid)   LEFT JOIN pg_catalog.pg_description d ON (ci.oid = d.objoid) WHERE $17  AND ct.relname = $1) AS tmp ORDER BY ""NON_UNIQUE"", ""TYPE"", ""INDEX_NAME"", ""ORDINAL_POSITION""",0,0,0,0,0,0,1,0.709786,0.709786,0.709786,0.709786,0,3,99,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4334596417196204482,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'week' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '6 months' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 30 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.661656,0.661656,0.661656,0.661656,0,8,33,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6805115502638588463,"SELECT tableoid, oid, fdwname, fdwowner, fdwhandler::pg_catalog.regproc, fdwvalidator::pg_catalog.regproc, fdwacl, acldefault($1, fdwowner) AS acldefault, array_to_string(ARRAY(SELECT quote_ident(option_name) || $2 || quote_literal(option_value) FROM pg_options_to_table(fdwoptions) ORDER BY option_name), $3) AS fdwoptions FROM pg_foreign_data_wrapper",0,0,0,0,0,0,2,0.008296,0.0032559999999999998,0.00504,0.004148,0.0008920000000000001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5723770083736140524,COPY  ( SELECT * FROM public.qrtz_locks ORDER BY random ( ) LIMIT 2 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.598784,2.598784,2.598784,2.598784,0,2,37,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5339038528433148895,"SELECT c.oid,
  n.nspname,
  c.relname
FROM pg_catalog.pg_class c
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
WHERE c.relname OPERATOR(pg_catalog.~) $1 COLLATE pg_catalog.default
  AND pg_catalog.pg_table_is_visible(c.oid)
ORDER BY 2, 3",0,0,0,0,0,0,2,0.219271,0.10637999999999999,0.112891,0.1096355,0.0032555000000000084,2,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9156918176354226544,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_politician_document_daily_summary LIMIT $2),0,0,0,0,0,0,1,0.010079,0.010079,0.010079,0.010079,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2898426421997579755,COPY  ( SELECT * FROM public.document_reference_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,53.198971,53.198971,53.198971,53.198971,0,300,35,3273,0,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-5691800661073200221,"SELECT * FROM (SELECT current_database() AS current_database, n.nspname,c.relname,a.attname,a.atttypid,a.attnotnull  OR (t.typtype = $4 AND t.typnotnull) AS attnotnull,a.atttypmod,a.attlen,t.typtypmod,row_number() OVER (PARTITION BY a.attrelid ORDER BY a.attnum) AS attnum, nullif(a.attidentity, $5) as attidentity,nullif(a.attgenerated, $6) as attgenerated,pg_catalog.pg_get_expr(def.adbin, def.adrelid) AS adsrc,dsc.description,t.typbasetype,t.typtype  FROM pg_catalog.pg_namespace n  JOIN pg_catalog.pg_class c ON (c.relnamespace = n.oid)  JOIN pg_catalog.pg_attribute a ON (a.attrelid=c.oid)  JOIN pg_catalog.pg_type t ON (a.atttypid = t.oid)  LEFT JOIN pg_catalog.pg_attrdef def ON (a.attrelid=def.adrelid AND a.attnum = def.adnum)  LEFT JOIN pg_catalog.pg_description dsc ON (c.oid=dsc.objoid AND a.attnum = dsc.objsubid)  LEFT JOIN pg_catalog.pg_class dc ON (dc.oid=dsc.classoid AND dc.relname=$7)  LEFT JOIN pg_catalog.pg_namespace dn ON (dc.relnamespace=dn.oid AND dn.nspname=$8)  WHERE c.relkind in ($9,$10,$11,$12,$13) and a.attnum > $14 AND NOT a.attisdropped  AND n.nspname LIKE $1 AND c.relname LIKE $2) c WHERE $15  AND attname LIKE $3 ORDER BY nspname,c.relname,attnum",0,0,0,0,0,0,1,0.5595249999999999,0.5595249999999999,0.5595249999999999,0.5595249999999999,0,14,76,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8271557925611134191,"COPY public.databasechangeloglock (id, locked, lockgranted, lockedby) TO stdout",0,0,0,0,0,0,1,0.019877,0.019877,0.019877,0.019877,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6310021986213910992,COPY  ( SELECT * FROM public.document_person_reference_da_0 ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,72.015902,72.015902,72.015902,72.015902,0,500,41,3581,0,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1327778340389237711,"COPY  ( SELECT short_code AS value, COUNT ( * ) AS count FROM sweden_political_party WHERE short_code IS NOT NULL GROUP BY short_code ORDER BY count DESC, short_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3.471874,3.471874,3.471874,3.471874,0,30,37,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6751792141731574124,"COPY  ( SELECT role_description AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE role_description IS NOT NULL GROUP BY role_description ORDER BY count DESC, role_description LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,33.114057,33.114057,33.114057,33.114057,0,1,3589,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6053803253576743000,SELECT COUNT(*) FROM public.view_riksdagen_goverment_role_member,0,0,0,0,0,0,1,6.9666820000000005,6.9666820000000005,6.9666820000000005,6.9666820000000005,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1786104445266805939,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_element WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.82162,0.82162,0.82162,0.82162,0,0,38,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8420076355728971635,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.016631,0.016631,0.016631,0.016631,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2725647267385764752,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , decision_day ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , decision_day ) ORDER BY random ( ) ) AS rn FROM public.view_decision_temporal_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,237.824086,237.824086,237.824086,237.824086,0,40,295597,8339,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6052507119043505398,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,268.39578600000004,268.39578600000004,268.39578600000004,268.39578600000004,0,1,9930,77364,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.575174,0,0,1,0.276496,1,4.595451
10,16385,f,9181461464876526800,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_daily ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,39.85122,39.85122,39.85122,39.85122,0,1314,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6523034632883090646,"COPY  ( SELECT vote AS value, COUNT ( * ) AS count FROM vote_data WHERE vote IS NOT NULL GROUP BY vote ORDER BY count DESC, vote LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,360.930464,360.930464,360.930464,360.930464,0,4,9933,77467,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6710730610544008613,COPY  ( SELECT * FROM public.application_configuration ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.075561,0.075561,0.075561,0.075561,0,14,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6772936797418699743,COPY  ( SELECT * FROM public.vote_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1936.83465,1936.83465,1936.83465,1936.83465,0,300,51,87284,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,116162960022248646,COPY  ( SELECT * FROM public.committee_document_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,5.577376999999999,5.577376999999999,5.577376999999999,5.577376999999999,0,500,0,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8263829154062938930,COPY  ( SELECT * FROM public.databasechangelog ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,4.9021159999999995,4.9021159999999995,4.9021159999999995,4.9021159999999995,0,412,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3328527175952726589,"SELECT tableoid, oid, pnpubid, pnnspid FROM pg_catalog.pg_publication_namespace",0,0,0,0,0,0,2,0.005831,0.002465,0.003366,0.0029155,0.00045049999999999995,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4571491496811280543,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document_daily_summary,0,0,0,0,0,0,1,152.484207,152.484207,152.484207,152.484207,0,58602,4950,4032,429,449,0,0,0,0,42,111,0,0,0,0,58768,2,5084715,0,0,0,0,0,0,0,0
10,16385,t,4591699421909560982,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8, $9]) AS col
WHERE EXISTS (SELECT $10 FROM information_schema.columns WHERE table_schema = $11 AND table_name = $12 AND column_name = col)",0,0,0,0,0,0,1,1.031717,1.031717,1.031717,1.031717,0,5,311,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8078581720152151731,SET statement_timeout = 0,0,0,0,0,0,0,2,0.002885,0.001322,0.001563,0.0014425,0.00012049999999999995,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7919020755192368782,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,27.788571,27.788571,27.788571,27.788571,0,134,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4158864888232333058,"SELECT schemaname, viewname AS object_name, $1 AS object_type
        FROM pg_views
        WHERE schemaname = $2
          AND viewname != $3
          AND viewname != $4
        UNION ALL
        SELECT schemaname, matviewname AS object_name, $5 AS object_type
        FROM pg_matviews
        WHERE schemaname = $6
        ORDER BY object_name",0,0,0,0,0,0,1,1.223843,1.223843,1.223843,1.223843,0,82,624,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6704517995274951406,"INSERT INTO tmp_mv_refresh_state (schemaname, matviewname)
                VALUES (mv_record.schemaname, mv_record.matviewname)
                ON CONFLICT (schemaname, matviewname) DO NOTHING",0,0,0,0,0,0,28,0.6021179999999999,0.014667,0.07972800000000001,0.021504214285714283,0.011451403692364977,28,0,0,0,0,113,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-268361508753285243,SELECT COUNT(*) FROM public.view_riksdagen_party_decision_flow,0,0,0,0,0,0,1,481.61047,481.61047,481.61047,481.61047,0,1,480925,8608,0,0,0,0,0,0,1306,1309,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4965285508923853148,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , period_start ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_start ) ORDER BY random ( ) ) AS rn FROM public.view_party_effectiveness_trends ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 107 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,116.851325,116.851325,116.851325,116.851325,0,12,38,5369,0,0,0,0,0,0,384,385,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2101777998806283570,"COPY  ( SELECT role_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE role_code IS NOT NULL GROUP BY role_code ORDER BY count DESC, role_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,6.241878,6.241878,6.241878,6.241878,0,75,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3822409440667416686,"DO $$
DECLARE
    view_record RECORD;
    view_count INTEGER := 0;
    total_views INTEGER;
    row_count BIGINT;
    extract_count INTEGER := 0;
BEGIN
    -- Get total view count (excluding coalition alignment matrix)
    SELECT COUNT(*) INTO total_views
    FROM (
        SELECT viewname FROM pg_views 
        WHERE schemaname = 'public' 
          AND viewname != 'view_riksdagen_intelligence_dashboard'
        UNION ALL
        SELECT matviewname FROM pg_matviews 
        WHERE schemaname = 'public'
    ) v;
    
    RAISE NOTICE '';
    RAISE NOTICE 'Phase 1: Analyzing % views for row counts', total_views;
    RAISE NOTICE 'Excluding: view_riksdagen_coalition_alignment_matrix (complex query)';
    RAISE NOTICE 'This may take several minutes for complex views...';
    RAISE NOTICE '';
    
    -- Process each view with progress BEFORE the slow operation
    FOR view_record IN 
        SELECT schemaname, viewname AS object_name, 'VIEW' AS object_type
        FROM pg_views
        WHERE schemaname = 'public'
          AND viewname != 'view_riksdagen_coalition_alignment_matrix'
          AND viewname != 'view_riksdagen_intelligence_dashboard'
        UNION ALL
        SELECT schemaname, matviewname AS object_name, 'MATERIALIZED VIEW' AS object_type
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY object_name
    LOOP
        view_count := view_count + 1;
        
        -- Always show what we're about to analyze
        RAISE NOTICE '→ [%/%] Analyzing: %.% (%)', 
            view_count, total_views, 
            view_record.schemaname, view_record.object_name,
            view_record.object_type;
        
        -- Use fast pg_class statistics for materialized views, slow COUNT for regular views
        IF view_record.object_type = 'MATERIALIZED VIEW' THEN
            -- Fast: use cached statistics from pg_class
            SELECT COALESCE(c.reltuples, 0)::BIGINT INTO row_count
            FROM pg_class c
            JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE n.nspname = view_record.schemaname
              AND c.relname = view_record.object_name;
        ELSE
            -- Regular views need actual COUNT (no cached stats)
            row_count := cia_tmp_rowcount(view_record.schemaname, view_record.object_name);
        END IF;
        
        -- Cache result in temp table for Phase 2 reuse
        INSERT INTO cia_view_row_counts(schemaname, viewname, view_type, row_count)
        VALUES (view_record.schemaname, view_record.object_name, view_record.object_type, row_count);
        
        -- Show result immediately after
        IF row_count > 0 THEN
            RAISE NOTICE '  ✓ Contains % rows', row_count;
            extract_count := extract_count + 1;
        ELSE
            RAISE NOTICE '  ⚠️  EMPTY (0 rows)';
        END IF;
        RAISE NOTICE '';
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE '✓ Phase 1 complete: % of % views have data', extract_count, total_views;
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,58543.670614,58543.670614,58543.670614,58543.670614,0,0,2703732,566710,2,51,81,0,1,1,831807,833278,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5162731064447567160,"SELECT inhrelid, inhparent FROM pg_inherits",0,0,0,0,0,0,2,0.006011000000000001,0.002474,0.003537,0.0030055000000000004,0.0005315000000000002,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1942429503787674555,"COPY  ( SELECT group_behavior AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE group_behavior IS NOT NULL GROUP BY group_behavior ORDER BY count DESC, group_behavior LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.156212,0.156212,0.156212,0.156212,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-5279049425383817117,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABmzE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABoQAAAAAAAAAA',0,0,0,0,0,0,1,0.001072,0.001072,0.001072,0.001072,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4516983912856200532,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $1 ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.206686,0.206686,0.206686,0.206686,0,7,0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7637178241441791302,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'week' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '6 months' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 38 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.489644,0.489644,0.489644,0.489644,0,8,26,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4023799147964286847,SELECT * FROM QRTZ_TRIGGERS WHERE SCHED_NAME = $3 AND TRIGGER_NAME = $1 AND TRIGGER_GROUP = $2,0,0,0,0,0,0,4,220.19939399999998,0.031118000000000003,219.97829099999998,55.049848499999996,95.22148492261277,4,81,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,7849595186823767948,SELECT * FROM QRTZ_LOCKS WHERE SCHED_NAME = $2 AND LOCK_NAME = $1 FOR UPDATE,0,0,0,0,0,0,2,0.18879100000000001,0.017602,0.171189,0.09439550000000001,0.07679350000000001,2,3,1,1,0,0,0,0,0,0,0,0,0,0,0,2,1,257,0,0,0,0,0,0,0,0
10,16385,t,3327659459476748208,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.155518,1.155518,1.155518,1.155518,0,246,339,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-544059531170623709,"SELECT tableoid, oid, opcmethod, opcname, opcnamespace, opcowner FROM pg_opclass",0,0,0,0,0,0,2,0.22522,0.099576,0.125644,0.11261,0.013034000000000004,402,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7156161200574675635,"SELECT p.tableoid, p.oid, p.pubname, p.pubowner, p.puballtables, p.pubinsert, p.pubupdate, p.pubdelete, p.pubtruncate, p.pubviaroot FROM pg_publication p",0,0,0,0,0,0,2,0.007844,0.003666,0.004177999999999999,0.003922,0.00025599999999999993,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8956632759701949625,SELECT COUNT(*) FROM public.view_party_effectiveness_trends,0,0,0,0,0,0,1,144.691819,144.691819,144.691819,144.691819,0,1,0,2605,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,3186939552201226789,"SELECT pid, now() - query_start as duration, state, substring(query, $1, $2) as query_preview FROM pg_stat_activity WHERE state = $3 AND query NOT LIKE $4",0,0,0,0,0,0,1,0.075591,0.075591,0.075591,0.075591,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7841255497901063543,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_politician_behavioral_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,158.363498,158.363498,158.363498,158.363498,0,26,2607,0,0,0,0,0,0,0,523,524,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6604928647459510711,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'year' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 23 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.373898,0.373898,0.373898,0.373898,0,2,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4985003922336875038,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_weekly LIMIT $2),0,0,0,0,0,0,1,0.00494,0.00494,0.00494,0.00494,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,364276013894694727,"EXISTS (
                    SELECT $18
                    FROM tmp_mv_refresh_state s
                    WHERE s.schemaname  = mv_record.schemaname
                      AND s.matviewname = mv_record.matviewname
                )",0,0,0,0,0,0,56,0.39197600000000005,0.0035870000000000003,0.013936,0.00699957142857143,0.0024147450091435473,56,0,0,0,0,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2551493251662255768,COPY  ( SELECT * FROM public.view_riksdagen_party_coalation_against_annual_summary ORDER BY random ( ) LIMIT 278 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,16.176272,16.176272,16.176272,16.176272,0,278,5,2832,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4555345073828568947,"SELECT conrelid, confrelid FROM pg_constraint JOIN pg_depend ON (objid = confrelid) WHERE contype = $1 AND refclassid = $2::regclass AND classid = $3::regclass",0,0,0,0,0,0,2,0.247772,0.090168,0.157604,0.123886,0.033718,0,40,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5569951581642395731,ANALYZE public.view_riksdagen_vote_data_ballot_summary,0,0,0,0,0,0,1,60.015732,60.015732,60.015732,60.015732,0,0,3103,256,2,2,0,0,0,0,0,0,0,0,0,0,70,0,30810,0,0,0,0,0,0,0,0
10,16385,t,-3994550672971254737,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_weekly ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,627.986146,627.986146,627.986146,627.986146,0,500,2868,9792,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-491545499724467678,COPY  ( SELECT * FROM public.document_content_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,25642.61353,25642.61353,25642.61353,25642.61353,0,300,521,9149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4398046695124741149,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_daily ORDER BY random ( ) LIMIT 1314 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,45.043557,45.043557,45.043557,45.043557,0,1314,1222,462,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5032403635021082081,COPY  ( SELECT * FROM public.committee_proposal_container ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,4.65057,4.65057,4.65057,4.65057,0,500,41,51,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-270315718986435177,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABLjE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABNAAAAAAAAAAA',0,0,0,0,0,0,1,0.000812,0.000812,0.000812,0.000812,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3545412574037053608,SET DATESTYLE = ISO,0,0,0,0,0,0,2,0.006593,0.003106,0.003487,0.0032965,0.00019050000000000013,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8144260084564419575,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '30 days' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 65 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,10.776578,10.776578,10.776578,10.776578,0,7,43,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7670248116783111509,COPY  ( SELECT * FROM public.application_action_event ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,189.30989100000002,189.30989100000002,189.30989100000002,189.30989100000002,0,241,0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3583576816901266084,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,26.772303,26.772303,26.772303,26.772303,0,76,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3949846545163515584,COPY  ( SELECT * FROM public.topic ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,139.231514,139.231514,139.231514,139.231514,0,200,42,43,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,1720425951927656028,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABmzE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABoQAAAAAAAAAA',0,0,0,0,0,0,1,54.91344,54.91344,54.91344,54.91344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,t,4006691450472246754,"COPY public.databasechangelog (id, author, filename, dateexecuted, orderexecuted, exectype, md5sum, description, comments, tag, liquibase, contexts, labels, deployment_id) TO stdout",0,0,0,0,0,0,1,0.571397,0.571397,0.571397,0.571397,0,454,26,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,6682551122592029174,SELECT MAX(snapshot_pk) FROM jv_snapshot WHERE $2 = $3 AND global_id_fk = $1,0,0,0,0,0,0,10,348.495139,0.013946,200.213225,34.8495139,58.846890462652794,10,31,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1391139709313032959,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM vote_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,365.48463,365.48463,365.48463,365.48463,0,24,115,87182,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8881653396863016651,SELECT COUNT(*) FROM public.view_riksdagen_goverment_roles,0,0,0,0,0,0,1,6.188377999999999,6.188377999999999,6.188377999999999,6.188377999999999,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4168913469337275986,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_annual,0,0,0,0,0,0,1,177.135816,177.135816,177.135816,177.135816,0,201,5336,1574,10,10,0,0,0,0,0,0,0,0,0,0,469,5,97727,0,0,0,0,0,0,0,0
10,16385,t,6563987831003041216,"SELECT description, classoid, objoid, objsubid FROM pg_catalog.pg_description ORDER BY classoid, objoid, objsubid",0,0,0,0,0,0,2,11.516255999999998,5.057075,6.459180999999999,5.758127999999999,0.7010529999999993,11574,56,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7625913858271410784,"SELECT COUNT(*) AS co_voting_pair_count
FROM (
    SELECT
        v1.embedded_id_intressent_id AS person_1,
        v2.embedded_id_intressent_id AS person_2,
        COUNT(*) AS co_votes
    FROM vote_data v1
    JOIN vote_data v2 
        ON v1.embedded_id_ballot_id = v2.embedded_id_ballot_id
        AND v1.embedded_id_intressent_id < v2.embedded_id_intressent_id
    WHERE v1.vote_date >= CURRENT_DATE - INTERVAL $1
        AND UPPER(v1.vote) IN ($2, $3)
        AND UPPER(v2.vote) IN ($4, $5)
    GROUP BY v1.embedded_id_intressent_id, v2.embedded_id_intressent_id
    HAVING COUNT(*) >= $6
    LIMIT $7
) subq",0,0,0,0,0,0,1,32740.354357,32740.354357,32740.354357,32740.354357,0,1,30305,72431,0,0,0,0,0,0,459536,661567,0,0,0,0,0,0,0,32,1.488722,0,0,1,0.698946,1,15.57476
10,16385,f,721175890655923682,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_element WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005019,0.005019,0.005019,0.005019,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3259716384882786695,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_monthly ORDER BY random ( ) LIMIT 1804 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,33.886145,33.886145,33.886145,33.886145,0,1804,1950,456,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7438966839548707488,COPY  ( SELECT * FROM public.against_proposal_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,17.10673,17.10673,17.10673,17.10673,0,300,37,685,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8604805403349926202,SELECT COUNT(*) FROM public.view_committee_productivity_matrix,0,0,0,0,0,0,1,438.15504,438.15504,438.15504,438.15504,0,1,3199,6453,0,0,0,0,0,0,1394,1399,0,0,0,0,0,0,0,56,3.097988,0,0,1,1.136192,1,28.204959
10,16385,f,2406100787149257738,"INSERT INTO cia_view_row_counts(schemaname, viewname, view_type, row_count)
        VALUES (view_record.schemaname, view_record.object_name, view_record.object_type, row_count)",0,0,0,0,0,0,82,0.5815510000000003,0.002513,0.068417,0.007092085365853656,0.007797003962125168,82,0,0,0,0,81,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4821175136792161012,"SELECT pol.oid, pol.tableoid, pol.polrelid, pol.polname, pol.polcmd, pol.polpermissive, CASE WHEN pol.polroles = $1 THEN $2 ELSE    pg_catalog.array_to_string(ARRAY(SELECT pg_catalog.quote_ident(rolname) from pg_catalog.pg_roles WHERE oid = ANY(pol.polroles)), $3) END AS polroles, pg_catalog.pg_get_expr(pol.polqual, pol.polrelid) AS polqual, pg_catalog.pg_get_expr(pol.polwithcheck, pol.polrelid) AS polwithcheck FROM unnest($4::pg_catalog.oid[]) AS src(tbloid)
JOIN pg_catalog.pg_policy pol ON (src.tbloid = pol.polrelid)",0,0,0,0,0,0,2,0.013695,0.006351,0.007344000000000001,0.0068475,0.0004965000000000004,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2952731628582728995,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_politician_document LIMIT $2),0,0,0,0,0,0,1,0.007886,0.007886,0.007886,0.007886,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5145220225105620010,"SELECT tableoid, oid, rulename, ev_class AS ruletable, ev_type, is_instead, ev_enabled FROM pg_rewrite ORDER BY oid",0,0,0,0,0,0,2,0.40375400000000006,0.16342500000000001,0.24032900000000001,0.20187700000000003,0.03845200000000001,452,24,14,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3902833771723446276,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary_weekly,0,0,0,0,0,0,1,82.785128,82.785128,82.785128,82.785128,0,0,5085,149,6,6,0,0,0,0,0,0,0,0,0,0,96,0,50804,0,0,0,0,0,0,0,0
10,16385,f,8525685650799091150,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary,0,0,0,0,0,0,1,4438.945952,4438.945952,4438.945952,4438.945952,0,83498,23111,88438,2879,3718,0,0,0,0,92382,92500,0,0,0,0,84269,473,28325152,0,0,0,0,0,0,0,0
10,16385,t,-8521507165795639581,"COPY  ( SELECT winner AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE winner IS NOT NULL GROUP BY winner ORDER BY count DESC, winner LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,17.285133,17.285133,17.285133,17.285133,0,44,2836,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1708773042987540739,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '30 days' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 79 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.456663,0.456663,0.456663,0.456663,0,7,28,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5501890840136370666,"SELECT tableoid, oid, conname, connamespace, conowner FROM pg_conversion",0,0,0,0,0,0,2,1.2746110000000002,0.050845,1.2237660000000001,0.6373055000000001,0.5864605,256,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1213370246401210228,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_org_document_daily_summary LIMIT $2),0,0,0,0,0,0,1,0.009497,0.009497,0.009497,0.009497,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5250530394949636798,SELECT COUNT(*) FROM public.view_riksdagen_voting_anomaly_detection,0,0,0,0,0,0,1,1391.679881,1391.679881,1391.679881,1391.679881,0,1,4334,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,3.906035,0,0,1,1.737715,1,35.145391
10,16385,t,-5817953272358163981,"COPY  ( SELECT election_code AS value, COUNT ( * ) AS count FROM sweden_election_type WHERE election_code IS NOT NULL GROUP BY election_code ORDER BY count DESC, election_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.5785,0.5785,0.5785,0.5785,0,0,36,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5084904434797973579,COPY  ( SELECT * FROM public.qrtz_cron_triggers ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,6.349457999999999,6.349457999999999,6.349457999999999,6.349457999999999,0,4,0,38,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-857128017002313219,SELECT COUNT(*) FROM public.view_application_action_event_page_daily_summary,0,0,0,0,0,0,1,0.168655,0.168655,0.168655,0.168655,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8808865973996712793,"SELECT DISTINCT assignment_type, org_code, detail FROM assignment_data WHERE assignment_type LIKE $1 OR assignment_type LIKE $2 OR assignment_type = $3 ORDER BY assignment_type, detail LIMIT $4",0,0,0,0,0,0,1,46.188024,46.188024,46.188024,46.188024,0,21,1498,353,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,627985056819811788,"INSERT INTO QRTZ_SCHEDULER_STATE (SCHED_NAME, INSTANCE_NAME, LAST_CHECKIN_TIME, CHECKIN_INTERVAL) VALUES($4, $1, $2, $3)",0,0,0,0,0,0,1,63.959298,63.959298,63.959298,63.959298,0,1,3,3,2,0,0,0,0,0,0,0,0,0,0,0,2,2,5751,0,0,0,0,0,0,0,0
16384,16385,t,-4137009018290810090,"select languageda0_.hjid as hjid1_39_, languageda0_.auto_translation_enabled as auto_tra2_39_, languageda0_.created_date as created_3_39_, languageda0_.language_code as language4_39_, languageda0_.language_enabled as language5_39_, languageda0_.language_name as language6_39_, languageda0_.last_modified_date as last_mod7_39_, languageda0_.model_object_id as model_ob8_39_, languageda0_.model_object_version as model_ob9_39_, languageda0_.translation_status as transla10_39_ from language_data languageda0_",0,0,0,0,0,0,1,0.729864,0.729864,0.729864,0.729864,0,135,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5081349731140873853,"SELECT COUNT(*)                       FROM pg_tables 
    WHERE schemaname = $1",0,0,0,0,0,0,1,0.5360820000000001,0.5360820000000001,0.5360820000000001,0.5360820000000001,0,1,312,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-345860135785742461,COPY  ( SELECT * FROM public.user_account ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,9.660313,9.660313,9.660313,9.660313,0,1,76,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,74559815457862905,COPY  ( SELECT * FROM public.databasechangeloglock ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,4.469184,4.469184,4.469184,4.469184,0,1,45,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6565045654103355799,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_decision_type_summary LIMIT $2),0,0,0,0,0,0,1,0.00506,0.00506,0.00506,0.00506,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5352061430512400216,COPY  ( SELECT * FROM public.document_activity_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,100.932593,100.932593,100.932593,100.932593,0,300,0,4984,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4425397151049427388,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.00625,1.00625,1.00625,1.00625,0,246,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-8249778545800538119,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABRjE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABTAAAAAAAAAAA',0,0,0,0,0,0,1,0.000852,0.000852,0.000852,0.000852,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4210799227233819426,"COPY  ( SELECT proffessional_behavior AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE proffessional_behavior IS NOT NULL GROUP BY proffessional_behavior ORDER BY count DESC, proffessional_behavior LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.114273,0.114273,0.114273,0.114273,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4957664379216357048,COPY  ( SELECT * FROM public.person_assignment_data ORDER BY random ( ) LIMIT 2487 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.892913,3.892913,3.892913,3.892913,0,2487,35,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9114898791963368234,"COPY  ( SELECT file_type AS value, COUNT ( * ) AS count FROM document_attachment WHERE file_type IS NOT NULL GROUP BY file_type ORDER BY count DESC, file_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,86.231719,86.231719,86.231719,86.231719,0,4,16,3432,0,61,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,244281986785108433,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC, document_document_status_con_0 LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.287741000000004,55.287741000000004,55.287741000000004,55.287741000000004,0,1000,0,1079,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4624877833479422471,COPY  ( SELECT * FROM public.application_session ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,93.913663,93.913663,93.913663,93.913663,0,18,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,461811384911040494,"SELECT t.tableoid, t.oid, i.indrelid, t.relname AS indexname, pg_catalog.pg_get_indexdef(i.indexrelid) AS indexdef, i.indkey, i.indisclustered, c.contype, c.conname, c.condeferrable, c.condeferred, c.tableoid AS contableoid, c.oid AS conoid, pg_catalog.pg_get_constraintdef(c.oid, $1) AS condef, (SELECT spcname FROM pg_catalog.pg_tablespace s WHERE s.oid = t.reltablespace) AS tablespace, t.reloptions AS indreloptions, i.indisreplident, inh.inhparent AS parentidx, i.indnkeyatts AS indnkeyatts, i.indnatts AS indnatts, (SELECT pg_catalog.array_agg(attnum ORDER BY attnum)   FROM pg_catalog.pg_attribute   WHERE attrelid = i.indexrelid AND     attstattarget >= $2) AS indstatcols, (SELECT pg_catalog.array_agg(attstattarget ORDER BY attnum)   FROM pg_catalog.pg_attribute   WHERE attrelid = i.indexrelid AND     attstattarget >= $3) AS indstatvals, i.indnullsnotdistinct FROM unnest($4::pg_catalog.oid[]) AS src(tbloid)
JOIN pg_catalog.pg_index i ON (src.tbloid = i.indrelid) JOIN pg_catalog.pg_class t ON (t.oid = i.indexrelid) JOIN pg_catalog.pg_class t2 ON (t2.oid = i.indrelid) LEFT JOIN pg_catalog.pg_constraint c ON (i.indrelid = c.conrelid AND i.indexrelid = c.conindid AND c.contype IN ($5,$6,$7)) LEFT JOIN pg_catalog.pg_inherits inh ON (inh.inhrelid = indexrelid) WHERE (i.indisvalid OR t2.relkind = $8) AND i.indisready ORDER BY i.indrelid, indexname",0,0,0,0,0,0,2,26.434412000000002,0.117329,26.317083,13.217206000000001,13.099877000000001,186,14538,46,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5970120050215269194,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_data WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.609127,0.609127,0.609127,0.609127,0,63,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3624007798430595726,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_weekly LIMIT $2),0,0,0,0,0,0,1,0.007634,0.007634,0.007634,0.007634,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4599933100654954748,"SELECT tableoid, oid, oprname, oprnamespace, oprowner, oprkind, oprleft, oprright, oprcode::oid AS oprcode FROM pg_operator",0,0,0,0,0,0,2,1.249353,0.535921,0.713432,0.6246765,0.08875549999999999,1678,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1890428851672728953,SELECT COUNT(*) FROM public.view_riksdagen_crisis_resilience_indicators,0,0,0,0,0,0,1,3421.081616,3421.081616,3421.081616,3421.081616,0,1,27284,176662,0,1,0,0,0,0,11422,11442,0,0,0,0,0,0,0,59,3.538519,1,25.18086,1,460.853356,1,281.080648
10,16385,f,-448624641361605857,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_weekly,0,0,0,0,0,0,1,5994.928024,5994.928024,5994.928024,5994.928024,0,234252,32638,41924,9061,16130,0,0,0,0,15874,15898,0,0,0,0,236165,1581,89788313,0,0,0,0,0,0,0,0
10,16385,t,-4761507056991347060,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.116858,0.116858,0.116858,0.116858,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4450533386976091543,"SELECT n.tableoid, n.oid, n.nspname, n.nspowner, n.nspacl, acldefault($1, n.nspowner) AS acldefault FROM pg_namespace n",0,0,0,0,0,0,2,0.045735,0.021039,0.024696,0.0228675,0.0018285000000000003,16,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6033168451161270308,COPY  ( SELECT * FROM public.committee_proposal_component_0 ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.071108,2.071108,2.071108,2.071108,0,500,15,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1152709379256106198,COPY  ( SELECT * FROM public.view_riksdagen_party_document_daily_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,20.505881,20.505881,20.505881,20.505881,0,500,290,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,996681340746246903,SELECT COUNT(*) FROM public.view_ministry_effectiveness_trends,0,0,0,0,0,0,1,120.790479,120.790479,120.790479,120.790479,0,1,3176,3959,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,58,2.498306,0,0,1,1.227152,1,24.122496
10,16385,f,-8120855969446078482,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.190055,0.190055,0.190055,0.190055,0,2,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2534716312390675673,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_weekly,0,0,0,0,0,0,1,80.904606,80.904606,80.904606,80.904606,0,5470,5261,298,154,196,0,0,0,0,160,323,0,0,0,0,5757,20,1479932,0,0,0,0,0,0,0,0
16384,16385,t,3951418802997374546,"INSERT INTO public.databasechangelog (ID, AUTHOR, FILENAME, DATEEXECUTED, ORDEREXECUTED, MD5SUM, DESCRIPTION, COMMENTS, EXECTYPE, CONTEXTS, LABELS, LIQUIBASE, DEPLOYMENT_ID) VALUES ($1, $2, $3, NOW(), $4, $5, $6, $7, $8, $9, $10, $11, $12)",0,0,0,0,0,0,2,39.85593,0.024746,39.831184,19.927965,19.903219,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,2,1,5084,0,0,0,0,0,0,0,0
10,16385,t,-4171163751319968680,"SELECT p.tableoid, p.oid, p.proname, p.prolang, p.pronargs, p.proargtypes, p.prorettype, p.proacl, acldefault($1, p.proowner) AS acldefault, p.pronamespace, p.proowner FROM pg_proc p LEFT JOIN pg_init_privs pip ON (p.oid = pip.objoid AND pip.classoid = $2::regclass AND pip.objsubid = $3) WHERE p.prokind <> $4
  AND NOT EXISTS (SELECT $5 FROM pg_depend WHERE classid = $6::regclass AND objid = p.oid AND deptype = $7)
  AND (
  pronamespace != (SELECT oid FROM pg_namespace WHERE nspname = $8)
  OR EXISTS (SELECT $9 FROM pg_cast
  WHERE pg_cast.oid > $10 
  AND p.oid = pg_cast.castfunc)
  OR EXISTS (SELECT $11 FROM pg_transform
  WHERE pg_transform.oid > $12 AND 
  (p.oid = pg_transform.trffromsql
  OR p.oid = pg_transform.trftosql))
  OR p.proacl IS DISTINCT FROM pip.initprivs)",0,0,0,0,0,0,2,35.82392,4.03225,31.79167,17.91196,13.87971,334,224,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5211937616317436476,"SELECT influence_assessment, COUNT(*) as cnt FROM view_riksdagen_politician_influence_metrics GROUP BY influence_assessment ORDER BY cnt DESC",0,0,0,0,0,0,1,2.0388770000000003,2.0388770000000003,2.0388770000000003,2.0388770000000003,0,1,346,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2099905429043383653,COPY  ( SELECT * FROM public.view_riksdagen_party_ballot_support_annual_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,1564.226385,1564.226385,1564.226385,1564.226385,0,500,352492,3080,0,0,0,0,0,0,2112,2123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-8686801205445446818,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABgjE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABiAAAAAAAAAAA',0,0,0,0,0,0,1,0.001583,0.001583,0.001583,0.001583,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7630280355707361936,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_annual ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,87.450468,87.450468,87.450468,87.450468,0,500,2608,1050,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7512864040217976531,"SELECT t.tablename,
               COALESCE(c.reltuples, $1)::BIGINT AS row_count
        FROM pg_tables t
        JOIN pg_class c ON c.relname = t.tablename
        JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
        WHERE t.schemaname = $2
        ORDER BY t.tablename",0,0,0,0,0,0,1,0.69976,0.69976,0.69976,0.69976,0,93,604,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4258874667858305805,"WITH categorical_columns AS (
    SELECT 
        c.table_name,
        c.column_name,
        c.data_type,
        c.character_maximum_length
    FROM information_schema.columns c
    JOIN information_schema.tables t 
        ON t.table_schema = c.table_schema 
        AND t.table_name = c.table_name
    WHERE c.table_schema = $1
      AND t.table_type = $2
      AND c.data_type IN ($3, $4, $5)
      -- Exclude large text fields and known non-categorical columns
      AND (c.character_maximum_length IS NULL OR c.character_maximum_length <= $6)
      -- ========================================================================
      -- EXCLUDE CONTENT/TEXT FIELDS (long text, descriptions, etc.)
      -- ========================================================================
      AND c.column_name NOT IN ($7, $8, $9, $10, $11, 
                                 $12, $13, $14, $15, $16,
                                 $17, $18, $19, $20,
                                 $21, $22, $23,
                                 $24, $25,
                                 $26, $27, $28)
      -- ========================================================================
      -- EXCLUDE URL FIELDS
      -- ========================================================================
      AND c.column_name NOT IN ($29, $30, $31, $32, 
                                 $33, $34, $35,
                                 $36, $37,
                                 $38, $39,
                                 $40, $41, $42)
      -- ========================================================================
      -- EXCLUDE NAME FIELDS (person names, full names, etc.)
      -- ========================================================================
      AND c.column_name NOT IN ($43, $44, $45, $46,
                                 $47, $48, $49,
                                 $50, $51, $52,
                                 $53, $54,
                                 $55, $56, $57, $58,
                                 $59, $60, $61, 
                                 $62, $63)
      -- ========================================================================
      -- EXCLUDE ID FIELDS (unique identifiers, foreign keys, etc.)
      -- ========================================================================
      AND c.column_name NOT LIKE $64
      AND c.column_name NOT LIKE $65
      AND c.column_name NOT LIKE $66
      AND c.column_name != $67
      AND c.column_name NOT LIKE $68
      AND c.column_name NOT LIKE $69
      AND c.column_name NOT LIKE $70
      AND c.column_name NOT LIKE $71
      AND c.column_name NOT LIKE $72
      AND c.column_name NOT LIKE $73
      AND c.column_name NOT LIKE $74
      -- ========================================================================
      -- EXCLUDE SESSION/USER TRACKING FIELDS
      -- ========================================================================
      AND c.column_name NOT IN ($75, $76, $77,
                                 $78, $79, $80, $81)
      -- ========================================================================
      -- EXCLUDE DATE/TIME STRING FIELDS
      -- ========================================================================
      AND c.column_name NOT LIKE $82
      AND c.column_name NOT LIKE $83
      AND c.column_name NOT IN ($84, $85, $86, $87,
                                 $88)
      -- ========================================================================
      -- EXCLUDE TECHNICAL/INFRASTRUCTURE TABLES (not domain data)
      -- ========================================================================
      -- Javers audit tables (jv_*)
      AND c.table_name NOT LIKE $89
      -- Quartz scheduler tables (qrtz_*)
      AND c.table_name NOT LIKE $90
      -- Liquibase migration tables
      AND c.table_name NOT IN ($91, $92)
      -- Hibernate sequence table
      AND c.table_name != $93
      -- Encrypted value storage (sensitive)
      AND c.table_name != $94
      -- Application session/event tables (user tracking, not political data)
      AND c.table_name NOT IN ($95, $96, 
                                $97, $98)
      -- User account tables (sensitive)
      AND c.table_name NOT IN ($99, $100)
      -- Portal configuration tables
      AND c.table_name NOT IN ($101, $102, $103)
      -- Rule violation tracking
      AND c.table_name != $104
      -- Data source metadata
      AND c.table_name != $105
      -- Language/translation tables (not political data)
      AND c.table_name NOT IN ($106, $107)
      -- ========================================================================
      -- EXCLUDE OTHER HIGH-CARDINALITY OR NON-CATEGORICAL COLUMNS
      -- ========================================================================
      AND c.column_name NOT IN ($108, $109, $110, $111,
                                 $112, $113, $114, $115,
                                 $116, $117, $118, 
                                 $119, $120, $121, $122,
                                 $123, $124, $125)
      -- ========================================================================
      -- Skip columns already extracted above (critical columns)
      -- ========================================================================
      AND NOT (c.table_name = $126 AND c.column_name IN ($127, $128, $129, $130, $131, $132))
      AND NOT (c.table_name = $133 AND c.column_name IN ($134, $135, $136, $137))
      AND NOT (c.table_name = $138 AND c.column_name IN ($139, $140, $141, $142))
      AND NOT (c.table_name = $143 AND c.column_name IN ($144, $145, $146, $147, $148))
      AND NOT (c.table_name = $149 AND c.column_name IN ($150, $151, $152, $153))
      AND NOT (c.table_name = $154 AND c.column_name IN ($155, $156, $157, $158))
      AND NOT (c.table_name = $159 AND c.column_name IN ($160))
      AND NOT (c.table_name = $161 AND c.column_name IN ($162, $163, $164, $165, $166, $167, $168))
      AND NOT (c.table_name = $169 AND c.column_name IN ($170, $171))
    ORDER BY c.table_name, c.column_name
)
SELECT format(
    $172 || $173 ||
    $174 || $175,
    table_name, column_name,
    column_name, table_name, column_name, column_name, column_name,
    table_name, column_name
)
FROM categorical_columns",0,0,0,0,0,0,1,42.776735,42.776735,42.776735,42.776735,0,51,7970,65,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4218563625988027950,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB7zE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB9QAAAAAAAAAA',0,0,0,0,0,0,1,37.703633,37.703633,37.703633,37.703633,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,t,903869099329002398,"CREATE VIEW view_riksdagen_politician_influence_metrics AS
WITH co_voting_pairs AS (
    SELECT
        v1.embedded_id_intressent_id AS person_1,
        v2.embedded_id_intressent_id AS person_2,
        COUNT(*) AS co_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END) AS aligned_votes,
        SUM(CASE WHEN v1.vote = v2.vote THEN 1 ELSE 0 END)::DOUBLE PRECISION / 
            NULLIF(COUNT(*), 0)::DOUBLE PRECISION AS alignment_rate
    FROM vote_data v1
    JOIN vote_data v2 
        ON v1.embedded_id_ballot_id = v2.embedded_id_ballot_id
        AND v1.embedded_id_intressent_id < v2.embedded_id_intressent_id
    WHERE v1.vote_date >= CURRENT_DATE - INTERVAL '3 years'
        AND UPPER(v1.vote) IN ('JA', 'NEJ')
        AND UPPER(v2.vote) IN ('JA', 'NEJ')
    GROUP BY v1.embedded_id_intressent_id, v2.embedded_id_intressent_id
    HAVING COUNT(*) >= 10
),
network_connections AS (
    SELECT person_1 AS person_id FROM co_voting_pairs WHERE alignment_rate >= 0.7
    UNION ALL
    SELECT person_2 AS person_id FROM co_voting_pairs WHERE alignment_rate >= 0.7
),
influence_metrics AS (
    SELECT person_id, COUNT(*) AS strong_connections
    FROM network_connections GROUP BY person_id
),
network_percentiles AS (
    SELECT 
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY strong_connections) AS p50,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY strong_connections) AS p75,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY strong_connections) AS p90
    FROM influence_metrics
)
SELECT
    p.id AS person_id, p.first_name, p.last_name, p.party,
    COALESCE(im.strong_connections, 0) AS network_connections,
    ROUND((SELECT p50 FROM network_percentiles)::NUMERIC, 2) AS network_median,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p90 FROM network_percentiles) THEN 'HIGHLY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p75 FROM network_percentiles) THEN 'INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p50 FROM network_percentiles) THEN 'MODERATELY_INFLUENTIAL'
        WHEN COALESCE(im.strong_connections, 0) > 0 THEN 'LIMITED_INFLUENCE'
        ELSE 'MINIMAL_INFLUENCE'
    END AS influence_classification,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= 20 THEN 'STRONG_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 10 THEN 'MODERATE_BROKER'
        WHEN COALESCE(im.strong_connections, 0) >= 5 THEN 'WEAK_BROKER'
        ELSE 'NON_BROKER'
    END AS broker_classification,
    CASE
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p90 FROM network_percentiles) THEN 'High influence - top 10% network connections'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p75 FROM network_percentiles) THEN 'Notable influence - top 25% network centrality'
        WHEN COALESCE(im.strong_connections, 0) >= (SELECT p50 FROM network_percentiles) THEN 'Standard influence - above median engagement'
        WHEN COALESCE(im.strong_connections, 0) > 0 THEN 'Limited influence - below median connections'
        ELSE 'Minimal network influence detected'
    END AS influence_assessment
FROM person_data p
LEFT JOIN influence_metrics im ON im.person_id = p.id
WHERE p.status IN ('Tjänstgörande riksdagsledamot', 'Tjänstgörande ersättare', 'Tillgänglig ersättare')
ORDER BY COALESCE(im.strong_connections, 0) DESC, p.last_name, p.first_name",0,0,0,0,0,0,1,12.779992,12.779992,12.779992,12.779992,0,0,1210,63,23,1,0,0,0,0,0,0,0,0,0,0,81,21,127584,0,0,0,0,0,0,0,0
10,16385,t,-1950276331679447438,"SELECT $1 ||
       $2 ||
       $3 ||
       $4 ||
       $5",0,0,0,0,0,0,1,0.002365,0.002365,0.002365,0.002365,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5738819726774227376,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_decision_type_org_summary LIMIT $2),0,0,0,0,0,0,1,0.0046500000000000005,0.0046500000000000005,0.0046500000000000005,0.0046500000000000005,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2477126433607443657,"COPY  ( SELECT country_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE country_value IS NOT NULL GROUP BY country_value ORDER BY count DESC, country_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,64.922166,64.922166,64.922166,64.922166,0,6,16,10349,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2179128826899775681,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.223458,0.223458,0.223458,0.223458,0,2,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1025945129509657008,SELECT COUNT(*)                FROM pg_matviews WHERE schemaname = $1,0,0,0,0,0,0,2,2.058484,0.855087,1.2033969999999998,1.029242,0.17415499999999987,2,364,253,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-8435907081639777784,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABuTE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAABvwAAAAAAAAAA',0,0,0,0,0,0,1,0.000682,0.000682,0.000682,0.000682,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-76139388212076228,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6]) AS col
WHERE EXISTS (SELECT $7 FROM information_schema.columns WHERE table_schema = $8 AND table_name = $9 AND column_name = col)",0,0,0,0,0,0,1,0.09081,0.09081,0.09081,0.09081,0,2,63,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,646875433578360539,COPY  ( SELECT * FROM public.document_status_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,27.83604,27.83604,27.83604,27.83604,0,300,25,1092,0,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8462426257437449303,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,5.929254,5.929254,5.929254,5.929254,0,5,482,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4669203939938592012,COPY  ( SELECT * FROM public.document_person_reference_da_0 ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,70.96279799999999,70.96279799999999,70.96279799999999,70.96279799999999,0,500,0,3573,0,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3920457138378833976,"SELECT tableoid, oid, typname, typnamespace, typacl, acldefault($1, typowner) AS acldefault, typowner, typelem, typrelid, CASE WHEN typrelid = $2 THEN $3::""char"" ELSE (SELECT relkind FROM pg_class WHERE oid = typrelid) END AS typrelkind, typtype, typisdefined, typname[$4] = $5 AND typelem != $6 AND (SELECT typarray FROM pg_type te WHERE oid = pg_type.typelem) = oid AS isarray FROM pg_type",0,0,0,0,0,0,2,118.78402200000001,2.823914,115.960108,59.392011000000004,56.568097,1942,7495,71,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4921801796223722027,COPY  ( SELECT * FROM public.document_reference_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,168.613947,168.613947,168.613947,168.613947,0,300,0,159,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8548253369835786596,"SELECT tableoid, oid, stxname, stxnamespace, stxowner, stxrelid, stxstattarget FROM pg_catalog.pg_statistic_ext",0,0,0,0,0,0,2,0.007825,0.003146,0.004679,0.0039125,0.0007665000000000001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4106991534011733459,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.143568,0.143568,0.143568,0.143568,0,2,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2482844759802316850,"SELECT EXTRACT($1 FROM made_public_date) as year, COUNT(*) FROM document_data WHERE LOWER(org) = $2 AND made_public_date >= CURRENT_DATE - INTERVAL $3 GROUP BY year ORDER BY year DESC",0,0,0,0,0,0,1,6.829455,6.829455,6.829455,6.829455,0,3,1966,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6697899161944479332,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0065130000000000006,0.0065130000000000006,0.0065130000000000006,0.0065130000000000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6497110935609590010,"SELECT $1 as view_name, COUNT(*) FROM view_riksdagen_politician_experience_summary",0,0,0,0,0,0,1,678.4204139999999,678.4204139999999,678.4204139999999,678.4204139999999,0,1,6,810,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5188814160967881233,COPY  ( SELECT * FROM public.document_element ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,319.131136,319.131136,319.131136,319.131136,0,300,91,35568,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8050999717778120741,"COPY  ( SELECT against_proposal_parties AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE against_proposal_parties IS NOT NULL GROUP BY against_proposal_parties ORDER BY count DESC, against_proposal_parties LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,15.452965,15.452965,15.452965,15.452965,0,205,2838,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4963440528057351518,"SELECT c.oid
FROM pg_catalog.pg_class c
     LEFT JOIN pg_catalog.pg_namespace n
     ON n.oid OPERATOR(pg_catalog.=) c.relnamespace
WHERE c.relkind OPERATOR(pg_catalog.=) ANY
    (array[$1, $2, $3, $4, $5, $6])
  AND c.relname OPERATOR(pg_catalog.~) $7 COLLATE pg_catalog.default
  AND n.nspname OPERATOR(pg_catalog.~) $8 COLLATE pg_catalog.default",0,0,0,0,0,0,2,0.11772,0.032100000000000004,0.08562,0.05886,0.02676,2,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1575543629927398433,COPY  ( SELECT * FROM public.document_detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,86.49768300000001,86.49768300000001,86.49768300000001,86.49768300000001,0,300,0,6534,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3834726387479177005,"COPY  ( SELECT winner AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE winner IS NOT NULL GROUP BY winner ORDER BY count DESC, winner LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,16.983491,16.983491,16.983491,16.983491,0,44,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8926741491515786640,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_annual ORDER BY random ( ) LIMIT 201 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,64.381634,64.381634,64.381634,64.381634,0,201,1920,466,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9058185431485121486,SELECT COUNT(*) FROM public.view_riksdagen_committee_roles,0,0,0,0,0,0,1,7.125779,7.125779,7.125779,7.125779,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-7961991686218000006,SELECT * FROM QRTZ_SCHEDULER_STATE WHERE SCHED_NAME = $1,0,0,0,0,0,0,1,497.88048000000003,497.88048000000003,497.88048000000003,497.88048000000003,0,1,0,126,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,5784196478574959785,"SELECT current_database() AS ""TABLE_CAT"", n.nspname AS ""TABLE_SCHEM"", c.relname AS ""TABLE_NAME"",  CASE n.nspname ~ $2 OR n.nspname = $3  WHEN $4 THEN CASE  WHEN n.nspname = $5 OR n.nspname = $6 THEN CASE c.relkind   WHEN $7 THEN $8   WHEN $9 THEN $10   WHEN $11 THEN $12   ELSE $13   END  WHEN n.nspname = $14 THEN CASE c.relkind   WHEN $15 THEN $16   WHEN $17 THEN $18   ELSE $19   END  ELSE CASE c.relkind   WHEN $20 THEN $21   WHEN $22 THEN $23   WHEN $24 THEN $25   WHEN $26 THEN $27   WHEN $28 THEN $29   ELSE $30   END  END  WHEN $31 THEN CASE c.relkind  WHEN $32 THEN $33  WHEN $34 THEN $35  WHEN $36 THEN $37  WHEN $38 then $39  WHEN $40 THEN $41  WHEN $42 THEN $43  WHEN $44 THEN $45  WHEN $46 THEN $47  WHEN $48 THEN $49  ELSE $50  END  ELSE $51  END  AS ""TABLE_TYPE"", d.description AS ""REMARKS"",  $52 as ""TYPE_CAT"", $53 as ""TYPE_SCHEM"", $54 as ""TYPE_NAME"", $55 AS ""SELF_REFERENCING_COL_NAME"", $56 AS ""REF_GENERATION""  FROM pg_catalog.pg_namespace n, pg_catalog.pg_class c  LEFT JOIN pg_catalog.pg_description d ON (c.oid = d.objoid AND d.objsubid = $57  and d.classoid = $58::regclass)  WHERE c.relnamespace = n.oid  AND c.relname LIKE $1 AND ($59  OR ( c.relkind = $60 AND n.nspname !~ $61 AND n.nspname <> $62 ) )  ORDER BY ""TABLE_TYPE"",""TABLE_SCHEM"",""TABLE_NAME""",0,0,0,0,0,0,4,0.17235,0.03248,0.049863,0.0430875,0.006448110052565789,4,72,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8800264462073631566,"COPY  ( SELECT processed_in AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE processed_in IS NOT NULL GROUP BY processed_in ORDER BY count DESC, processed_in LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,21.359883999999997,21.359883999999997,21.359883999999997,21.359883999999997,0,1000,2721,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6020268284620892884,"DROP FUNCTION IF EXISTS cia_tmp_rowcount(text, text)",0,0,0,0,0,0,1,0.532064,0.532064,0.532064,0.532064,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1341404311560571254,"SELECT c.tableoid, c.oid, conrelid, conname, confrelid, conindid, pg_catalog.pg_get_constraintdef(c.oid) AS condef
FROM unnest($1::pg_catalog.oid[]) AS src(tbloid)
JOIN pg_catalog.pg_constraint c ON (src.tbloid = c.conrelid)
WHERE contype = $2 AND conparentid = $3 ORDER BY conrelid, conname",0,0,0,0,0,0,2,0.392765,0.00478,0.38798499999999997,0.1963825,0.19160249999999998,60,283,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5830151107597017773,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_element WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.119153,0.119153,0.119153,0.119153,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5611325038629242765,COPY  ( SELECT * FROM public.view_riksdagen_org_document_daily_summary ORDER BY random ( ) LIMIT 300 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,56.689365,56.689365,56.689365,56.689365,0,300,225,571,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1685585884679675846,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM vote_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,364.318001,364.318001,364.318001,364.318001,0,24,113,87181,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.903718,0,0,1,0.434672,1,6.640173
10,16385,t,5217132863592203458,"COPY  ( SELECT proposal_type AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE proposal_type IS NOT NULL GROUP BY proposal_type ORDER BY count DESC, proposal_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,9.394165,9.394165,9.394165,9.394165,0,1,683,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-910392483279635299,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_decisions LIMIT $2),0,0,0,0,0,0,1,0.00569,0.00569,0.00569,0.00569,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6313085444931695791,"COPY  ( SELECT target AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE target IS NOT NULL GROUP BY target ORDER BY count DESC, target LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.113982,0.113982,0.113982,0.113982,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,6811044898345128956,select commit_date_instant from jv_commit where $1<$2,0,0,0,0,0,0,1,0.001023,0.001023,0.001023,0.001023,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2436621565251780920,"COPY  ( SELECT debate_name AS value, COUNT ( * ) AS count FROM document_element WHERE debate_name IS NOT NULL GROUP BY debate_name ORDER BY count DESC, debate_name LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,63.30295099999999,63.30295099999999,63.30295099999999,63.30295099999999,0,89,716,34852,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2009218746981338303,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $2 ) SELECT * FROM temporal_strata WHERE rn <= $3 LIMIT $4 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.220642,0.220642,0.220642,0.220642,0,8,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3941512082369733549,"SELECT tableoid, oid, trftype, trflang, trffromsql::oid, trftosql::oid FROM pg_transform ORDER BY 3,4",0,0,0,0,0,0,2,0.007604,0.003677,0.003927,0.003802,0.00012499999999999979,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1567826698846653914,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM document_activity_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,342.329495,342.329495,342.329495,342.329495,0,33,16,4984,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,f,5344976743488284415,"SELECT pg_catalog.upper(object_type),
       object_identity,
       pg_catalog.upper(command_tag)
  FROM pg_catalog.pg_event_trigger_ddl_commands()",0,0,0,0,0,0,45,1.4516309999999997,0.0028150000000000002,0.103932,0.032258466666666666,0.01964553072567227,38,1264,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8822555078304745203,"SELECT COUNT(*)                      FROM (
        SELECT viewname FROM pg_views 
        WHERE schemaname = $1 
          AND viewname != $2
        UNION ALL
        SELECT matviewname FROM pg_matviews 
        WHERE schemaname = $3
    ) v",0,0,0,0,0,0,1,1.229817,1.229817,1.229817,1.229817,0,1,624,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6603308638027092308,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_data WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.592797,0.592797,0.592797,0.592797,0,2,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1025844612692719348,SELECT COUNT(*) FROM public.view_riksdagen_politician_ballot_summary,0,0,0,0,0,0,1,3.4423209999999997,3.4423209999999997,3.4423209999999997,3.4423209999999997,0,1,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7890668842115706593,"COPY  ( SELECT database_source AS value, COUNT ( * ) AS count FROM document_element WHERE database_source IS NOT NULL GROUP BY database_source ORDER BY count DESC, database_source LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.652436,58.652436,58.652436,58.652436,0,5,622,34949,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,512984412289296961,SELECT COUNT(*) FROM public.view_riksdagen_member_proposals,0,0,0,0,0,0,1,59.170326,59.170326,59.170326,59.170326,0,1,6,35552,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1824474597097855161,"SELECT name, year, documents_produced, propositions, government_bills, performance_assessment FROM view_ministry_productivity_matrix ORDER BY year DESC, documents_produced DESC LIMIT $1",0,0,0,0,0,0,1,5242.90412,5242.90412,5242.90412,5242.90412,0,3,169,6980,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7322790476422083611,SELECT COUNT(*) as cnt FROM view_riksdagen_politician_experience_summary LIMIT $1,0,0,0,0,0,0,1,126.91630300000001,126.91630300000001,126.91630300000001,126.91630300000001,0,1,816,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-141877066004497947,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary,0,0,0,0,0,0,1,1665.647766,1665.647766,1665.647766,1665.647766,0,0,5906,30337,16,8,0,0,0,0,0,0,0,0,0,0,159,8,123286,0,0,0,0,0,0,0,0
10,16385,t,9164776282471408627,"CREATE OR REPLACE FUNCTION cia_tmp_rowcount(schema_name text, rel_name text)
RETURNS bigint
LANGUAGE plpgsql
AS $$
DECLARE
    result bigint;
BEGIN
    EXECUTE format('SELECT COUNT(*) FROM %I.%I', schema_name, rel_name) INTO result;
    RETURN COALESCE(result, 0);
EXCEPTION WHEN OTHERS THEN
    RAISE NOTICE 'ERROR counting rows in %.%: %', schema_name, rel_name, SQLERRM;
    RETURN 0;
END;
$$",0,0,0,0,0,0,1,89.659085,89.659085,89.659085,89.659085,0,0,202,3,5,0,0,0,0,0,0,0,0,0,0,0,8,7,42418,0,0,0,0,0,0,0,0
10,16385,t,-6922475090301816933,COPY  ( SELECT * FROM public.person_detail_data ORDER BY random ( ) LIMIT 2487 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,78.359353,78.359353,78.359353,78.359353,0,2487,34,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2772381786219494617,"COPY  ( SELECT income_level_value AS value, COUNT ( * ) AS count FROM country_element WHERE income_level_value IS NOT NULL GROUP BY income_level_value ORDER BY count DESC, income_level_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,47.168035,47.168035,47.168035,47.168035,0,3,38,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2519839555235892940,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,269.249801,269.249801,269.249801,269.249801,0,1,9932,77365,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,5218333237361128112,"select applicatio0_.hjid as hjid1_4_, applicatio0_.component as componen2_4_, applicatio0_.component_description as componen3_4_, applicatio0_.component_title as componen4_4_, applicatio0_.config_description as config_d5_4_, applicatio0_.config_title as config_t6_4_, applicatio0_.configuration_group as configur7_4_, applicatio0_.created_date as created_8_4_, applicatio0_.model_object_id as model_ob9_4_, applicatio0_.model_object_version as model_o10_4_, applicatio0_.property_id as propert11_4_, applicatio0_.property_value as propert12_4_, applicatio0_.updated_date as updated13_4_ from application_configuration applicatio0_ where upper(applicatio0_.component)=$1 and applicatio0_.configuration_group=$2 and upper(applicatio0_.property_id)=$3",0,0,0,0,0,0,11,0.7683230000000002,0.013675,0.592045,0.06984754545454547,0.16517267932756902,11,10,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3550770545175639659,"COPY  ( SELECT party_short_code AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE party_short_code IS NOT NULL GROUP BY party_short_code ORDER BY count DESC, party_short_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,33.216105000000006,33.216105000000006,33.216105000000006,33.216105000000006,0,16,16,3573,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5106495086450362632,COPY  ( SELECT * FROM public.document_reference_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,184.01888,184.01888,184.01888,184.01888,0,300,37,164,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3111965675964246692,"DO $$
DECLARE
    mv_record RECORD;
    success_count INTEGER := 0;
    error_count INTEGER := 0;
    start_time TIMESTAMP;
    end_time TIMESTAMP;
    duration INTERVAL;
    total_mvs INTEGER;
    has_data BOOLEAN;
    max_passes INTEGER := 3;
    views_refreshed_this_pass INTEGER;
    view_index INTEGER := 0;
    pass_number INTEGER;
BEGIN
    start_time := clock_timestamp();
    
    -- Get total count for progress reporting
    SELECT COUNT(*) INTO total_mvs FROM pg_matviews WHERE schemaname = 'public';
    
    RAISE NOTICE '================================================';
    RAISE NOTICE 'Found % materialized views to refresh', total_mvs;
    RAISE NOTICE 'Using multi-pass approach to handle dependencies';
    RAISE NOTICE '================================================';
    RAISE NOTICE '';
    
    -- Create temp table to track successfully refreshed views
    CREATE TEMP TABLE IF NOT EXISTS tmp_mv_refresh_state (
        schemaname  text NOT NULL,
        matviewname text NOT NULL,
        PRIMARY KEY (schemaname, matviewname)
    ) ON COMMIT PRESERVE ROWS;
    
    -- Multi-pass refresh to handle dependencies
    -- Pass 1: Refresh base views (no dependencies on other materialized views)
    -- Pass 2-3: Refresh dependent views (may fail in early passes if dependencies not ready)
    FOR pass_number IN 1..max_passes LOOP
        views_refreshed_this_pass := 0;
        view_index := 0;
        
        RAISE NOTICE '--- Pass % of % ---', pass_number, max_passes;
        RAISE NOTICE '';
        
        -- Try to refresh all materialized views
        FOR mv_record IN 
            SELECT schemaname, matviewname
            FROM pg_matviews
            WHERE schemaname = 'public'
            ORDER BY matviewname
        LOOP
            BEGIN
                view_index := view_index + 1;
                
                -- Skip views that have already been successfully refreshed in a previous pass
                IF EXISTS (
                    SELECT 1
                    FROM tmp_mv_refresh_state s
                    WHERE s.schemaname  = mv_record.schemaname
                      AND s.matviewname = mv_record.matviewname
                ) THEN
                    RAISE NOTICE '  [%/%] SKIP %.% - already successfully refreshed in a previous pass',
                        view_index, total_mvs,
                        mv_record.schemaname, mv_record.matviewname;
                    CONTINUE;
                END IF;
                
                RAISE NOTICE '→ [%/%] Pass % - Refreshing: %.%', 
                    view_index, total_mvs, pass_number,
                    mv_record.schemaname, mv_record.matviewname;
                
                -- Refresh the materialized view
                EXECUTE format('REFRESH MATERIALIZED VIEW %I.%I', 
                    mv_record.schemaname, mv_record.matviewname);
                
                -- Record that this view has now been successfully refreshed (even if it contains 0 rows)
                INSERT INTO tmp_mv_refresh_state (schemaname, matviewname)
                VALUES (mv_record.schemaname, mv_record.matviewname)
                ON CONFLICT (schemaname, matviewname) DO NOTHING;
                
                -- Check if view has any data using efficient EXISTS query
                EXECUTE format('SELECT EXISTS(SELECT 1 FROM %I.%I LIMIT 1)', 
                    mv_record.schemaname, mv_record.matviewname) INTO has_data;
                
                success_count := success_count + 1;
                views_refreshed_this_pass := views_refreshed_this_pass + 1;
                
                IF has_data THEN
                    RAISE NOTICE '  ✓ Refreshed successfully - contains data';
                ELSE
                    RAISE NOTICE '  ✓ Refreshed successfully - 0 rows (may be expected based on data filters)';
                END IF;
                RAISE NOTICE '';
                
            EXCEPTION WHEN OTHERS THEN
                IF pass_number < max_passes THEN
                    RAISE NOTICE '  ⏭  Deferred (will retry in next pass): %', SQLERRM;
                ELSE
                    error_count := error_count + 1;
                    RAISE WARNING '  ✗ Failed to refresh after % passes: %', max_passes, SQLERRM;
                END IF;
                RAISE NOTICE '';
            END;
        END LOOP;
        
        RAISE NOTICE 'Pass % complete: % views refreshed', pass_number, views_refreshed_this_pass;
        RAISE NOTICE '';
        
        -- Early exit logic:
        -- - If no views were refreshed AND all views have been accounted for (success/error), we're done
        -- - If no views were refreshed BUT there are still unprocessed views, continue to next pass
        --   (they were deferred and might succeed after dependencies are met)
        -- - If views were refreshed, continue to next pass to retry deferred views
        IF views_refreshed_this_pass = 0
           AND (total_mvs - success_count - error_count) = 0 THEN
            RAISE NOTICE 'No views refreshed in this pass and no remaining views to retry - stopping early';
            EXIT;
        END IF;
    END LOOP;
    
    end_time := clock_timestamp();
    duration := end_time - start_time;
    
    RAISE NOTICE '';
    RAISE NOTICE '================================================';
    RAISE NOTICE 'Materialized view refresh summary:';
    RAISE NOTICE '  Total views: %', total_mvs;
    RAISE NOTICE '  Successfully refreshed: %', success_count;
    RAISE NOTICE '  Errors: %', error_count;
    RAISE NOTICE '  Duration: %', duration;
    RAISE NOTICE '================================================';
    RAISE NOTICE '';
    
    IF error_count > 0 THEN
        RAISE WARNING 'Some materialized views failed to refresh. Sample data for these views may be incomplete.';
    END IF;
END $$",0,0,0,0,0,0,1,262454.645076,262454.645076,262454.645076,262454.645076,0,0,831485,1396805,283643,556732,169,1,3,2,918371,921835,0,0,0,0,6513696,17129,2542505052,0,0,0,0,0,0,0,0
10,16385,t,-3882199540016818788,"DO $$
DECLARE
    view_record RECORD;
    view_count INTEGER := 0;
    success_count INTEGER := 0;
    error_count INTEGER := 0;
    start_time TIMESTAMP;
    end_time TIMESTAMP;
    duration INTERVAL;
    total_mat_views INTEGER;
    total_reg_views INTEGER;
BEGIN
    start_time := clock_timestamp();
    
    -- Get counts for reporting
    SELECT COUNT(*) INTO total_mat_views FROM pg_matviews WHERE schemaname = 'public';
    SELECT COUNT(*) INTO total_reg_views FROM pg_views WHERE schemaname = 'public';
    
    RAISE NOTICE '================================================';
    RAISE NOTICE 'ANALYZE Phase: Only analyzing MATERIALIZED views';
    RAISE NOTICE '  - Materialized views to analyze: %', total_mat_views;
    RAISE NOTICE '  - Regular views (skipped - cannot be analyzed): %', total_reg_views;
    RAISE NOTICE '================================================';
    RAISE NOTICE '';
    RAISE NOTICE 'Note: Regular views cannot be ANALYZEd in PostgreSQL.';
    RAISE NOTICE '      They are virtual tables computed from their underlying query.';
    RAISE NOTICE '';
    
    -- Only analyze materialized views (regular views cannot be analyzed)
    RAISE NOTICE '--- Analyzing Materialized Views ---';
    RAISE NOTICE '';
    
    FOR view_record IN 
        SELECT schemaname, matviewname AS viewname
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY matviewname
    LOOP
        BEGIN
            view_count := view_count + 1;
            RAISE NOTICE 'ANALYZE [%/%]: %.%', view_count, total_mat_views,
                view_record.schemaname, view_record.viewname;
            
            EXECUTE format('ANALYZE %I.%I', view_record.schemaname, view_record.viewname);
            success_count := success_count + 1;
            RAISE NOTICE '  ✓ Analyzed successfully';
            RAISE NOTICE '';
            
        EXCEPTION WHEN OTHERS THEN
            error_count := error_count + 1;
            RAISE NOTICE '  ✗ ERROR: %', SQLERRM;
            RAISE NOTICE '';
        END;
    END LOOP;
    
    end_time := clock_timestamp();
    duration := end_time - start_time;
    
    RAISE NOTICE '';
    RAISE NOTICE '================================================';
    RAISE NOTICE 'View analysis summary:';
    RAISE NOTICE '  Materialized views analyzed: %', view_count;
    RAISE NOTICE '  Successfully analyzed: %', success_count;
    RAISE NOTICE '  Errors: %', error_count;
    RAISE NOTICE '  Duration: %', duration;
    RAISE NOTICE '  Regular views skipped: % (cannot be analyzed)', total_reg_views;
    RAISE NOTICE '================================================';
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,45436.753101,45436.753101,45436.753101,45436.753101,0,0,113088,112932,203,133,0,0,0,0,0,0,0,0,0,0,2575,52,1574781,0,0,0,0,0,0,0,0
10,16385,f,3152865185996954054,"COPY  ( SELECT born_year AS value, COUNT ( * ) AS count FROM person_element WHERE born_year IS NOT NULL GROUP BY born_year ORDER BY count DESC, born_year LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.007964,0.007964,0.007964,0.007964,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4194991235280545150,"COPY  ( SELECT parties AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE parties IS NOT NULL GROUP BY parties ORDER BY count DESC, parties LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,701.476318,701.476318,701.476318,701.476318,0,183,40,681,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4523881574894664531,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_decisions,0,0,0,0,0,0,1,1784.754466,1784.754466,1784.754466,1784.754466,0,44834,8262,3168,1377,1411,0,0,0,0,311,307,0,0,0,0,45339,284,14164697,0,0,0,0,0,0,0,0
10,16385,f,-5304116830395787913,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary,0,0,0,0,0,0,1,1342.168338,1342.168338,1342.168338,1342.168338,0,10095,26132,129926,275,7057,0,0,0,0,0,0,0,0,0,0,10458,135,3141260,0,0,0,0,0,0,0,0
16384,16385,t,7330627068831060704,"select documentel0_.id as id1_26_0_, documentel0_.committee_report_url_xml as committe2_26_0_, documentel0_.created_date as created_3_26_0_, documentel0_.database_source as database4_26_0_, documentel0_.debate_name as debate_n5_26_0_, documentel0_.doc_type as doc_type6_26_0_, documentel0_.document_format as document7_26_0_, documentel0_.document_name as document8_26_0_, documentel0_.document_status_url_xml as document9_26_0_, documentel0_.document_type as documen10_26_0_, documentel0_.document_url_html as documen11_26_0_, documentel0_.document_url_text as documen12_26_0_, documentel0_.domain_org as domain_13_26_0_, documentel0_.hit as hit14_26_0_, documentel0_.kall_id as kall_id15_26_0_, documentel0_.label as label16_26_0_, documentel0_.lang as lang17_26_0_, documentel0_.made_public_date as made_pu18_26_0_, documentel0_.note as note19_26_0_, documentel0_.note_title as note_ti20_26_0_, documentel0_.number_value as number_21_26_0_, documentel0_.org as org22_26_0_, documentel0_.origin as origin23_26_0_, documentel0_.related_id as related24_26_0_, documentel0_.rm as rm25_26_0_, documentel0_.status as status26_26_0_, documentel0_.sub_title as sub_tit27_26_0_, documentel0_.sub_type as sub_typ28_26_0_, documentel0_.summary as summary29_26_0_, documentel0_.system_date as system_30_26_0_, documentel0_.temp_label as temp_la31_26_0_, documentel0_.title as title32_26_0_ from document_element documentel0_ where documentel0_.id=$1",0,0,0,0,0,0,10,677.8256680000001,0.023865,321.822339,67.7825668,87.74425849072595,10,27,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-15028167937262528,"COPY  ( SELECT doc_type AS value, COUNT ( * ) AS count FROM document_element WHERE doc_type IS NOT NULL GROUP BY doc_type ORDER BY count DESC, doc_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,63.965008,63.965008,63.965008,63.965008,0,92,524,35047,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,861678720142994723,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_monthly ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,122.512259,122.512259,122.512259,122.512259,0,500,2940,3776,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8586256283480884713,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_monthly LIMIT $2),0,0,0,0,0,0,1,0.005701,0.005701,0.005701,0.005701,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7639934197587208605,"SELECT tableoid, oid, opfmethod, opfname, opfnamespace, opfowner FROM pg_opfamily",0,0,0,0,0,0,2,0.326149,0.087092,0.23905700000000002,0.1630745,0.07598250000000001,340,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7187836880505548044,"COPY  ( SELECT vote AS value, COUNT ( * ) AS count FROM vote_data WHERE vote IS NOT NULL GROUP BY vote ORDER BY count DESC, vote LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,359.679217,359.679217,359.679217,359.679217,0,4,9833,77461,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.916943,0,0,1,0.468675,1,6.696306
10,16385,f,-576670575671902707,COPY  ( SELECT * FROM public.document_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,317.54276999999996,317.54276999999996,317.54276999999996,317.54276999999996,0,300,23,35557,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,419275940722629130,"COPY  ( SELECT person_person_container_data_0 AS value, COUNT ( * ) AS count FROM person_container_data WHERE person_person_container_data_0 IS NOT NULL GROUP BY person_person_container_data_0 ORDER BY count DESC, person_person_container_data_0 LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,5.157324,5.157324,5.157324,5.157324,0,0,35,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,498642402500548654,"COPY  ( SELECT 'Summary of Distinct Value Extractions' AS info, COUNT ( * ) AS file_count FROM ( SELECT 1 ) x ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.113512,0.113512,0.113512,0.113512,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9028530376830418096,COPY  ( SELECT * FROM public.topics ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,41.552687999999996,41.552687999999996,41.552687999999996,41.552687999999996,0,200,0,111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8345881541332173693,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM committee_document_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.943778,2.943778,2.943778,2.943778,0,113,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7323889942907913181,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_annual ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,0.13087400000000002,0.13087400000000002,0.13087400000000002,0.13087400000000002,0,24,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2104824570254097199,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_politician_behavioral_trends ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 500 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,160.307929,160.307929,160.307929,160.307929,0,26,2633,5,0,0,0,0,0,0,523,524,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-915780080692265801,PREPARE TRANSACTION '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB1zE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAB3QAAAAAAAAAA',0,0,0,0,0,0,1,0.000651,0.000651,0.000651,0.000651,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8962724538291301946,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_daily,0,0,0,0,0,0,1,19.276402,19.276402,19.276402,19.276402,0,1314,3078,29,37,36,0,0,0,0,0,0,0,0,0,0,1559,9,334081,0,0,0,0,0,0,0,0
10,16385,f,6357806673740152695,SELECT COUNT(*)                      FROM pg_views WHERE schemaname = $1,0,0,0,0,0,0,1,0.5382950000000001,0.5382950000000001,0.5382950000000001,0.5382950000000001,0,1,312,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2307497707681882363,"SELECT
a.attrelid,
a.attnum,
a.attname,
a.attstattarget,
a.attstorage,
t.typstorage,
a.attnotnull,
a.atthasdef,
a.attisdropped,
a.attlen,
a.attalign,
a.attislocal,
pg_catalog.format_type(t.oid, a.atttypmod) AS atttypname,
array_to_string(a.attoptions, $1) AS attoptions,
CASE WHEN a.attcollation <> t.typcollation THEN a.attcollation ELSE $2 END AS attcollation,
pg_catalog.array_to_string(ARRAY(SELECT pg_catalog.quote_ident(option_name) || $3 || pg_catalog.quote_literal(option_value) FROM pg_catalog.pg_options_to_table(attfdwoptions) ORDER BY option_name), $4) AS attfdwoptions,
a.attcompression AS attcompression,
a.attidentity,
CASE WHEN a.atthasmissing AND NOT a.attisdropped THEN a.attmissingval ELSE $5 END AS attmissingval,
a.attgenerated
FROM unnest($6::pg_catalog.oid[]) AS src(tbloid)
JOIN pg_catalog.pg_attribute a ON (src.tbloid = a.attrelid) LEFT JOIN pg_catalog.pg_type t ON (a.atttypid = t.oid)
WHERE a.attnum > $7::pg_catalog.int2
ORDER BY a.attrelid, a.attnum",0,0,0,0,0,0,2,506.445244,0.12909099999999998,506.316153,253.222622,253.093531,2184,185,961,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7202963377163963147,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_weekly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,17.404356999999997,17.404356999999997,17.404356999999997,17.404356999999997,0,500,0,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3013036889970528370,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '30 days' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 40 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.398574,0.398574,0.398574,0.398574,0,5,27,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8341833111035762646,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_monthly,0,0,0,0,0,0,1,2198.937884,2198.937884,2198.937884,2198.937884,0,77334,19170,22319,3120,4228,0,0,0,0,13924,13950,0,0,0,0,77802,160,27794287,0,0,0,0,0,0,0,0
10,16385,t,-6867926316604806813,COPY  ( SELECT * FROM public.document_activity_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,247.742622,247.742622,247.742622,247.742622,0,300,37,4993,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2390032166487386806,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_daily LIMIT $2),0,0,0,0,0,0,1,0.004358,0.004358,0.004358,0.004358,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3441573488324617602,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM committee_document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,139.290762,139.290762,139.290762,139.290762,0,31,66,303,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3347936750016142216,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_monthly LIMIT $2),0,0,0,0,0,0,1,0.00575,0.00575,0.00575,0.00575,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,37807376974364690,"COPY  ( SELECT committee_report AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE committee_report IS NOT NULL GROUP BY committee_report ORDER BY count DESC, committee_report LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,14.543573,14.543573,14.543573,14.543573,0,778,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6403072102333226500,"SELECT x.tableoid, x.oid, x.extname, n.nspname, x.extrelocatable, x.extversion, x.extconfig, x.extcondition FROM pg_extension x JOIN pg_namespace n ON n.oid = x.extnamespace",0,0,0,0,0,0,2,0.313115,0.022292,0.290823,0.1565575,0.13426549999999998,10,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6488558639137853394,COPY  ( SELECT * FROM public.language_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.635127,0.635127,0.635127,0.635127,0,135,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-183859061988489850,"CREATE TEMP TABLE cia_view_row_counts (
    schemaname TEXT,
    viewname TEXT,
    view_type TEXT,
    row_count BIGINT
)",0,0,0,0,0,0,1,45.249533,45.249533,45.249533,45.249533,0,0,309,35,22,1,0,0,0,0,0,0,0,0,0,0,91,4,32082,0,0,0,0,0,0,0,0
10,16385,t,-7884900599736663882,"SELECT COUNT(*), COUNT(DISTINCT name) as ministries, COUNT(DISTINCT year) as years FROM view_ministry_productivity_matrix",0,0,0,0,0,0,1,94.759237,94.759237,94.759237,94.759237,0,1,7144,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,2.904074,0,0,1,1.146211,1,29.376038
10,16385,t,5477668860699884482,"COPY  ( SELECT document_category AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_category IS NOT NULL GROUP BY document_category ORDER BY count DESC, document_category LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,6.522261,6.522261,6.522261,6.522261,0,0,46,1081,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-38141737868937864,"COPY  ( SELECT short_code AS value, COUNT ( * ) AS count FROM sweden_political_party WHERE short_code IS NOT NULL GROUP BY short_code ORDER BY count DESC, short_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.0591950000000003,2.0591950000000003,2.0591950000000003,2.0591950000000003,0,30,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1340957926827089651,SELECT COUNT(*) FROM public.view_ministry_risk_evolution,0,0,0,0,0,0,1,55.464872,55.464872,55.464872,55.464872,0,1,6757,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6322041146789395679,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_data WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,25.363202,25.363202,25.363202,25.363202,0,4,0,3729,0,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5194774664920962416,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_element WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005079,0.005079,0.005079,0.005079,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6916484819104090036,"PREPARE dumpFunc(pg_catalog.oid) AS
SELECT
proretset,
prosrc,
probin,
provolatile,
proisstrict,
prosecdef,
lanname,
proconfig,
procost,
prorows,
pg_catalog.pg_get_function_arguments(p.oid) AS funcargs,
pg_catalog.pg_get_function_identity_arguments(p.oid) AS funciargs,
pg_catalog.pg_get_function_result(p.oid) AS funcresult,
proleakproof,
array_to_string(protrftypes, $2) AS protrftypes,
proparallel,
prokind,
prosupport,
pg_get_function_sqlbody(p.oid) AS prosqlbody
FROM pg_catalog.pg_proc p, pg_catalog.pg_language l
WHERE p.oid = $1 AND l.oid = p.prolang",0,0,0,0,0,0,2,0.082315,0.023504999999999998,0.05881,0.0411575,0.0176525,2,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2149828501065179358,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_ballot_decision_summary LIMIT $2),0,0,0,0,0,0,1,0.005089,0.005089,0.005089,0.005089,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1000146856326082512,"COPY  ( SELECT detail AS value, COUNT ( * ) AS count FROM assignment_data WHERE detail IS NOT NULL GROUP BY detail ORDER BY count DESC, detail LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.255833,7.255833,7.255833,7.255833,0,1329,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,4478134766338443755,"select documentat0_.document_attachment_list_doc_0 as document6_19_1_, documentat0_.hjid as hjid1_19_1_, documentat0_.hjid as hjid1_19_0_, documentat0_.file_name as file_nam2_19_0_, documentat0_.file_size as file_siz3_19_0_, documentat0_.file_type as file_typ4_19_0_, documentat0_.file_url as file_url5_19_0_ from document_attachment documentat0_ where documentat0_.document_attachment_list_doc_0=$1",0,0,0,0,0,0,1,3011.827423,3011.827423,3011.827423,3011.827423,0,1,0,3432,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8162883486582676232,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary,0,0,0,0,0,0,1,449.372899,449.372899,449.372899,449.372899,0,0,5307,2880,5,5,0,0,0,0,0,0,0,0,0,0,110,0,45941,0,0,0,0,0,0,0,0
16384,16385,t,6865378226349601843,select $1,0,0,0,0,0,0,3333,5.671408000000005,0.001072,0.027122,0.0017015925592559272,0.001022633904297555,3333,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5968163276858086128,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_element WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004949,0.004949,0.004949,0.004949,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3066644437915459195,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_annual,0,0,0,0,0,0,1,117.152249,117.152249,117.152249,117.152249,0,24,3274,1038,18,2,0,0,0,0,0,0,0,0,0,0,249,4,34261,0,0,0,0,0,0,0,0
10,16385,f,2590336096030674127,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , assessment_period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , assessment_period_end ) ORDER BY random ( ) ) AS rn FROM public.view_risk_score_evolution ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,634.6170020000001,634.6170020000001,634.6170020000001,634.6170020000001,0,26,9575,17633,0,0,0,0,0,0,3042,3049,0,0,0,0,0,0,0,100,5.645184,0,0,1,2.518223,1,55.267132
10,16385,t,3287544041744204403,"COPY  ( SELECT election_type AS value, COUNT ( * ) AS count FROM sweden_election_type WHERE election_type IS NOT NULL GROUP BY election_type ORDER BY count DESC, election_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.109715,0.109715,0.109715,0.109715,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6727690871473919091,COPY  ( SELECT * FROM public.databasechangelog ORDER BY random ( ) LIMIT 412 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,24.37102,24.37102,24.37102,24.37102,0,412,62,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3804950293618760755,SELECT COUNT(*) FROM public.view_riksdagen_person_signed_document_summary,0,0,0,0,0,0,1,53.538725,53.538725,53.538725,53.538725,0,1,3573,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-9025402556122639014,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,160.4249,160.4249,160.4249,160.4249,0,0,34,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6594641675432182244,"SELECT c.relchecks, c.relkind, c.relhasindex, c.relhasrules, c.relhastriggers, c.relrowsecurity, c.relforcerowsecurity, $1 AS relhasoids, c.relispartition, $2, c.reltablespace, CASE WHEN c.reloftype = $3 THEN $4 ELSE c.reloftype::pg_catalog.regtype::pg_catalog.text END, c.relpersistence, c.relreplident, am.amname
FROM pg_catalog.pg_class c
 LEFT JOIN pg_catalog.pg_class tc ON (c.reltoastrelid = tc.oid)
LEFT JOIN pg_catalog.pg_am am ON (c.relam = am.oid)
WHERE c.oid = $5",0,0,0,0,0,0,2,0.033181,0.011751,0.02143,0.0165905,0.004839500000000002,2,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8225590632394450009,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $2 ) SELECT * FROM temporal_strata WHERE rn <= $3 LIMIT $4 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.284331,0.284331,0.284331,0.284331,0,8,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4500833535435516029,"COPY  ( SELECT doc_type AS value, COUNT ( * ) AS count FROM document_element WHERE doc_type IS NOT NULL GROUP BY doc_type ORDER BY count DESC, doc_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,63.74062899999999,63.74062899999999,63.74062899999999,63.74062899999999,0,92,522,35046,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7075101292227276557,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_document_type_daily_summary LIMIT $2),0,0,0,0,0,0,1,0.009538000000000001,0.009538000000000001,0.009538000000000001,0.009538000000000001,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1953414026337854989,"SET SEARCH_PATH TO public, ""$user"",""public""",0,0,0,0,0,0,3,0.023464,0.007183,0.008256,0.007821333333333333,0.0004611162784181682,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1247695087184911907,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_monthly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,6.4806289999999995,6.4806289999999995,6.4806289999999995,6.4806289999999995,0,220,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3793578130696151253,"COPY  ( SELECT electoral_region AS value, COUNT ( * ) AS count FROM vote_data WHERE electoral_region IS NOT NULL GROUP BY electoral_region ORDER BY count DESC, electoral_region LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,331.496315,331.496315,331.496315,331.496315,0,30,18,87279,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,147348836072383447,SELECT global_id_pk FROM jv_global_id WHERE $3 = $4 AND local_id = $1 AND type_name = $2,0,0,0,0,0,0,10,586.83362,0.016541,360.164922,58.683362,104.84278665828947,10,37,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-9060554241957088338,"select agency0_.hjid as hjid1_2_, agency0_.agency_name as agency_n2_2_, agency0_.description as descript3_2_, agency0_.model_object_id as model_ob4_2_, agency0_.model_object_version as model_ob5_2_ from agency agency0_",0,0,0,0,0,0,1,48.782908,48.782908,48.782908,48.782908,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,368717928347879829,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,277.584495,277.584495,277.584495,277.584495,0,17,38,516,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5272467656550815857,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_weekly LIMIT $2),0,0,0,0,0,0,1,0.004288,0.004288,0.004288,0.004288,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3349374830294349948,"COPY  ( SELECT lang AS value, COUNT ( * ) AS count FROM document_element WHERE lang IS NOT NULL GROUP BY lang ORDER BY count DESC, lang LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,60.681976999999996,60.681976999999996,60.681976999999996,60.681976999999996,0,23,1101,34467,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8172190135259613724,"COPY  ( SELECT proffessional_behavior AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE proffessional_behavior IS NOT NULL GROUP BY proffessional_behavior ORDER BY count DESC, proffessional_behavior LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005169,0.005169,0.005169,0.005169,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6599269650446847906,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary,0,0,0,0,0,0,1,79809.950027,79809.950027,79809.950027,79809.950027,0,3523155,343553,551946,141098,282487,0,0,0,0,452425,452732,0,0,0,0,3532583,9141,1279401745,0,0,0,0,0,0,0,0
10,16385,t,-2623819358189634892,COPY  ( SELECT * FROM public.world_bank_data ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,198.229201,198.229201,198.229201,198.229201,0,200,21,10352,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6306562135648825081,COPY  ( SELECT * FROM public.document_proposal_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,140.804906,140.804906,140.804906,140.804906,0,300,38,456,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1076978454362880958,COMMIT PREPARED '131077_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAAaTE=_AAAAAAAAAAAAAP//fwAAAQAAsClpVEi0AAAAkgAAAAAAAAAA',0,0,0,0,0,0,1,65.757762,65.757762,65.757762,65.757762,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,42,0,0,0,0,0,0,0,0
10,16385,f,-4745144622887465123,SELECT COUNT(*) FROM public.view_application_action_event_page_annual_summary,0,0,0,0,0,0,1,27.774646,27.774646,27.774646,27.774646,0,1,3,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5421017805428094009,COPY  ( SELECT * FROM public.document_proposal_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,36.31672,36.31672,36.31672,36.31672,0,300,43,2726,0,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1047683920274307472,"COPY  ( SELECT iso_2code AS value, COUNT ( * ) AS count FROM country_element WHERE iso_2code IS NOT NULL GROUP BY iso_2code ORDER BY count DESC, iso_2code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.353731,0.353731,0.353731,0.353731,0,211,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9099451611194349596,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.333196,7.333196,7.333196,7.333196,0,500,0,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2464903312534441906,SELECT CASE WHEN EXISTS (SELECT $1 FROM view_party_effectiveness_trends LIMIT $2) THEN $3 ELSE $4 END,0,0,0,0,0,0,1,28.266525,28.266525,28.266525,28.266525,0,1,2611,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3407103995560819641,"COPY  ( SELECT parties AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE parties IS NOT NULL GROUP BY parties ORDER BY count DESC, parties LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,596.649001,596.649001,596.649001,596.649001,0,183,0,675,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6613199166084037014,"COPY  ( SELECT party_short_code AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE party_short_code IS NOT NULL GROUP BY party_short_code ORDER BY count DESC, party_short_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,33.605062,33.605062,33.605062,33.605062,0,16,78,3579,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5516199160651666023,"COPY  ( SELECT process AS value, COUNT ( * ) AS count FROM document_activity_data WHERE process IS NOT NULL GROUP BY process ORDER BY count DESC, process LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,40.795943,40.795943,40.795943,40.795943,0,6,112,4888,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2496476059890724629,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_ballot_decision_politician_summary,0,0,0,0,0,0,1,101692.609726,101692.609726,101692.609726,101692.609726,0,1578178,193356,231943,91794,181509,0,0,0,0,141137,143416,0,0,0,0,1579905,1422,776045220,0,0,0,0,0,0,0,0
10,16385,f,1444683404438561527,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_weekly,0,0,0,0,0,0,1,51.047106,51.047106,51.047106,51.047106,0,670,3415,210,17,17,0,0,0,0,0,0,0,0,0,0,898,8,173903,0,0,0,0,0,0,0,0
10,16385,f,1684364791864405861,SELECT COUNT(*) FROM public.view_riksdagen_committee_parliament_member_proposal,0,0,0,0,0,0,1,464.477378,464.477378,464.477378,464.477378,0,1,10216,14352,0,0,0,0,0,0,4183,4198,0,0,0,0,0,0,0,39,3.906668,0,0,1,0.943001,1,21.444111
10,16385,f,-5489678730941963521,"COPY  ( SELECT person_person_container_data_0 AS value, COUNT ( * ) AS count FROM person_container_data WHERE person_person_container_data_0 IS NOT NULL GROUP BY person_person_container_data_0 ORDER BY count DESC, person_person_container_data_0 LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.015597999999999999,0.015597999999999999,0.015597999999999999,0.015597999999999999,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2954304978905839758,SELECT COUNT(*) FROM public.view_application_action_event_page_weekly_summary,0,0,0,0,0,0,1,0.137046,0.137046,0.137046,0.137046,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5567756162003004796,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_activity_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,39.57798,39.57798,39.57798,39.57798,0,2,215,4793,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-924627702581251993,SELECT COUNT(*) FROM public.view_riksdagen_goverment_proposals,0,0,0,0,0,0,1,44.200725000000006,44.200725000000006,44.200725000000006,44.200725000000006,0,1,0,3729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2108515666852389996,"WITH table_counts AS (
    SELECT t.schemaname,
           t.tablename,
           COALESCE(c.reltuples, $1)::BIGINT AS row_count
    FROM pg_tables t
    JOIN pg_class c ON c.relname = t.tablename
    JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
    WHERE t.schemaname = $2
),
table_extract AS (
    SELECT schemaname,
           tablename,
           row_count,
           -- Smart sample size calculation:
           -- 1. Complete extraction for small tables (< threshold)
           -- 2. Extended samples for party/committee/person data
           -- 3. Extended samples for document/voting/worldbank data
           -- 4. Default sample size for others
           CASE 
               -- Complete extraction for small tables
               WHEN row_count <= $3::int THEN row_count
               -- Extended samples for party-related tables
               WHEN tablename ILIKE $4 OR tablename ILIKE $5 THEN 
                   LEAST($6::int, row_count)
               -- Extended samples for committee-related tables
               WHEN tablename ILIKE $7 OR tablename ILIKE $8 THEN 
                   LEAST($9::int, row_count)
               -- Extended samples for person/politician data
               WHEN tablename ILIKE $10 OR tablename ILIKE $11 
                   OR tablename ILIKE $12 THEN 
                   LEAST($13::int, row_count)
               -- Extended samples for document-related tables
               WHEN tablename ILIKE $14 OR tablename ILIKE $15 THEN 
                   LEAST($16::int, row_count)
               -- Extended samples for voting-related tables
               WHEN tablename ILIKE $17 OR tablename ILIKE $18 THEN 
                   LEAST($19::int, row_count)
               -- Extended samples for worldbank data
               WHEN tablename ILIKE $20 OR tablename ILIKE $21 
                   OR tablename ILIKE $22 THEN 
                   LEAST($23::int, row_count)
               -- Default sample size
               ELSE LEAST($24::int, row_count)
           END AS sample_rows,
           -- Extraction type for logging
           CASE 
               WHEN row_count <= $25::int THEN $26
               WHEN tablename ILIKE $27 OR tablename ILIKE $28 THEN $29
               WHEN tablename ILIKE $30 OR tablename ILIKE $31 THEN $32
               WHEN tablename ILIKE $33 OR tablename ILIKE $34 
                   OR tablename ILIKE $35 THEN $36
               WHEN tablename ILIKE $37 OR tablename ILIKE $38 THEN $39
               WHEN tablename ILIKE $40 OR tablename ILIKE $41 THEN $42
               WHEN tablename ILIKE $43 OR tablename ILIKE $44 
                   OR tablename ILIKE $45 THEN $46
               ELSE $47
           END AS extraction_type,
           CASE WHEN tablename LIKE $48 THEN tablename ELSE $49 || tablename END AS file_prefix
    FROM table_counts
    WHERE row_count > $50
)
SELECT format(
    $51 || $52 ||
    $53 || $54 ||
    $55 || $56,
    extraction_type,
    schemaname,
    tablename,
    sample_rows,
    row_count,
    schemaname,
    tablename,
    sample_rows,
    file_prefix,
    file_prefix
)
FROM table_extract
ORDER BY tablename",0,0,0,0,0,0,1,0.9803209999999999,0.9803209999999999,0.9803209999999999,0.9803209999999999,0,53,605,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6102316690908489716,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC, document_document_status_con_0 LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.986156,55.986156,55.986156,55.986156,0,1000,3,1083,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2089709053049058085,COPY  ( SELECT * FROM public.country_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.36087400000000003,0.36087400000000003,0.36087400000000003,0.36087400000000003,0,211,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6059086602432228220,"COPY  ( SELECT ballot_summary_item AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE ballot_summary_item IS NOT NULL GROUP BY ballot_summary_item ORDER BY count DESC, ballot_summary_item LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,37.158131,37.158131,37.158131,37.158131,0,1000,2837,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3410845155738429121,"SELECT network_median, MIN(network_connections) as min_conn, MAX(network_connections) as max_conn, AVG(network_connections)::int as avg_conn, PERCENTILE_CONT($1) WITHIN GROUP (ORDER BY network_connections) as p25, PERCENTILE_CONT($2) WITHIN GROUP (ORDER BY network_connections) as p75 FROM view_riksdagen_politician_influence_metrics GROUP BY network_median",0,0,0,0,0,0,1,33020.553460999996,33020.553460999996,33020.553460999996,33020.553460999996,0,1,30575,72506,0,0,0,0,0,0,767749,769093,0,0,0,0,0,0,0,68,3.287918,0,0,1,1.378725,1,34.374288
10,16385,t,1004451002173004959,"SELECT pg_catalog.format_type($1::pg_catalog.oid, $2)",0,0,0,0,0,0,3,0.00601,0.001502,0.002454,0.0020033333333333335,0.00039030016938533627,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8199568919000454095,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005,0.005,0.005,0.005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
