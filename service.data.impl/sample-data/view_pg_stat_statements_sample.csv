userid,dbid,toplevel,queryid,query,plans,total_plan_time,min_plan_time,max_plan_time,mean_plan_time,stddev_plan_time,calls,total_exec_time,min_exec_time,max_exec_time,mean_exec_time,stddev_exec_time,rows,shared_blks_hit,shared_blks_read,shared_blks_dirtied,shared_blks_written,local_blks_hit,local_blks_read,local_blks_dirtied,local_blks_written,temp_blks_read,temp_blks_written,blk_read_time,blk_write_time,temp_blk_read_time,temp_blk_write_time,wal_records,wal_fpi,wal_bytes,jit_functions,jit_generation_time,jit_inlining_count,jit_inlining_time,jit_optimization_count,jit_optimization_time,jit_emission_count,jit_emission_time
10,16385,f,7378833678927389502,SELECT COUNT(*) FROM public.detail_data child LEFT JOIN public.person_detail_data parent ON child.detail_list_person_detail_da_0 = parent.hjid WHERE child.detail_list_person_detail_da_0 IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,12.251824,12.251824,12.251824,12.251824,0,1,1,566,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5220720815737010668,SELECT COUNT(*) FROM public.qrtz_simple_triggers child LEFT JOIN public.qrtz_triggers parent ON child.trigger_group = parent.trigger_group WHERE child.trigger_group IS NOT NULL AND parent.trigger_group IS NULL,0,0,0,0,0,0,1,0.004138,0.004138,0.004138,0.004138,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2873038590247904193,REFRESH MATERIALIZED VIEW view_riksdagen_vote_data_ballot_politician_summary_monthly,0,0,0,0,0,0,1,2248.121838,2248.121838,2248.121838,2248.121838,0,74881,15120,20933,3017,3970,0,0,0,0,13595,13619,0,0,0,0,75341,153,26920596,0,0,0,0,0,0,0,0
10,16385,f,7114804826197491058,SELECT COUNT(*) FROM public.view_risk_score_evolution LIMIT $1,0,0,0,0,0,0,1,0.5884790000000001,0.5884790000000001,0.5884790000000001,0.5884790000000001,0,1,315,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7800106406085720218,SELECT COUNT(*) FROM public.qrtz_triggers child LEFT JOIN public.qrtz_job_details parent ON child.sched_name = parent.job_group WHERE child.sched_name IS NOT NULL AND parent.job_group IS NULL,0,0,0,0,0,0,1,0.034554,0.034554,0.034554,0.034554,0,1,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1743048949564542433,SELECT COUNT(*) FROM public.assignment_element,0,0,0,0,0,0,2,0.009488,0.004478,0.0050100000000000006,0.004744,0.00026599999999999996,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5198113118429188945,SELECT COUNT(*) FROM public.portal child LEFT JOIN public.agency parent ON child.portals_agency_hjid = parent.hjid WHERE child.portals_agency_hjid IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,3.030142,3.030142,3.030142,3.030142,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2615053563646155745,SELECT COUNT(*) FROM public.against_proposal_data child LEFT JOIN public.against_proposal_container parent ON child.against_proposal_list_agains_0 = parent.hjid WHERE child.against_proposal_list_agains_0 IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,21.769202,21.769202,21.769202,21.769202,0,1,2,624,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-137668195526350440,COPY (SELECT * FROM public.sweden_municipality_data ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_sweden_municipality_data_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,0.0041470000000000005,0.0041470000000000005,0.0041470000000000005,0.0041470000000000005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3345668446938292953,SELECT COUNT(*) FROM public.view_riksdagen_committee_parliament_member_proposal,0,0,0,0,0,0,3,643.394839,211.862573,218.62498,214.46494633333333,2.9723465919418297,3,16554,0,0,0,0,0,0,0,2028,2034,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1893915560020180559,SELECT COUNT(*) FROM public.person_element,0,0,0,0,0,0,2,0.007373000000000001,0.0028150000000000002,0.004558,0.0036865000000000005,0.0008715000000000002,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1809349874619169723,SELECT COUNT(*) FROM public.world_bank_data,0,0,0,0,0,0,2,228.537825,31.646434,196.891391,114.2689125,82.6224785,2,0,20430,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4646091248205268584,COPY (SELECT * FROM public.person_container_data ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_person_container_data_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,0.008045,0.008045,0.008045,0.008045,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8602640411836812453,SELECT COUNT(*) FROM public.view_riksdagen_vote_data_ballot_politician_summary,0,0,0,0,0,0,2,295.647699,117.963415,177.684284,147.8238495,29.860434499999997,2,225,5960,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7270529598951558748,SELECT COUNT(*) FROM public.qrtz_simple_triggers child LEFT JOIN public.qrtz_triggers parent ON child.trigger_name = parent.trigger_group WHERE child.trigger_name IS NOT NULL AND parent.trigger_group IS NULL,0,0,0,0,0,0,1,0.003987999999999999,0.003987999999999999,0.003987999999999999,0.003987999999999999,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3253083052894592554,SELECT COUNT(*) FROM public.pg_stat_statements_info,0,0,0,0,0,0,3,0.019775,0.003726,0.010920000000000001,0.0065916666666666675,0.0031137281334260524,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2465516527854348124,SELECT COUNT(*) FROM public.qrtz_cron_triggers child LEFT JOIN public.qrtz_triggers parent ON child.trigger_name = parent.trigger_name WHERE child.trigger_name IS NOT NULL AND parent.trigger_name IS NULL,0,0,0,0,0,0,1,0.056506,0.056506,0.056506,0.056506,0,1,26,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4593734634050593492,REFRESH MATERIALIZED VIEW view_riksdagen_vote_data_ballot_summary,0,0,0,0,0,0,1,83545.738607,83545.738607,83545.738607,83545.738607,0,10118,3240,178329,249,258,0,0,0,0,86720,86842,0,0,0,0,10481,126,3090889,0,0,0,0,0,0,0,0
10,16385,f,-5894348268534974440,SELECT COUNT(*) FROM public.view_politician_risk_summary,0,0,0,0,0,0,3,72.614687,22.543555,27.463388,24.204895666666665,2.304251038367178,3,948,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,114,5.529346,0,0,3,2.6000680000000003,3,66.650722
16384,16385,t,4657953789397675476,"SELECT * FROM public.databasechangelog ORDER BY DATEEXECUTED ASC, ORDEREXECUTED ASC",0,0,0,0,0,0,2,1.242251,0.528919,0.713332,0.6211255,0.09220649999999997,760,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4413869161178316406,select commit_id from jv_commit where $1<$2,0,0,0,0,0,0,1,0.001061,0.001061,0.001061,0.001061,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1327958826994308836,COPY (SELECT * FROM public.sweden_county_electoral_regi_1 ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_sweden_county_electoral_regi_1_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,0.003817,0.003817,0.003817,0.003817,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5754458802830619748,SELECT COUNT(*) FROM public.document_status_container child LEFT JOIN public.document_person_reference_co_0 parent ON child.document_person_reference_co_1 = parent.hjid WHERE child.document_person_reference_co_1 IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,12.635911,12.635911,12.635911,12.635911,0,1,913,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1793349962363156949,COPY (SELECT * FROM public.document_attachment ORDER BY random() LIMIT 50) TO '/tmp/service.data.impl/sample-data/table_document_attachment_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,24.029631,24.029631,24.029631,24.029631,0,50,23,1526,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7652294891628938372,COPY (SELECT * FROM public.document_status_container ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_document_status_container_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,13.059503,13.059503,13.059503,13.059503,0,50,0,658,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9052388314580198222,REFRESH MATERIALIZED VIEW view_riksdagen_vote_data_ballot_party_summary_monthly,0,0,0,0,0,0,1,86.68557,86.68557,86.68557,86.68557,0,1741,1985,71,53,67,0,0,0,0,43,112,0,0,0,0,2015,10,502987,0,0,0,0,0,0,0,0
10,16385,f,-2112847474557707406,SELECT COUNT(*) FROM public.view_riksdagen_politician_document_summary,0,0,0,0,0,0,2,0.13975900000000002,0.067655,0.072104,0.06987950000000001,0.0022245000000000008,2,90,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8111393788935606760,SELECT COUNT(*) FROM public.countries_element,0,0,0,0,0,0,2,0.010509000000000001,0.004057000000000001,0.006452,0.0052545000000000005,0.0011974999999999998,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3982217310012896494,SELECT COUNT(*) FROM public.view_riksdagen_politician_experience_summary LIMIT $1,0,0,0,0,0,0,1,129.31719999999999,129.31719999999999,129.31719999999999,129.31719999999999,0,1,809,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1592135237743838615,COPY (SELECT * FROM public.target_profile_content ORDER BY random() LIMIT 50) TO '/tmp/service.data.impl/sample-data/table_target_profile_content_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,0.133199,0.133199,0.133199,0.133199,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7361927649484143699,"SELECT 
    pg_size_pretty(pg_database_size(current_database())) AS database_size,
    (SELECT COUNT(*) FROM pg_stat_user_tables WHERE schemaname = $1) AS table_count,
    (SELECT COUNT(*) FROM pg_views WHERE schemaname = $2) AS view_count,
    (SELECT COUNT(*) FROM pg_matviews WHERE schemaname = $3) AS materialized_view_count,
    (SELECT SUM(n_live_tup) FROM pg_stat_user_tables WHERE schemaname = $4) AS total_rows",0,0,0,0,0,0,1,4.988692,4.988692,4.988692,4.988692,0,1,445,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-672258026398889954,SELECT COUNT(*) FROM public.jv_snapshot child LEFT JOIN public.jv_commit parent ON child.commit_fk = parent.commit_pk WHERE child.commit_fk IS NOT NULL AND parent.commit_pk IS NULL,0,0,0,0,0,0,1,8734.417673,8734.417673,8734.417673,8734.417673,0,1,668592,342002,0,0,0,0,0,0,51294,51508,0,0,0,0,0,0,0,10,0.275184,1,44.672835,1,9.645703,1,8.510862
10,16385,f,-7619556669694772075,SELECT COUNT(*) FROM public.committee_proposal_data,0,0,0,0,0,0,3,37.577617000000004,7.665314,21.809803,12.525872333333334,6.567156125612482,3,2650,5300,0,1963,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2403440320727437577,SELECT COUNT(*) FROM public.jv_global_id child LEFT JOIN public.jv_global_id parent ON child.owner_id_fk = parent.global_id_pk WHERE child.owner_id_fk IS NOT NULL AND parent.global_id_pk IS NULL,0,0,0,0,0,0,1,22816.711762,22816.711762,22816.711762,22816.711762,0,1,308201,168569,0,0,0,0,0,0,51468,51768,0,0,0,0,0,0,0,10,0.292729,0,0,1,0.1877,1,2.453073
10,16385,f,3065953479645288419,SELECT * FROM view_riksdagen_vote_data_ballot_politician_summary_daily LIMIT $1,0,0,0,0,0,0,1,0.013146,0.013146,0.013146,0.013146,0,5,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-1068858405594993427,"UPDATE public.databasechangeloglock SET LOCKED = $1, LOCKEDBY = $2, LOCKGRANTED = NOW() WHERE ID = $3 AND LOCKED = $4",0,0,0,0,0,0,1,0.039644,0.039644,0.039644,0.039644,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,545,0,0,0,0,0,0,0,0
10,16385,t,1490862907230434892,"DO $$
DECLARE
    v_table TEXT;
    v_count BIGINT;
    v_critical_tables TEXT[] := ARRAY[
        'person_data',
        'assignment_data',
        'ballot_data',
        'vote_data',
        'document_data',
        'sweden_political_party',
        'committee_proposal_data',
        'document_element',
        'document_person_reference_data'
    ];
BEGIN
    FOREACH v_table IN ARRAY v_critical_tables
    LOOP
        BEGIN
            EXECUTE format('SELECT COUNT(*) FROM %I', v_table) INTO v_count;
            
            IF v_count = 0 THEN
                INSERT INTO health_check_results VALUES (
                    'Data Quality',
                    'Critical Table: ' || v_table,
                    'FAIL',
                    4,
                    'Table is empty (0 rows)',
                    'Load data into table or check data import processes. See TROUBLESHOOTING_EMPTY_VIEWS.md'
                );
            ELSIF v_count < 100 THEN
                INSERT INTO health_check_results VALUES (
                    'Data Quality',
                    'Critical Table: ' || v_table,
                    'WARN',
                    2,
                    'Table has only ' || v_count || ' rows',
                    'Verify data completeness and import status'
                );
            ELSE
                INSERT INTO health_check_results VALUES (
                    'Data Quality',
                    'Critical Table: ' || v_table,
                    'PASS',
                    1,
                    'Table has ' || v_count || ' rows',
                    NULL
                );
            END IF;
        EXCEPTION WHEN OTHERS THEN
            INSERT INTO health_check_results VALUES (
                'Data Quality',
                'Critical Table: ' || v_table,
                'INFO',
                1,
                'Table does not exist or cannot be accessed: ' || SQLERRM,
                'Verify table name and permissions'
            );
        END;
    END LOOP;
END $$",0,0,0,0,0,0,1,1060.188248,1060.188248,1060.188248,1060.188248,0,0,145037,33046,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2581191670018567981,SELECT COUNT(*) FROM public.view_application_action_event_page_element_weekly_summary LIMIT $1,0,0,0,0,0,0,1,0.169236,0.169236,0.169236,0.169236,0,1,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-507225500057516508,COPY (SELECT * FROM public.world_bank_data ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_world_bank_data_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,238.245612,238.245612,238.245612,238.245612,0,50,0,10215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5222745275007569262,SELECT COUNT(*) FROM public.sweden_county_electoral_area child LEFT JOIN public.sweden_county_electoral_regi_1 parent ON child.landstingsvalkrets_sweden_co_0 = parent.hjid WHERE child.landstingsvalkrets_sweden_co_0 IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,0.009278,0.009278,0.009278,0.009278,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,2470514466340265250,"DO $$
        DECLARE
            v_vote_count BIGINT;
            v_person_count INTEGER;
            v_document_count INTEGER;
        BEGIN
            SELECT COUNT(*) INTO v_vote_count FROM vote_data;
            SELECT COUNT(*) INTO v_person_count FROM person_data;
            SELECT COUNT(*) INTO v_document_count FROM document_data;
            
            RAISE NOTICE 'Pre-flight: vote_data=%, person_data=%, document_data=%', 
                v_vote_count, v_person_count, v_document_count;
                
            IF v_vote_count < 1000 THEN
                RAISE WARNING 'Limited vote data - politician views may be sparse';
            END IF;
        END $$",0,0,0,0,0,0,1,7894.222924,7894.222924,7894.222924,7894.222924,0,0,6372,9493,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,t,-4590939273026221284,SELECT MAX(ORDEREXECUTED) FROM public.databasechangelog,0,0,0,0,0,0,1,0.057848,0.057848,0.057848,0.057848,0,1,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6494996850470410184,SELECT COUNT(*) FROM public.qrtz_simple_triggers child LEFT JOIN public.qrtz_triggers parent ON child.trigger_name = parent.trigger_name WHERE child.trigger_name IS NOT NULL AND parent.trigger_name IS NULL,0,0,0,0,0,0,1,0.003998,0.003998,0.003998,0.003998,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6459971082938617115,SELECT COUNT(*) FROM public.application_view,0,0,0,0,0,0,2,0.019236,0.004629,0.014606999999999998,0.009618,0.0049889999999999995,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2796630933708883656,SELECT COUNT(*) FROM public.detail_element,0,0,0,0,0,0,2,0.011561,0.005029,0.0065320000000000005,0.0057805,0.0007515000000000004,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8025256661819257358,SELECT COUNT(*) FROM public.language_data,0,0,0,0,0,0,2,0.136887,0.057227,0.07966000000000001,0.0684435,0.011216500000000004,2,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4077870557015655163,SELECT COUNT(*) FROM public.view_riksdagen_party_document_daily_summary,0,0,0,0,0,0,2,91.54251400000001,0.332842,91.20967200000001,45.771257000000006,45.438415000000006,2,0,102,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7164030026146320949,REFRESH MATERIALIZED VIEW view_riksdagen_politician_document,0,0,0,0,0,0,1,3693.820051,3693.820051,3693.820051,3693.820051,0,110684,28775,3600,3133,4228,0,0,0,0,2166,2154,0,0,0,0,111619,684,32877725,0,0,0,0,0,0,0,0
10,16385,f,2653161908494979458,SELECT COUNT(*) FROM public.assignment_data child LEFT JOIN public.person_assignment_data parent ON child.assignment_list_person_assig_0 = parent.hjid WHERE child.assignment_list_person_assig_0 IS NOT NULL AND parent.hjid IS NULL,0,0,0,0,0,0,1,6.510816,6.510816,6.510816,6.510816,0,1,495,48,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7832858577965349251,COPY (SELECT * FROM public.detail_data ORDER BY random() LIMIT $1) TO '/tmp/service.data.impl/sample-data/table_detail_data_sample.csv' WITH CSV HEADER,0,0,0,0,0,0,1,6.487212,6.487212,6.487212,6.487212,0,50,0,515,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
