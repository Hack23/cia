userid,dbid,toplevel,queryid,query,plans,total_plan_time,min_plan_time,max_plan_time,mean_plan_time,stddev_plan_time,calls,total_exec_time,min_exec_time,max_exec_time,mean_exec_time,stddev_exec_time,rows,shared_blks_hit,shared_blks_read,shared_blks_dirtied,shared_blks_written,local_blks_hit,local_blks_read,local_blks_dirtied,local_blks_written,temp_blks_read,temp_blks_written,blk_read_time,blk_write_time,temp_blk_read_time,temp_blk_write_time,wal_records,wal_fpi,wal_bytes,jit_functions,jit_generation_time,jit_inlining_count,jit_inlining_time,jit_optimization_count,jit_optimization_time,jit_emission_count,jit_emission_time
10,16385,t,861678720142994723,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_monthly ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,95.332258,95.332258,95.332258,95.332258,0,500,3262,3813,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5936071457002342624,"COPY  ( SELECT assignment_type AS value, COUNT ( * ) AS count FROM assignment_element WHERE assignment_type IS NOT NULL GROUP BY assignment_type ORDER BY count DESC, assignment_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.006873,0.006873,0.006873,0.006873,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-754748554664061564,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_daily LIMIT $2),0,0,0,0,0,0,1,0.003787,0.003787,0.003787,0.003787,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2898426421997579755,COPY  ( SELECT * FROM public.document_reference_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,49.714924,49.714924,49.714924,49.714924,0,300,32,3297,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1782096248570751468,COPY  ( SELECT * FROM public.view_riksdagen_politician_document_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,12.411541999999999,12.411541999999999,12.411541999999999,12.411541999999999,0,500,0,448,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6117209581952584091,ANALYZE public.view_riksdagen_politician_document_summary,0,0,0,0,0,0,1,10.867553,10.867553,10.867553,10.867553,0,0,3098,327,8,3,0,0,0,0,0,0,0,0,0,0,62,5,66153,0,0,0,0,0,0,0,0
10,16385,t,-6613199166084037014,"COPY  ( SELECT party_short_code AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE party_short_code IS NOT NULL GROUP BY party_short_code ORDER BY count DESC, party_short_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,87.134473,87.134473,87.134473,87.134473,0,16,78,3584,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8159804249260329490,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8, $9, $10, $11]) AS col
WHERE EXISTS (SELECT $12 FROM information_schema.columns WHERE table_schema = $13 AND table_name = $14 AND column_name = col)",0,0,0,0,0,0,1,0.304007,0.304007,0.304007,0.304007,0,7,524,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,378134943487131039,ANALYZE public.view_riksdagen_vote_data_ballot_summary_weekly,0,0,0,0,0,0,1,5.819871,5.819871,5.819871,5.819871,0,0,3258,172,8,3,0,0,0,0,0,0,0,0,0,0,60,5,64953,0,0,0,0,0,0,0,0
10,16385,f,5298063717301432534,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_ministry_effectiveness_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,52.371556999999996,52.371556999999996,52.371556999999996,52.371556999999996,0,11,22791,3828,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6060818508544843944,COPY  ( SELECT * FROM public.document_detail_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,210.580252,210.580252,210.580252,210.580252,0,300,34,395,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7854930087438427863,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_start ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_start ) ORDER BY random ( ) ) AS rn FROM public.view_party_effectiveness_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,119.887111,119.887111,119.887111,119.887111,0,12,2,5311,0,0,0,0,0,0,384,385,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4146625008955279614,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_annual ORDER BY random ( ) LIMIT 24 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,5.608916,5.608916,5.608916,5.608916,0,24,765,102,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4591699421909560982,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8, $9]) AS col
WHERE EXISTS (SELECT $10 FROM information_schema.columns WHERE table_schema = $11 AND table_name = $12 AND column_name = col)",0,0,0,0,0,0,1,0.721044,0.721044,0.721044,0.721044,0,5,315,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2761361339680794055,SELECT COUNT(*) FROM public.view_riksdagen_party_member,0,0,0,0,0,0,1,1.950648,1.950648,1.950648,1.950648,0,1,0,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5530595455947026008,COPY  ( SELECT * FROM public.qrtz_triggers ORDER BY random ( ) LIMIT 4 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,20.94832,20.94832,20.94832,20.94832,0,4,336,147,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2414631255823080777,"COPY  ( SELECT processed_in AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE processed_in IS NOT NULL GROUP BY processed_in ORDER BY count DESC, processed_in LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,19.711853,19.711853,19.711853,19.711853,0,1000,2728,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6518599406465570533,"DO $$
DECLARE
    view_record RECORD;
    view_count INTEGER := 0;
    file_name TEXT;
    explain_query TEXT;
BEGIN
    RAISE NOTICE 'Generating individual query plan files...';
    RAISE NOTICE '';
    
    FOR view_record IN 
        SELECT schemaname, viewname AS object_name, 'VIEW' AS object_type
        FROM pg_views
        WHERE schemaname = 'public'
        UNION ALL
        SELECT schemaname, matviewname AS object_name, 'MATERIALIZED VIEW' AS object_type
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY object_name
    LOOP
        BEGIN
            view_count := view_count + 1;
            file_name := '/workspaces/cia/service.data.impl/sample-data/view_plans/explain_' || view_record.object_name || '.txt';
            
            RAISE NOTICE '[%] %.%', view_count, view_record.schemaname, view_record.object_name;
            
            -- Execute EXPLAIN and write to file using psql \o command
            explain_query := 'EXPLAIN (ANALYZE, BUFFERS, VERBOSE, FORMAT TEXT) SELECT * FROM ' || 
                            quote_ident(view_record.schemaname) || '.' || 
                            quote_ident(view_record.object_name) || ' LIMIT 1';
            
            -- This approach won't work in DO block, skip EXPLAIN generation
            RAISE NOTICE '  ℹ️  Skipping EXPLAIN (requires psql \\o command)';
            
        EXCEPTION WHEN OTHERS THEN
            RAISE NOTICE '  ✗ ERROR: %', SQLERRM;
        END;
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE '  Note: EXPLAIN plans require manual execution with psql \\o command';
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,3.277039,3.277039,3.277039,3.277039,0,0,703,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-145869035557017714,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'year' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 28 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.704694,0.704694,0.704694,0.704694,0,4,26,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8926741491515786640,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_annual ORDER BY random ( ) LIMIT 201 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,44.870421,44.870421,44.870421,44.870421,0,201,2068,455,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4119183328756396908,COPY  ( SELECT * FROM public.application_session ORDER BY random ( ) LIMIT 18 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,17.386291,17.386291,17.386291,17.386291,0,18,102,22,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8740800287404131890,"SELECT schemaname, matviewname
            FROM pg_matviews
            WHERE schemaname = $1
            ORDER BY matviewname",0,0,0,0,0,0,4,3.144729,0.615068,1.081156,0.78618225,0.18438677555396293,112,1178,170,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5949357486154155233,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_annual ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,23.622875,23.622875,23.622875,23.622875,0,201,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5813578205475048036,COPY  ( SELECT * FROM public.view_riksdagen_party_ballot_support_annual_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,4393.13849,4393.13849,4393.13849,4393.13849,0,500,352463,3044,0,0,0,0,0,0,2112,2123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8847338302768701162,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,25.345848,25.345848,25.345848,25.345848,0,76,3740,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6710730610544008613,COPY  ( SELECT * FROM public.application_configuration ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.079939,0.079939,0.079939,0.079939,0,14,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3734896786789908294,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_activity_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,38.735772000000004,38.735772000000004,38.735772000000004,38.735772000000004,0,2,208,4800,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5248246366361300927,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $1 ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.21847699999999998,0.21847699999999998,0.21847699999999998,0.21847699999999998,0,4,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4797549991959959391,REFRESH MATERIALIZED VIEW public.view_riksdagen_document_type_daily_summary,0,0,0,0,0,0,2,22715.636491,185.547605,22530.088886,11357.8182455,11172.2706405,65156,4436,71674,1303,1326,0,0,0,0,0,0,0,0,0,0,65483,16,5492914,0,0,0,0,0,0,0,0
10,16385,t,-1142797377447150349,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '30 days' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 73 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1062.915395,1062.915395,1062.915395,1062.915395,0,4,37,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8001273667366129500,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM document_activity_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2656.137888,2656.137888,2656.137888,2656.137888,0,33,56,4997,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4094998492146269647,COPY  ( SELECT * FROM public.committee_document_data ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,7.199112,7.199112,7.199112,7.199112,0,500,64,314,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4851728793435663200,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5]) AS col
WHERE EXISTS (SELECT $6 FROM information_schema.columns WHERE table_schema = $7 AND table_name = $8 AND column_name = col)",0,0,0,0,0,0,1,1.420229,1.420229,1.420229,1.420229,0,1,23,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8917112057706856151,"COPY  ( SELECT country_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE country_value IS NOT NULL GROUP BY country_value ORDER BY count DESC, country_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,54.782513,54.782513,54.782513,54.782513,0,6,54,10351,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6869552047163727147,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary_daily,0,0,0,0,0,0,1,848.584846,848.584846,848.584846,848.584846,0,0,7763,23156,21,9,0,0,0,0,0,0,0,0,0,0,169,12,159193,0,0,0,0,0,0,0,0
10,16385,f,-576670575671902707,COPY  ( SELECT * FROM public.document_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,461.334886,461.334886,461.334886,461.334886,0,300,27,35826,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6348816182703925285,SELECT COUNT(*) FROM public.view_decision_temporal_trends,0,0,0,0,0,0,1,355.498967,355.498967,355.498967,355.498967,0,1,295841,8105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5968163276858086128,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_element WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0038970000000000003,0.0038970000000000003,0.0038970000000000003,0.0038970000000000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5970120050215269194,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_data WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.6355850000000001,0.6355850000000001,0.6355850000000001,0.6355850000000001,0,63,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7890668842115706593,"COPY  ( SELECT database_source AS value, COUNT ( * ) AS count FROM document_element WHERE database_source IS NOT NULL GROUP BY database_source ORDER BY count DESC, database_source LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,59.711673,59.711673,59.711673,59.711673,0,5,615,35220,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3152865185996954054,"COPY  ( SELECT born_year AS value, COUNT ( * ) AS count FROM person_element WHERE born_year IS NOT NULL GROUP BY born_year ORDER BY count DESC, born_year LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.005901,0.005901,0.005901,0.005901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7723160828937076576,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary LIMIT $2),0,0,0,0,0,0,1,0.010149,0.010149,0.010149,0.010149,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8120855969446078482,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.21993,0.21993,0.21993,0.21993,0,4,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8550563833149535129,COPY  ( SELECT * FROM public.document_detail_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,208.05863499999998,208.05863499999998,208.05863499999998,208.05863499999998,0,300,0,390,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5373081623865433604,COPY  ( SELECT * FROM public.qrtz_job_details ORDER BY random ( ) LIMIT 4 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.367125,0.367125,0.367125,0.367125,0,4,65,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1391139709313032959,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM vote_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,347.239773,347.239773,347.239773,347.239773,0,24,114,87234,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6145455670024909418,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary_weekly,0,0,0,0,0,0,1,718.732976,718.732976,718.732976,718.732976,0,0,7571,9558,20,9,0,0,0,0,0,0,0,0,0,0,160,11,158911,0,0,0,0,0,0,0,0
10,16385,f,2965506937284717497,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , assessment_period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , assessment_period_end ) ORDER BY random ( ) ) AS rn FROM public.view_risk_score_evolution ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1215.525001,1215.525001,1215.525001,1215.525001,0,26,11005,24793,0,0,0,0,0,0,5910,5927,0,0,0,0,0,0,0,127,6.275546,0,0,1,2.728377,1,68.003769
10,16385,f,5738819726774227376,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_decision_type_org_summary LIMIT $2),0,0,0,0,0,0,1,0.004378,0.004378,0.004378,0.004378,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1025844612692719348,SELECT COUNT(*) FROM public.view_riksdagen_politician_ballot_summary,0,0,0,0,0,0,1,3.042553,3.042553,3.042553,3.042553,0,1,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5963933463454577571,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_politician_document_summary LIMIT $2),0,0,0,0,0,0,1,0.0057799999999999995,0.0057799999999999995,0.0057799999999999995,0.0057799999999999995,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-16034182130646267,"COPY  ( SELECT domain_org AS value, COUNT ( * ) AS count FROM document_element WHERE domain_org IS NOT NULL GROUP BY domain_org ORDER BY count DESC, domain_org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.131684,57.131684,57.131684,57.131684,0,1,998,34834,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-9025402556122639014,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.318774,0.318774,0.318774,0.318774,0,0,33,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7844532379763956202,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_element WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.131812,57.131812,57.131812,57.131812,0,98,420,35412,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8822555078304745203,"SELECT COUNT(*)                      FROM (
        SELECT viewname FROM pg_views 
        WHERE schemaname = $1 
          AND viewname != $2
        UNION ALL
        SELECT matviewname FROM pg_matviews 
        WHERE schemaname = $3
    ) v",0,0,0,0,0,0,1,1.346962,1.346962,1.346962,1.346962,0,1,684,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,512984412289296961,SELECT COUNT(*) FROM public.view_riksdagen_member_proposals,0,0,0,0,0,0,1,58.579831999999996,58.579831999999996,58.579831999999996,58.579831999999996,0,1,6,35816,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5421017805428094009,COPY  ( SELECT * FROM public.document_proposal_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,34.696122,34.696122,34.696122,34.696122,0,300,42,2731,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-517729068261176142,COPY  ( SELECT * FROM public.qrtz_triggers ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,5.479147,5.479147,5.479147,5.479147,0,4,0,63,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3897347670447756584,COPY  ( SELECT * FROM public.view_riksdagen_org_document_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,19.584336,19.584336,19.584336,19.584336,0,300,0,512,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,9028530376830418096,COPY  ( SELECT * FROM public.topics ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,49.992478,49.992478,49.992478,49.992478,0,200,0,111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8050999717778120741,"COPY  ( SELECT against_proposal_parties AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE against_proposal_parties IS NOT NULL GROUP BY against_proposal_parties ORDER BY count DESC, against_proposal_parties LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,14.648612,14.648612,14.648612,14.648612,0,205,2838,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-448624641361605857,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_weekly,0,0,0,0,0,0,2,11851.993195,5834.796943,6017.196252,5925.9965975,91.1996544999995,468504,65945,83916,18127,32262,0,0,0,0,31751,31799,0,0,0,0,472331,3163,179592287,0,0,0,0,0,0,0,0
10,16385,f,2671739184911010757,ANALYZE public.view_riksdagen_committee_ballot_decision_politician_summary,0,0,0,0,0,0,1,773.558454,773.558454,773.558454,773.558454,0,0,7041,30634,32,10,0,0,0,0,0,0,0,0,0,0,203,22,254749,0,0,0,0,0,0,0,0
10,16385,f,7016553147023918732,COPY  ( SELECT * FROM public.sweden_political_party ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.7567679999999999,1.7567679999999999,1.7567679999999999,1.7567679999999999,0,40,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4921801796223722027,COPY  ( SELECT * FROM public.document_reference_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,167.141448,167.141448,167.141448,167.141448,0,300,0,159,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1621204135258975379,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_element WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,56.638173,56.638173,56.638173,56.638173,0,311,228,35604,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9058185431485121486,SELECT COUNT(*) FROM public.view_riksdagen_committee_roles,0,0,0,0,0,0,1,6.844792,6.844792,6.844792,6.844792,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8387063386570418912,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_element WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,151.792267,151.792267,151.792267,151.792267,0,43,62,35818,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3259716384882786695,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_monthly ORDER BY random ( ) LIMIT 1804 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,11.359039,11.359039,11.359039,11.359039,0,1804,2231,469,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,9164776282471408627,"CREATE OR REPLACE FUNCTION cia_tmp_rowcount(schema_name text, rel_name text)
RETURNS bigint
LANGUAGE plpgsql
AS $$
DECLARE
    result bigint;
BEGIN
    EXECUTE format('SELECT COUNT(*) FROM %I.%I', schema_name, rel_name) INTO result;
    RETURN COALESCE(result, 0);
EXCEPTION WHEN OTHERS THEN
    RAISE NOTICE 'ERROR counting rows in %.%: %', schema_name, rel_name, SQLERRM;
    RETURN 0;
END;
$$",0,0,0,0,0,0,2,557.199064,2.990123,554.208941,278.599532,275.609409,0,308,40,13,0,0,0,0,0,0,0,0,0,0,0,17,13,71246,0,0,0,0,0,0,0,0
10,16385,f,-6054154482591023259,COPY  ( SELECT * FROM public.view_riksdagen_party_momentum_analysis ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3926.971983,3926.971983,3926.971983,3926.971983,0,441,130,87329,0,0,0,0,0,0,39502,39567,0,0,0,0,0,0,0,36,2.476015,1,12.858364,1,247.358042,1,180.795722
10,16385,t,3441573488324617602,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM committee_document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,51.589717,51.589717,51.589717,51.589717,0,31,45,303,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1708046091108478277,REFRESH MATERIALIZED VIEW public.view_riksdagen_org_document_daily_summary,0,0,0,0,0,0,2,567.4760249999999,231.226534,336.249491,283.73801249999997,52.51147849999999,133320,5600,71557,989,1027,0,0,0,0,304,622,0,0,0,0,133652,2,11662528,0,0,0,0,0,0,0,0
10,16385,t,3601720564527648788,COPY  ( SELECT * FROM public.document_detail_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,83.895594,83.895594,83.895594,83.895594,0,300,26,6549,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4389015384143904677,ANALYZE public.view_riksdagen_vote_data_ballot_summary_daily,0,0,0,0,0,0,1,12.033046,12.033046,12.033046,12.033046,0,0,3706,271,11,4,0,0,0,0,0,0,0,0,0,0,69,7,85738,0,0,0,0,0,0,0,0
10,16385,f,-3550770545175639659,"COPY  ( SELECT party_short_code AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE party_short_code IS NOT NULL GROUP BY party_short_code ORDER BY count DESC, party_short_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,81.94763200000001,81.94763200000001,81.94763200000001,81.94763200000001,0,16,16,3578,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2436621565251780920,"COPY  ( SELECT debate_name AS value, COUNT ( * ) AS count FROM document_element WHERE debate_name IS NOT NULL GROUP BY debate_name ORDER BY count DESC, debate_name LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,60.968736,60.968736,60.968736,60.968736,0,89,710,35122,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1950276331679447438,"SELECT $1 ||
       $2 ||
       $3 ||
       $4 ||
       $5",0,0,0,0,0,0,1,0.0023539999999999998,0.0023539999999999998,0.0023539999999999998,0.0023539999999999998,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8462426257437449303,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,5.992413,5.992413,5.992413,5.992413,0,5,482,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2491580708582908732,COPY  ( SELECT * FROM public.assignment_data ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.500212,11.500212,11.500212,11.500212,0,200,490,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5771079333835366015,"SELECT $1 || $2 ||
       $3 || $4
WHERE EXISTS (SELECT $5 FROM information_schema.tables WHERE table_schema = $6 AND table_name = $7)",0,0,0,0,0,0,1,0.018404,0.018404,0.018404,0.018404,0,1,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2390032166487386806,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_daily LIMIT $2),0,0,0,0,0,0,1,0.003787,0.003787,0.003787,0.003787,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7596195887718559092,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_ministry_effectiveness_trends ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 11 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,54.291286,54.291286,54.291286,54.291286,0,11,22840,3835,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2477126433607443657,"COPY  ( SELECT country_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE country_value IS NOT NULL GROUP BY country_value ORDER BY count DESC, country_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,54.605101000000005,54.605101000000005,54.605101000000005,54.605101000000005,0,6,16,10349,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6801007170207045690,"COPY  ( SELECT lending_type_value AS value, COUNT ( * ) AS count FROM country_element WHERE lending_type_value IS NOT NULL GROUP BY lending_type_value ORDER BY count DESC, lending_type_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.132036,0.132036,0.132036,0.132036,0,1,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4168913469337275986,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_annual,0,0,0,0,0,0,2,273.607625,26.711283,246.896342,136.8038125,110.09252949999998,402,11240,3376,24,21,0,0,0,0,0,0,0,0,0,0,938,12,209316,0,0,0,0,0,0,0,0
10,16385,t,5985036023624698577,"COPY  ( SELECT lang AS value, COUNT ( * ) AS count FROM document_element WHERE lang IS NOT NULL GROUP BY lang ORDER BY count DESC, lang LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.745572,58.745572,58.745572,58.745572,0,23,1096,34739,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,238286635383525834,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.081091,0.081091,0.081091,0.081091,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3949846545163515584,COPY  ( SELECT * FROM public.topic ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.323006,1.323006,1.323006,1.323006,0,200,43,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7396582140474543806,ANALYZE public.view_riksdagen_vote_data_ballot_summary_annual,0,0,0,0,0,0,1,1.446266,1.446266,1.446266,1.446266,0,0,2122,30,13,0,0,0,0,0,0,0,0,0,0,0,61,13,117103,0,0,0,0,0,0,0,0
10,16385,f,-1956342388312268422,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_monthly,0,0,0,0,0,0,2,192.092888,38.279463,153.813425,96.046444,57.766980999999994,3608,10134,807,110,135,0,0,0,0,98,236,0,0,0,0,4160,19,1044105,0,0,0,0,0,0,0,0
10,16385,f,-6960950440962786272,"COPY  ( SELECT group_behavior AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE group_behavior IS NOT NULL GROUP BY group_behavior ORDER BY count DESC, group_behavior LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004458,0.004458,0.004458,0.004458,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6697899161944479332,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004037,0.004037,0.004037,0.004037,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4013217689487553624,COPY  ( SELECT * FROM public.qrtz_locks ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.44762399999999997,0.44762399999999997,0.44762399999999997,0.44762399999999997,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,244281986785108433,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC, document_document_status_con_0 LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,53.541208,53.541208,53.541208,53.541208,0,1000,0,1085,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4059640547840561786,COPY  ( SELECT * FROM public.jv_global_id ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,100920.54288,100920.54288,100920.54288,100920.54288,0,200,70,157868,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2231333047981112366,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_annual_summary,0,0,0,0,0,0,1,0.155229,0.155229,0.155229,0.155229,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7990421590574882029,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $1 ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.13456100000000001,0.13456100000000001,0.13456100000000001,0.13456100000000001,0,4,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5339038528433148895,"SELECT c.oid,
  n.nspname,
  c.relname
FROM pg_catalog.pg_class c
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
WHERE c.relname OPERATOR(pg_catalog.~) $1 COLLATE pg_catalog.default
  AND pg_catalog.pg_table_is_visible(c.oid)
ORDER BY 2, 3",0,0,0,0,0,0,1,0.10326300000000001,0.10326300000000001,0.10326300000000001,0.10326300000000001,0,1,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3880271657754320343,"COPY  ( SELECT debate_name AS value, COUNT ( * ) AS count FROM document_element WHERE debate_name IS NOT NULL GROUP BY debate_name ORDER BY count DESC, debate_name LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.277933,61.277933,61.277933,61.277933,0,89,712,35123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,601437369507266169,"COPY  ( SELECT reference_type AS value, COUNT ( * ) AS count FROM document_reference_data WHERE reference_type IS NOT NULL GROUP BY reference_type ORDER BY count DESC, reference_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1855.256758,1855.256758,1855.256758,1855.256758,0,2,54,3294,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2149828501065179358,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_ballot_decision_summary LIMIT $2),0,0,0,0,0,0,1,0.003617,0.003617,0.003617,0.003617,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9016860247513676657,SELECT EXISTS(SELECT $1 FROM public.view_worldbank_indicator_data_country_summary LIMIT $2),0,0,0,0,0,0,1,0.007324,0.007324,0.007324,0.007324,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6003873705085801111,"COPY  ( SELECT election_type AS value, COUNT ( * ) AS count FROM sweden_election_type WHERE election_type IS NOT NULL GROUP BY election_type ORDER BY count DESC, election_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0038959999999999997,0.0038959999999999997,0.0038959999999999997,0.0038959999999999997,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2872076666696036723,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM document_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,24.573587,24.573587,24.573587,24.573587,0,28,3736,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-711952526061672561,"COPY  ( SELECT lending_type_value AS value, COUNT ( * ) AS count FROM country_element WHERE lending_type_value IS NOT NULL GROUP BY lending_type_value ORDER BY count DESC, lending_type_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.035525999999999995,0.035525999999999995,0.035525999999999995,0.035525999999999995,0,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,257997124835408384,"COPY  ( SELECT outcome AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE outcome IS NOT NULL GROUP BY outcome ORDER BY count DESC, outcome LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.003928,0.003928,0.003928,0.003928,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5304116830395787913,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary,0,0,0,0,0,0,2,2487.105932,1238.977968,1248.127964,1243.552966,4.5749980000000505,20190,52520,260072,554,13703,0,0,0,0,0,0,0,0,0,0,20921,276,6332900,0,0,0,0,0,0,0,0
10,16385,f,48369048756217566,COPY  ( SELECT * FROM public.document_proposal_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,34.415589000000004,34.415589000000004,34.415589000000004,34.415589000000004,0,300,0,2725,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-11929036931261372,SELECT COUNT(*) FROM public.view_application_action_event_page_element_annual_summary,0,0,0,0,0,0,1,0.098593,0.098593,0.098593,0.098593,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1149026059251716015,"SELECT COALESCE(c.reltuples, $10)::BIGINT                            FROM pg_class c
            JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE n.nspname = view_record.schemaname
              AND c.relname = view_record.object_name",0,0,0,0,0,0,28,1.7286490000000003,0.027361,0.167512,0.06173746428571428,0.036852291116488786,28,1123,260,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-183859061988489850,"CREATE TEMP TABLE cia_view_row_counts (
    schemaname TEXT,
    viewname TEXT,
    view_type TEXT,
    row_count BIGINT
)",0,0,0,0,0,0,1,13.804518,13.804518,13.804518,13.804518,0,0,341,25,21,0,0,0,0,0,0,0,0,0,0,0,91,21,124152,0,0,0,0,0,0,0,0
10,16385,f,4580536228023179256,SELECT COUNT(*) FROM public.view_riksdagen_party_ballot_support_annual_summary,0,0,0,0,0,0,1,880.616627,880.616627,880.616627,880.616627,0,1,352463,3044,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8041112705463646196,COPY  ( SELECT * FROM public.document_proposal_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,329.9641,329.9641,329.9641,329.9641,0,300,0,448,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7238193968400963720,"COPY (
    SELECT 1 as test
) TO '/tmp/test3.csv' WITH CSV HEADER",0,0,0,0,0,0,1,0.180977,0.180977,0.180977,0.180977,0,1,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1575543629927398433,COPY  ( SELECT * FROM public.document_detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,83.617275,83.617275,83.617275,83.617275,0,300,0,6540,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8345881541332173693,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM committee_document_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.4365430000000003,2.4365430000000003,2.4365430000000003,2.4365430000000003,0,113,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1933837354083075708,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,385.759653,385.759653,385.759653,385.759653,0,16,61,339,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3253083052894592554,SELECT COUNT(*) FROM public.pg_stat_statements_info,0,0,0,0,0,0,1,0.005029,0.005029,0.005029,0.005029,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,491826440264380884,COPY  ( SELECT * FROM public.language_data ORDER BY random ( ) LIMIT 135 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.820092,3.820092,3.820092,3.820092,0,135,58,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6772936797418699743,COPY  ( SELECT * FROM public.vote_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1925.651339,1925.651339,1925.651339,1925.651339,0,300,51,87335,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3899851020462317747,"COPY  ( SELECT assignment_type AS value, COUNT ( * ) AS count FROM assignment_element WHERE assignment_type IS NOT NULL GROUP BY assignment_type ORDER BY count DESC, assignment_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.331978,2.331978,2.331978,2.331978,0,0,42,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5999925436368480335,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_daily_summary,0,0,0,0,0,0,1,0.194412,0.194412,0.194412,0.194412,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5830151107597017773,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_element WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.088344,0.088344,0.088344,0.088344,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1226741241711699549,"COPY  ( SELECT process AS value, COUNT ( * ) AS count FROM document_activity_data WHERE process IS NOT NULL GROUP BY process ORDER BY count DESC, process LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,39.140688,39.140688,39.140688,39.140688,0,6,115,4901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2729959030575642582,REFRESH MATERIALIZED VIEW public.view_riksdagen_party_document_daily_summary,0,0,0,0,0,0,2,5128.523515,392.607351,4735.916164,2564.2617575,2171.6544065,17146,5315,13127,147,261,0,0,0,0,2632,2640,0,0,0,0,17492,5,1656529,0,0,0,0,0,0,0,0
10,16385,f,-7249505633115562494,"COPY  ( SELECT assignment_type AS value, COUNT ( * ) AS count FROM assignment_data WHERE assignment_type IS NOT NULL GROUP BY assignment_type ORDER BY count DESC, assignment_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,5.327342,5.327342,5.327342,5.327342,0,7,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2974440911579314790,"COPY  ( SELECT against_proposal_parties AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE against_proposal_parties IS NOT NULL GROUP BY against_proposal_parties ORDER BY count DESC, against_proposal_parties LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,14.469318,14.469318,14.469318,14.469318,0,205,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,430446580820009749,ANALYZE public.view_riksdagen_politician_document,0,0,0,0,0,0,1,292.064207,292.064207,292.064207,292.064207,0,0,3267,6665,11,3,0,0,0,0,0,0,0,0,0,0,79,8,97676,0,0,0,0,0,0,0,0
10,16385,f,-6522154970503463608,COPY  ( SELECT * FROM public.rule_violation ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,187.24668,187.24668,187.24668,187.24668,0,2244,0,370,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8341833111035762646,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_monthly,0,0,0,0,0,0,2,4813.2107049999995,2229.750138,2583.460567,2406.6053524999998,176.85521450000022,154668,39038,44721,6212,8457,0,0,0,0,27851,27903,0,0,0,0,155601,286,55408642,0,0,0,0,0,0,0,0
10,16385,f,-5924296848305665803,"COPY  ( SELECT electoral_region AS value, COUNT ( * ) AS count FROM vote_data WHERE electoral_region IS NOT NULL GROUP BY electoral_region ORDER BY count DESC, electoral_region LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,297.575162,297.575162,297.575162,297.575162,0,30,16,87329,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.58035,0,0,1,0.330527,1,4.830286
10,16385,f,-1822349172987761615,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document,0,0,0,0,0,0,2,9408.78306,2373.721696,7035.061364,4704.39153,2330.6698340000003,456220,65076,69038,12873,22093,0,0,0,0,12960,12936,0,0,0,0,459428,2696,134418263,0,0,0,0,0,0,0,0
10,16385,t,-3020197419609077668,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM document_element WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,55.932817,55.932817,55.932817,55.932817,0,61,327,35508,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5436213410440104377,"COPY  ( SELECT detail AS value, COUNT ( * ) AS count FROM assignment_data WHERE detail IS NOT NULL GROUP BY detail ORDER BY count DESC, detail LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,65.743468,65.743468,65.743468,65.743468,0,1329,485,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6291436438045175693,"COPY  ( SELECT $1 AS info, COUNT ( * ) AS file_count FROM ( SELECT $2 ) x ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.003477,0.003477,0.003477,0.003477,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3871816553898186591,COPY  ( SELECT * FROM public.document_attachment_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,195.910365,195.910365,195.910365,195.910365,0,300,0,309,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3759299313536402344,"COPY  ( SELECT income_level_value AS value, COUNT ( * ) AS count FROM country_element WHERE income_level_value IS NOT NULL GROUP BY income_level_value ORDER BY count DESC, income_level_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.535177,2.535177,2.535177,2.535177,0,3,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8473029264394727114,SELECT matviewname FROM pg_matviews WHERE schemaname = $1 ORDER BY matviewname,0,0,0,0,0,0,1,0.5844280000000001,0.5844280000000001,0.5844280000000001,0.5844280000000001,0,28,330,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,419275940722629130,"COPY  ( SELECT person_person_container_data_0 AS value, COUNT ( * ) AS count FROM person_container_data WHERE person_person_container_data_0 IS NOT NULL GROUP BY person_person_container_data_0 ORDER BY count DESC, person_person_container_data_0 LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.406558,0.406558,0.406558,0.406558,0,0,35,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6727690871473919091,COPY  ( SELECT * FROM public.databasechangelog ORDER BY random ( ) LIMIT 412 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,52.048981,52.048981,52.048981,52.048981,0,412,62,25,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6710073564145214615,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_party_document_daily_summary LIMIT $2),0,0,0,0,0,0,1,0.004789,0.004789,0.004789,0.004789,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3104312934708731861,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_ministry_risk_evolution ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.63816799999999,57.63816799999999,57.63816799999999,57.63816799999999,0,8,6384,390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6599269650446847906,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary,0,0,0,0,0,0,2,158681.614804,76593.726012,82087.888792,79340.807402,2747.081390000003,7046310,687520,1103969,282203,564882,0,0,0,0,904867,905481,0,0,0,0,7065162,18296,2558891008,0,0,0,0,0,0,0,0
10,16385,t,3741356661484990041,"COPY  ( SELECT document_committee_proposal__0 AS value, COUNT ( * ) AS count FROM committee_proposal_component_0 WHERE document_committee_proposal__0 IS NOT NULL GROUP BY document_committee_proposal__0 ORDER BY count DESC, document_committee_proposal__0 LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,99.248148,99.248148,99.248148,99.248148,0,1000,44,79,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-857128017002313219,SELECT COUNT(*) FROM public.view_application_action_event_page_daily_summary,0,0,0,0,0,0,1,0.15984800000000002,0.15984800000000002,0.15984800000000002,0.15984800000000002,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4213406605570417462,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM document_detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,4030.069161,4030.069161,4030.069161,4030.069161,0,16,55,6546,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,368717928347879829,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,333.835452,333.835452,333.835452,333.835452,0,17,38,516,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7419431320792419525,"COPY  ( SELECT database_source AS value, COUNT ( * ) AS count FROM document_element WHERE database_source IS NOT NULL GROUP BY database_source ORDER BY count DESC, database_source LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,59.492344,59.492344,59.492344,59.492344,0,5,613,35219,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7050974935339567217,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM document_detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3956.34935,3956.34935,3956.34935,3956.34935,0,16,16,6540,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-345123517048346952,SELECT COUNT(*) FROM public.view_application_action_event_page_element_hourly_summary,0,0,0,0,0,0,1,0.134282,0.134282,0.134282,0.134282,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5827178464283574856,"SELECT a.attname,
  pg_catalog.format_type(a.atttypid, a.atttypmod),
  (SELECT pg_catalog.pg_get_expr(d.adbin, d.adrelid, $1)
   FROM pg_catalog.pg_attrdef d
   WHERE d.adrelid = a.attrelid AND d.adnum = a.attnum AND a.atthasdef),
  a.attnotnull,
  (SELECT c.collname FROM pg_catalog.pg_collation c, pg_catalog.pg_type t
   WHERE c.oid = a.attcollation AND t.oid = a.atttypid AND a.attcollation <> t.typcollation) AS attcollation,
  a.attidentity,
  a.attgenerated
FROM pg_catalog.pg_attribute a
WHERE a.attrelid = $2 AND a.attnum > $3 AND NOT a.attisdropped
ORDER BY a.attnum",0,0,0,0,0,0,1,0.109734,0.109734,0.109734,0.109734,0,26,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1145031465870977432,COPY  ( SELECT * FROM public.view_riksdagen_politician_document_daily_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,222.625059,222.625059,222.625059,222.625059,0,500,346,532,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1128968875247936686,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6, $7, $8]) AS col
WHERE EXISTS (SELECT $9 FROM information_schema.columns WHERE table_schema = $10 AND table_name = $11 AND column_name = col)",0,0,0,0,0,0,4,59.73769,0.20235699999999998,49.765027,14.934422500000002,20.46177242535102,16,1091,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4431046026996336314,SELECT COUNT(*) FROM public.view_application_action_event_page_hourly_summary,0,0,0,0,0,0,1,0.174565,0.174565,0.174565,0.174565,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7652294891628938372,COPY  ( SELECT * FROM public.document_status_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,25.832134,25.832134,25.832134,25.832134,0,300,0,1085,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4335022894365168221,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'week' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '6 months' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 60 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.52569,0.52569,0.52569,0.52569,0,10,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7404828307920337430,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,516.734954,516.734954,516.734954,516.734954,0,91,302,493,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6953922560316133934,ANALYZE public.view_riksdagen_document_type_daily_summary,0,0,0,0,0,0,1,46.675588,46.675588,46.675588,46.675588,0,0,624,302,3,0,0,0,0,0,0,0,0,0,0,0,10,3,27046,0,0,0,0,0,0,0,0
10,16385,f,4047566205865010397,SELECT COUNT(*) FROM public.view_politician_risk_summary,0,0,0,0,0,0,1,1086.433618,1086.433618,1086.433618,1086.433618,0,1,11770,11656,0,9,0,0,0,0,2238,2245,0,0,0,0,0,0,0,81,3.399161,0,0,1,1.458479,1,35.537875
10,16385,t,2551493251662255768,COPY  ( SELECT * FROM public.view_riksdagen_party_coalation_against_annual_summary ORDER BY random ( ) LIMIT 278 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,15.815278,15.815278,15.815278,15.815278,0,278,5,2832,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1702167917999552498,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_daily ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,902.916238,902.916238,902.916238,902.916238,0,500,2939,23375,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,991592556007266272,"COPY  ( SELECT reference_type AS value, COUNT ( * ) AS count FROM document_reference_data WHERE reference_type IS NOT NULL GROUP BY reference_type ORDER BY count DESC, reference_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1824.980337,1824.980337,1824.980337,1824.980337,0,2,16,3287,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-9111518282906181666,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_element WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.321196,57.321196,57.321196,57.321196,0,98,423,35412,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6564855795827845044,COPY  ( SELECT * FROM public.view_riksdagen_party_coalation_against_annual_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,15.557277,15.557277,15.557277,15.557277,0,278,0,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3856618091206863206,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary_annual LIMIT $2),0,0,0,0,0,0,1,0.003496,0.003496,0.003496,0.003496,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8892824731550586216,SELECT COUNT(*) FROM public.view_application_action_event_page_element_daily_summary,0,0,0,0,0,0,1,0.102692,0.102692,0.102692,0.102692,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4258874667858305805,"WITH categorical_columns AS (
    SELECT 
        c.table_name,
        c.column_name,
        c.data_type,
        c.character_maximum_length
    FROM information_schema.columns c
    JOIN information_schema.tables t 
        ON t.table_schema = c.table_schema 
        AND t.table_name = c.table_name
    WHERE c.table_schema = $1
      AND t.table_type = $2
      AND c.data_type IN ($3, $4, $5)
      -- Exclude large text fields and known non-categorical columns
      AND (c.character_maximum_length IS NULL OR c.character_maximum_length <= $6)
      -- ========================================================================
      -- EXCLUDE CONTENT/TEXT FIELDS (long text, descriptions, etc.)
      -- ========================================================================
      AND c.column_name NOT IN ($7, $8, $9, $10, $11, 
                                 $12, $13, $14, $15, $16,
                                 $17, $18, $19, $20,
                                 $21, $22, $23,
                                 $24, $25,
                                 $26, $27, $28)
      -- ========================================================================
      -- EXCLUDE URL FIELDS
      -- ========================================================================
      AND c.column_name NOT IN ($29, $30, $31, $32, 
                                 $33, $34, $35,
                                 $36, $37,
                                 $38, $39,
                                 $40, $41, $42)
      -- ========================================================================
      -- EXCLUDE NAME FIELDS (person names, full names, etc.)
      -- ========================================================================
      AND c.column_name NOT IN ($43, $44, $45, $46,
                                 $47, $48, $49,
                                 $50, $51, $52,
                                 $53, $54,
                                 $55, $56, $57, $58,
                                 $59, $60, $61, 
                                 $62, $63)
      -- ========================================================================
      -- EXCLUDE ID FIELDS (unique identifiers, foreign keys, etc.)
      -- ========================================================================
      AND c.column_name NOT LIKE $64
      AND c.column_name NOT LIKE $65
      AND c.column_name NOT LIKE $66
      AND c.column_name != $67
      AND c.column_name NOT LIKE $68
      AND c.column_name NOT LIKE $69
      AND c.column_name NOT LIKE $70
      AND c.column_name NOT LIKE $71
      AND c.column_name NOT LIKE $72
      AND c.column_name NOT LIKE $73
      AND c.column_name NOT LIKE $74
      -- ========================================================================
      -- EXCLUDE SESSION/USER TRACKING FIELDS
      -- ========================================================================
      AND c.column_name NOT IN ($75, $76, $77,
                                 $78, $79, $80, $81)
      -- ========================================================================
      -- EXCLUDE DATE/TIME STRING FIELDS
      -- ========================================================================
      AND c.column_name NOT LIKE $82
      AND c.column_name NOT LIKE $83
      AND c.column_name NOT IN ($84, $85, $86, $87,
                                 $88)
      -- ========================================================================
      -- EXCLUDE TECHNICAL/INFRASTRUCTURE TABLES (not domain data)
      -- ========================================================================
      -- Javers audit tables (jv_*)
      AND c.table_name NOT LIKE $89
      -- Quartz scheduler tables (qrtz_*)
      AND c.table_name NOT LIKE $90
      -- Liquibase migration tables
      AND c.table_name NOT IN ($91, $92)
      -- Hibernate sequence table
      AND c.table_name != $93
      -- Encrypted value storage (sensitive)
      AND c.table_name != $94
      -- Application session/event tables (user tracking, not political data)
      AND c.table_name NOT IN ($95, $96, 
                                $97, $98)
      -- User account tables (sensitive)
      AND c.table_name NOT IN ($99, $100)
      -- Portal configuration tables
      AND c.table_name NOT IN ($101, $102, $103)
      -- Rule violation tracking
      AND c.table_name != $104
      -- Data source metadata
      AND c.table_name != $105
      -- Language/translation tables (not political data)
      AND c.table_name NOT IN ($106, $107)
      -- ========================================================================
      -- EXCLUDE OTHER HIGH-CARDINALITY OR NON-CATEGORICAL COLUMNS
      -- ========================================================================
      AND c.column_name NOT IN ($108, $109, $110, $111,
                                 $112, $113, $114, $115,
                                 $116, $117, $118, 
                                 $119, $120, $121, $122,
                                 $123, $124, $125)
      -- ========================================================================
      -- Skip columns already extracted above (critical columns)
      -- ========================================================================
      AND NOT (c.table_name = $126 AND c.column_name IN ($127, $128, $129, $130, $131, $132))
      AND NOT (c.table_name = $133 AND c.column_name IN ($134, $135, $136, $137))
      AND NOT (c.table_name = $138 AND c.column_name IN ($139, $140, $141, $142))
      AND NOT (c.table_name = $143 AND c.column_name IN ($144, $145, $146, $147, $148))
      AND NOT (c.table_name = $149 AND c.column_name IN ($150, $151, $152, $153))
      AND NOT (c.table_name = $154 AND c.column_name IN ($155, $156, $157, $158))
      AND NOT (c.table_name = $159 AND c.column_name IN ($160))
      AND NOT (c.table_name = $161 AND c.column_name IN ($162, $163, $164, $165, $166, $167, $168))
      AND NOT (c.table_name = $169 AND c.column_name IN ($170, $171))
    ORDER BY c.table_name, c.column_name
)
SELECT format(
    $172 || $173 ||
    $174 || $175,
    table_name, column_name,
    column_name, table_name, column_name, column_name, column_name,
    table_name, column_name
)
FROM categorical_columns",0,0,0,0,0,0,1,246.160303,246.160303,246.160303,246.160303,0,51,10147,1130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,77651703591085973,ANALYZE public.view_riksdagen_committee_ballot_decision_summary,0,0,0,0,0,0,1,55.569029,55.569029,55.569029,55.569029,0,0,4679,681,22,7,0,0,0,0,0,0,0,0,0,0,134,15,170806,0,0,0,0,0,0,0,0
10,16385,f,4568741846396245076,ANALYZE public.view_riksdagen_vote_data_ballot_summary_monthly,0,0,0,0,0,0,1,2.98694,2.98694,2.98694,2.98694,0,0,3200,179,10,3,0,0,0,0,0,0,0,0,0,0,58,7,81115,0,0,0,0,0,0,0,0
10,16385,t,-6594641675432182244,"SELECT c.relchecks, c.relkind, c.relhasindex, c.relhasrules, c.relhastriggers, c.relrowsecurity, c.relforcerowsecurity, $1 AS relhasoids, c.relispartition, $2, c.reltablespace, CASE WHEN c.reloftype = $3 THEN $4 ELSE c.reloftype::pg_catalog.regtype::pg_catalog.text END, c.relpersistence, c.relreplident, am.amname
FROM pg_catalog.pg_class c
 LEFT JOIN pg_catalog.pg_class tc ON (c.reltoastrelid = tc.oid)
LEFT JOIN pg_catalog.pg_am am ON (c.relam = am.oid)
WHERE c.oid = $5",0,0,0,0,0,0,1,0.013065,0.013065,0.013065,0.013065,0,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4560142462202344260,"COPY  ( SELECT indicator_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE indicator_value IS NOT NULL GROUP BY indicator_value ORDER BY count DESC, indicator_value LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.783837,61.783837,61.783837,61.783837,0,1000,115,10256,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5084904434797973579,COPY  ( SELECT * FROM public.qrtz_cron_triggers ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,62.584430999999995,62.584430999999995,62.584430999999995,62.584430999999995,0,4,0,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5272467656550815857,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_weekly LIMIT $2),0,0,0,0,0,0,1,0.003626,0.003626,0.003626,0.003626,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-924627702581251993,SELECT COUNT(*) FROM public.view_riksdagen_goverment_proposals,0,0,0,0,0,0,1,32.509955,32.509955,32.509955,32.509955,0,1,0,3736,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2404464471695066056,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_data WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.702059,0.702059,0.702059,0.702059,0,2,338,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3984086727385884661,"COPY  ( SELECT iso_2code AS value, COUNT ( * ) AS count FROM country_element WHERE iso_2code IS NOT NULL GROUP BY iso_2code ORDER BY count DESC, iso_2code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.20100500000000002,0.20100500000000002,0.20100500000000002,0.20100500000000002,0,211,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1050309689711967465,COPY  ( SELECT * FROM public.jv_snapshot ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,472962.954729,472962.954729,472962.954729,472962.954729,0,200,31,919026,598,568,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.250046,1,1.291378,1,17.688961,1,11.159355
10,16385,f,6751792141731574124,"COPY  ( SELECT role_description AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE role_description IS NOT NULL GROUP BY role_description ORDER BY count DESC, role_description LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,30.411633000000002,30.411633000000002,30.411633000000002,30.411633000000002,0,1,3594,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7904999696634058772,"COPY  ( SELECT origin AS value, COUNT ( * ) AS count FROM document_element WHERE origin IS NOT NULL GROUP BY origin ORDER BY count DESC, origin LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.667406,58.667406,58.667406,58.667406,0,36,1193,34642,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6457694864673531750,"COPY  ( SELECT document_name AS value, COUNT ( * ) AS count FROM document_element WHERE document_name IS NOT NULL GROUP BY document_name ORDER BY count DESC, document_name LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.332936,61.332936,61.332936,61.332936,0,95,902,34930,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6053803253576743000,SELECT COUNT(*) FROM public.view_riksdagen_goverment_role_member,0,0,0,0,0,0,1,7.05771,7.05771,7.05771,7.05771,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3924792710864715419,COPY  ( SELECT * FROM public.application_action_event ORDER BY random ( ) LIMIT 241 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,211.308385,211.308385,211.308385,211.308385,0,241,197,29,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,550768861245194729,COPY  ( SELECT * FROM public.vote_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1923.783637,1923.783637,1923.783637,1923.783637,0,300,0,87329,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.412218,0,0,1,0.267158,1,2.99296
10,16385,f,5352061430512400216,COPY  ( SELECT * FROM public.document_activity_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,111.749077,111.749077,111.749077,111.749077,0,300,0,4992,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2010345667430201340,"COPY  ( SELECT role_description AS value, COUNT ( * ) AS count FROM document_person_reference_da_0 WHERE role_description IS NOT NULL GROUP BY role_description ORDER BY count DESC, role_description LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,30.65117,30.65117,30.65117,30.65117,0,1,3597,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5489105477367505335,"WITH view_counts AS (
    SELECT schemaname,
           viewname,
           row_count
    FROM cia_view_row_counts
    WHERE viewname != $1
      AND viewname != $2
),
-- ============================================================================
-- TEMPORAL VIEW CLASSIFICATION
-- ============================================================================
-- Identify views by temporal granularity based on naming patterns
-- This enables stratified sampling across time periods
-- Uses reusable cia_classify_temporal_view() function
-- ============================================================================
view_temporal_classification AS (
    SELECT 
        vc.schemaname,
        vc.viewname,
        vc.row_count,
        c.temporal_granularity,
        c.samples_per_bucket
    FROM view_counts vc
    CROSS JOIN LATERAL cia_classify_temporal_view(vc.viewname) AS c
    WHERE vc.row_count > $3
),
-- ============================================================================
-- TEMPORAL COLUMN DETECTION
-- ============================================================================
-- Automatically detect temporal columns in each view
-- ============================================================================
view_temporal_columns AS (
    SELECT 
        c.table_schema AS schemaname,
        c.table_name AS viewname,
        c.column_name AS temporal_column,
        c.data_type,
        -- Prioritize common temporal column names
        CASE 
            WHEN c.column_name IN ($4, $5) THEN $6
            WHEN c.column_name IN ($7, $8, $9) THEN $10
            WHEN c.column_name IN ($11, $12, $13) THEN $14
            WHEN c.column_name LIKE $15 THEN $16
            ELSE $17
        END AS priority
    FROM information_schema.columns c
    WHERE c.table_schema = $18
      AND c.data_type IN ($19, $20, $21)
      AND c.column_name NOT IN ($22, $23) -- Exclude technical columns
),
view_primary_temporal_column AS (
    SELECT DISTINCT ON (schemaname, viewname)
        schemaname,
        viewname,
        temporal_column
    FROM view_temporal_columns
    ORDER BY schemaname, viewname, priority
),
-- ============================================================================
-- GENERATE STRATIFIED SAMPLING QUERIES
-- ============================================================================
view_extract AS (
    SELECT 
        vtc.schemaname,
        vtc.viewname,
        vtc.row_count,
        vtc.temporal_granularity,
        vtc.samples_per_bucket,
        vptc.temporal_column,
        -- Smart sample size calculation:
        -- 1. Complete extraction for small views (< threshold)
        -- 2. Extended samples for party/committee/person views
        -- 3. Extended samples for document/voting/worldbank views
        -- 4. Default sample size for others
        CASE 
            -- Complete extraction for small views
            WHEN vtc.row_count <= $24::int THEN vtc.row_count
            -- Extended samples for party-related views
            WHEN vtc.viewname ILIKE $25 OR vtc.viewname ILIKE $26 THEN 
                LEAST($27::int, vtc.row_count)
            -- Extended samples for committee-related views
            WHEN vtc.viewname ILIKE $28 OR vtc.viewname ILIKE $29 THEN 
                LEAST($30::int, vtc.row_count)
            -- Extended samples for person/politician views
            WHEN vtc.viewname ILIKE $31 OR vtc.viewname ILIKE $32 
                OR vtc.viewname ILIKE $33 THEN 
                LEAST($34::int, vtc.row_count)
            -- Extended samples for document-related views
            WHEN vtc.viewname ILIKE $35 OR vtc.viewname ILIKE $36 THEN 
                LEAST($37::int, vtc.row_count)
            -- Extended samples for voting-related views
            WHEN vtc.viewname ILIKE $38 OR vtc.viewname ILIKE $39 THEN 
                LEAST($40::int, vtc.row_count)
            -- Extended samples for worldbank data
            WHEN vtc.viewname ILIKE $41 OR vtc.viewname ILIKE $42 
                OR vtc.viewname ILIKE $43 THEN 
                LEAST($44::int, vtc.row_count)
            -- Default sample size
            ELSE LEAST($45::int, vtc.row_count)
        END AS sample_rows,
        -- Extraction type for logging
        CASE 
            WHEN vtc.row_count <= $46::int THEN $47
            WHEN vtc.viewname ILIKE $48 OR vtc.viewname ILIKE $49 THEN $50
            WHEN vtc.viewname ILIKE $51 OR vtc.viewname ILIKE $52 THEN $53
            WHEN vtc.viewname ILIKE $54 OR vtc.viewname ILIKE $55 
                OR vtc.viewname ILIKE $56 THEN $57
            WHEN vtc.viewname ILIKE $58 OR vtc.viewname ILIKE $59 THEN $60
            WHEN vtc.viewname ILIKE $61 OR vtc.viewname ILIKE $62 THEN $63
            WHEN vtc.viewname ILIKE $64 OR vtc.viewname ILIKE $65 
                OR vtc.viewname ILIKE $66 THEN $67
            ELSE $68
        END AS extraction_type,
        CASE WHEN vtc.viewname LIKE $69 THEN vtc.viewname ELSE $70 || vtc.viewname END AS file_prefix
    FROM view_temporal_classification vtc
    LEFT JOIN view_primary_temporal_column vptc 
        ON vtc.schemaname = vptc.schemaname 
        AND vtc.viewname = vptc.viewname
)
-- ============================================================================
-- GENERATE EXTRACTION COMMANDS WITH TEMPORAL STRATIFICATION
-- ============================================================================
SELECT 
    CASE 
        -- =====================================================================
        -- DAILY VIEWS: Stratified sampling by day
        -- =====================================================================
        WHEN temporal_granularity = $71 AND temporal_column IS NOT NULL THEN
            format(
                $72 || $73 ||
                $74 ||
                $75 ||
                $76 ||
                $77 ||
                $78 ||
                $79 ||
                $80 ||
                $81 ||
                $82 || $83 ||
                $84 || $85,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- WEEKLY VIEWS: Stratified sampling by week
        -- =====================================================================
        WHEN temporal_granularity = $86 AND temporal_column IS NOT NULL THEN
            format(
                $87 || $88 ||
                $89 ||
                $90 ||
                $91 ||
                $92 ||
                $93 ||
                $94 ||
                $95 ||
                $96 ||
                $97 || $98 ||
                $99 || $100,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- MONTHLY VIEWS: Stratified sampling by month
        -- =====================================================================
        WHEN temporal_granularity = $101 AND temporal_column IS NOT NULL THEN
            format(
                $102 || $103 ||
                $104 ||
                $105 ||
                $106 ||
                $107 ||
                $108 ||
                $109 ||
                $110 ||
                $111 ||
                $112 || $113 ||
                $114 || $115,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname, temporal_column,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- ANNUAL VIEWS: Stratified sampling by year
        -- =====================================================================
        WHEN temporal_granularity = $116 AND temporal_column IS NOT NULL THEN
            format(
                $117 || $118 ||
                $119 ||
                $120 ||
                $121 ||
                $122 ||
                $123 ||
                $124 ||
                $125 ||
                $126 || $127 ||
                $128 || $129,
                viewname,
                samples_per_bucket,
                temporal_column, schemaname, viewname,
                samples_per_bucket, sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- TEMPORAL TREND VIEWS: Sample across all time periods
        -- =====================================================================
        WHEN temporal_granularity = $130 AND temporal_column IS NOT NULL THEN
            format(
                $131 || $132 ||
                $133 ||
                $134 ||
                $135 ||
                $136 ||
                $137 ||
                $138 ||
                $139 ||
                $140 ||
                $141 || $142 ||
                $143 || $144,
                viewname,
                temporal_column, temporal_column, schemaname, viewname,
                sample_rows,
                file_prefix, file_prefix
            )
        
        -- =====================================================================
        -- NON-TEMPORAL VIEWS: Use random sampling with smart sample sizes
        -- =====================================================================
        ELSE
            format(
                $145 || $146 ||
                $147 || $148 ||
                $149 || $150,
                extraction_type,
                viewname,
                sample_rows,
                row_count,
                schemaname,
                viewname,
                sample_rows,
                file_prefix,
                file_prefix
            )
    END AS extraction_command
FROM view_extract
ORDER BY 
    CASE temporal_granularity
        WHEN $151 THEN $152
        WHEN $153 THEN $154
        WHEN $155 THEN $156
        WHEN $157 THEN $158
        WHEN $159 THEN $160
        ELSE $161
    END,
    viewname",0,0,0,0,0,0,1,1743.304634,1743.304634,1743.304634,1743.304634,0,81,8726,255,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6647975046885821357,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC LIMIT 500 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,42.580612,42.580612,42.580612,42.580612,0,500,1085,0,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-691775195328610,ANALYZE public.view_riksdagen_committee_decision_type_org_summary,0,0,0,0,0,0,1,11.704693,11.704693,11.704693,11.704693,0,0,1092,208,3,1,0,0,0,0,0,0,0,0,0,0,18,2,20624,0,0,0,0,0,0,0,0
10,16385,f,-1996653813280651019,"EXISTS (
                    SELECT $18
                    FROM tmp_mv_refresh_state s
                    WHERE s.schemaname  = mv_record.schemaname
                      AND s.matviewname = mv_record.matviewname
                )",0,0,0,0,0,0,56,0.4019899999999999,0.004218,0.012013,0.007178392857142859,0.0013593624907939565,56,0,0,0,0,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8463602289390557079,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'year' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 29 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.54705,0.54705,0.54705,0.54705,0,4,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6603308638027092308,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_data WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.6000989999999999,0.6000989999999999,0.6000989999999999,0.6000989999999999,0,2,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8177634166909195455,"COPY  ( SELECT target AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE target IS NOT NULL GROUP BY target ORDER BY count DESC, target LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004007,0.004007,0.004007,0.004007,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8694190517236404501,SELECT COUNT(*) FROM public.view_ministry_productivity_matrix,0,0,0,0,0,0,1,86.664347,86.664347,86.664347,86.664347,0,1,7152,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,2.664156,0,0,1,1.076708,1,27.885395
10,16385,t,4683042918118323558,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'week' , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '6 months' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 36 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.571205,0.571205,0.571205,0.571205,0,10,33,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4960414832108494333,"COPY  ( SELECT file_type AS value, COUNT ( * ) AS count FROM document_attachment WHERE file_type IS NOT NULL GROUP BY file_type ORDER BY count DESC, file_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2053.373429,2053.373429,2053.373429,2053.373429,0,4,54,3441,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4106991534011733459,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_annual_summary ) SELECT * FROM temporal_strata WHERE rn <= $2 LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.24106,0.24106,0.24106,0.24106,0,4,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1681869960115804855,SELECT COUNT(*) FROM public.view_riksdagen_committee,0,0,0,0,0,0,1,392.57230599999997,392.57230599999997,392.57230599999997,392.57230599999997,0,1,77,6866,0,0,0,0,0,0,1395,1400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3314904168006488151,"COPY  ( SELECT born_year AS value, COUNT ( * ) AS count FROM person_element WHERE born_year IS NOT NULL GROUP BY born_year ORDER BY count DESC, born_year LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.449337,0.449337,0.449337,0.449337,0,0,36,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2777911020036200922,SELECT COUNT(*) FROM public.view_audit_author_summary,0,0,0,0,0,0,1,1222.337665,1222.337665,1222.337665,1222.337665,0,1,48,59520,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1693720041558248909,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.544152,57.544152,57.544152,57.544152,0,500,127,35708,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8172190135259613724,"COPY  ( SELECT proffessional_behavior AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE proffessional_behavior IS NOT NULL GROUP BY proffessional_behavior ORDER BY count DESC, proffessional_behavior LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.003959,0.003959,0.003959,0.003959,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3090019728596903256,"COPY  ( SELECT document_category AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_category IS NOT NULL GROUP BY document_category ORDER BY count DESC, document_category LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,67.983528,67.983528,67.983528,67.983528,0,0,0,1085,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,f,5344976743488284415,"SELECT pg_catalog.upper(object_type),
       object_identity,
       pg_catalog.upper(command_tag)
  FROM pg_catalog.pg_event_trigger_ddl_commands()",0,0,0,0,0,0,68,2.341980999999999,0.002475,0.20934,0.034440897058823534,0.023884427849751633,65,2698,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2614040841085614376,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_element WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.113372,0.113372,0.113372,0.113372,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1152709379256106198,COPY  ( SELECT * FROM public.view_riksdagen_party_document_daily_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,4.157462,4.157462,4.157462,4.157462,0,500,463,178,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5188814160967881233,COPY  ( SELECT * FROM public.document_element ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,462.916666,462.916666,462.916666,462.916666,0,300,93,35839,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5611325038629242765,COPY  ( SELECT * FROM public.view_riksdagen_org_document_daily_summary ORDER BY random ( ) LIMIT 300 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,20.165499,20.165499,20.165499,20.165499,0,300,381,577,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8420076355728971635,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.007484,0.007484,0.007484,0.007484,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6488558639137853394,COPY  ( SELECT * FROM public.language_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.6222750000000001,1.6222750000000001,1.6222750000000001,1.6222750000000001,0,135,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3724125379468931867,COPY  ( SELECT * FROM public.view_riksdagen_party_document_daily_summary ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3.446496,3.446496,3.446496,3.446496,0,500,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6802490887002930205,COPY  ( SELECT * FROM public.assignment_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.320938,11.320938,11.320938,11.320938,0,200,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3811993232039139646,ANALYZE public.view_riksdagen_party_document_daily_summary,0,0,0,0,0,0,1,11.92296,11.92296,11.92296,11.92296,0,0,1004,200,3,1,0,0,0,0,0,0,0,0,0,0,19,2,22025,0,0,0,0,0,0,0,0
10,16385,f,4658353193032237161,SELECT COUNT(*) FROM public.view_riksdagen_party,0,0,0,0,0,0,1,2.654489,2.654489,2.654489,2.654489,0,1,0,379,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8800568423148455577,"COPY  ( SELECT document_document_status_con_0 AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_document_status_con_0 IS NOT NULL GROUP BY document_document_status_con_0 ORDER BY count DESC LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,42.126505,42.126505,42.126505,42.126505,0,500,1085,0,0,0,0,0,0,0,42,109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4638273750838203895,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,15.688350999999999,15.688350999999999,15.688350999999999,15.688350999999999,0,4,2725,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,238410598408167409,ANALYZE public.view_riksdagen_committee_ballot_decision_party_summary,0,0,0,0,0,0,1,538.130671,538.130671,538.130671,538.130671,0,0,5978,2610,43,7,0,0,0,0,0,0,0,0,0,0,164,31,292562,0,0,0,0,0,0,0,0
10,16385,t,1718443060581566314,COPY  ( SELECT * FROM public.rule_violation ORDER BY random ( ) LIMIT 2244 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,254.759339,254.759339,254.759339,254.759339,0,2244,144,390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3863031927776322127,COPY  ( SELECT * FROM public.agency ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,4.501313,4.501313,4.501313,4.501313,0,1,49,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2462736760524823484,COPY  ( SELECT * FROM public.against_proposal_container ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,133.21687500000002,133.21687500000002,133.21687500000002,133.21687500000002,0,300,3,39,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5010423264100256638,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,5.890483000000001,5.890483000000001,5.890483000000001,5.890483000000001,0,5,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5477668860699884482,"COPY  ( SELECT document_category AS value, COUNT ( * ) AS count FROM document_status_container WHERE document_category IS NOT NULL GROUP BY document_category ORDER BY count DESC, document_category LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,75.223638,75.223638,75.223638,75.223638,0,0,45,1088,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4736996810827546882,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC, intressent_id LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.23,7.23,7.23,7.23,0,2000,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6173199972782413148,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_monthly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,9.246541,9.246541,9.246541,9.246541,0,1804,0,51,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8735536478699418484,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_ministry_risk_evolution ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 168 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.839958,58.839958,58.839958,58.839958,0,8,6430,390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2725647267385764752,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , decision_day ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , decision_day ) ORDER BY random ( ) ) AS rn FROM public.view_decision_temporal_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,235.32586,235.32586,235.32586,235.32586,0,39,295596,8350,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2567356171012578727,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM vote_data WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,320.033557,320.033557,320.033557,320.033557,0,2,8823,78525,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4624877833479422471,COPY  ( SELECT * FROM public.application_session ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,14.911897,14.911897,14.911897,14.911897,0,18,0,12,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1424311604901364407,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM committee_document_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.5230700000000001,1.5230700000000001,1.5230700000000001,1.5230700000000001,0,27,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5569951581642395731,ANALYZE public.view_riksdagen_vote_data_ballot_summary,0,0,0,0,0,0,1,68.98322,68.98322,68.98322,68.98322,0,0,3131,383,8,3,0,0,0,0,0,0,0,0,0,0,70,5,68035,0,0,0,0,0,0,0,0
10,16385,t,8079043959791402531,"COPY  ( SELECT schemaname AS schema, matviewname AS view_name, ( SELECT n_live_tup FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS estimated_rows, ( SELECT n_dead_tup FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS dead_rows, ( SELECT last_analyze FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS last_analyzed, ( SELECT last_autoanalyze FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS last_auto_analyzed FROM pg_matviews m WHERE schemaname = 'public' ORDER BY estimated_rows DESC NULLS LAST ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,6.980526,6.980526,6.980526,6.980526,0,28,6525,27,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8795427016998702943,COPY  ( SELECT * FROM public.committee_proposal_component_0 ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.856421,1.856421,1.856421,1.856421,0,500,0,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3382272513411956864,"SELECT schemaname, viewname AS object_name, $1 AS object_type
        FROM pg_views
        WHERE schemaname = $2
        UNION ALL
        SELECT schemaname, matviewname AS object_name, $3 AS object_type
        FROM pg_matviews
        WHERE schemaname = $4
        ORDER BY object_name",0,0,0,0,0,0,1,1.373804,1.373804,1.373804,1.373804,0,83,684,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7451793817315958939,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_data WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,333.56946500000004,333.56946500000004,333.56946500000004,333.56946500000004,0,91,6,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5161759643275882382,"COPY  ( SELECT role_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE role_code IS NOT NULL GROUP BY role_code ORDER BY count DESC, role_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0041470000000000005,0.0041470000000000005,0.0041470000000000005,0.0041470000000000005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-782930010631874749,"COPY  ( SELECT domain_org AS value, COUNT ( * ) AS count FROM document_element WHERE domain_org IS NOT NULL GROUP BY domain_org ORDER BY count DESC, domain_org LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.313391,57.313391,57.313391,57.313391,0,1,1001,34834,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8874211012572930635,"INSERT INTO tmp_mv_refresh_state (schemaname, matviewname)
                VALUES (mv_record.schemaname, mv_record.matviewname)
                ON CONFLICT (schemaname, matviewname) DO NOTHING",0,0,0,0,0,0,28,0.5682589999999998,0.012163,0.075961,0.020294964285714284,0.011220244781777723,28,0,0,0,0,113,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,273869920055177729,"COPY  ( SELECT chamber AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE chamber IS NOT NULL GROUP BY chamber ORDER BY count DESC, chamber LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1858.726167,1858.726167,1858.726167,1858.726167,0,25,0,2725,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1584361995236484270,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_data WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3.773977,3.773977,3.773977,3.773977,0,6,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4218885704516023986,COPY  ( SELECT * FROM public.person_assignment_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.244459,3.244459,3.244459,3.244459,0,2487,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7841255497901063543,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( $1 , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_politician_behavioral_trends ) SELECT * FROM temporal_buckets WHERE rn = $2 ORDER BY time_bucket DESC LIMIT $3 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,155.770536,155.770536,155.770536,155.770536,0,26,2606,0,0,0,0,0,0,0,523,524,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-311473351152926507,"COPY  ( SELECT origin AS value, COUNT ( * ) AS count FROM document_element WHERE origin IS NOT NULL GROUP BY origin ORDER BY count DESC, origin LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.480878,58.480878,58.480878,58.480878,0,36,1190,34642,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4791923981280926999,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_party_summary LIMIT $2),0,0,0,0,0,0,1,0.004819,0.004819,0.004819,0.004819,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,498642402500548654,"COPY  ( SELECT 'Summary of Distinct Value Extractions' AS info, COUNT ( * ) AS file_count FROM ( SELECT 1 ) x ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.066234,0.066234,0.066234,0.066234,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1255500683556144466,SELECT COUNT(*) FROM public.view_application_action_event_page_modes_hourly_summary,0,0,0,0,0,0,1,0.20798799999999998,0.20798799999999998,0.20798799999999998,0.20798799999999998,0,1,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2476162423012049141,"CREATE OR REPLACE FUNCTION cia_classify_temporal_view(p_viewname text)
RETURNS TABLE (temporal_granularity text, samples_per_bucket integer)
LANGUAGE sql
IMMUTABLE
AS $$
    SELECT
        CASE 
            -- Daily granularity: 2 samples per day over last 30 days (60 samples max)
            WHEN p_viewname LIKE '%_daily%' THEN 'daily'
            -- Weekly granularity: 2 samples per week over last 6 months (52 samples max)
            WHEN p_viewname LIKE '%_weekly%' THEN 'weekly'
            -- Monthly granularity: 2 samples per month over last 3 years (72 samples max)
            WHEN p_viewname LIKE '%_monthly%' THEN 'monthly'
            -- Annual granularity: 2 samples per year over full history
            WHEN p_viewname LIKE '%_annual%' THEN 'annual'
            -- Temporal trend views: mixed strategy (all available time periods)
            WHEN p_viewname LIKE '%_temporal%' OR p_viewname LIKE '%_trend%' 
                 OR p_viewname LIKE '%_evolution%' OR p_viewname LIKE '%_momentum%' THEN 'temporal_trend'
            -- Non-temporal views: use random sampling
            ELSE 'non_temporal'
        END AS temporal_granularity,
        CASE 
            WHEN p_viewname LIKE '%_daily%' THEN 2
            WHEN p_viewname LIKE '%_weekly%' THEN 2
            WHEN p_viewname LIKE '%_monthly%' THEN 2
            WHEN p_viewname LIKE '%_annual%' THEN 2
            WHEN p_viewname LIKE '%_temporal%' OR p_viewname LIKE '%_trend%' 
                 OR p_viewname LIKE '%_evolution%' OR p_viewname LIKE '%_momentum%' THEN 1
            ELSE 0
        END AS samples_per_bucket;
$$",0,0,0,0,0,0,2,114.723213,0.264943,114.45827,57.3616065,57.0966635,0,136,9,0,0,0,0,0,0,0,0,0,0,0,0,12,0,4400,0,0,0,0,0,0,0,0
10,16385,t,-6523034632883090646,"COPY  ( SELECT vote AS value, COUNT ( * ) AS count FROM vote_data WHERE vote IS NOT NULL GROUP BY vote ORDER BY count DESC, vote LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,371.466203,371.466203,371.466203,371.466203,0,4,8632,78819,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8790876383867405784,"COPY  ( SELECT document_name AS value, COUNT ( * ) AS count FROM document_element WHERE document_name IS NOT NULL GROUP BY document_name ORDER BY count DESC, document_name LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.516478,61.516478,61.516478,61.516478,0,95,905,34930,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3066644437915459195,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_annual,0,0,0,0,0,0,2,234.036316,68.761938,165.274378,117.018158,48.256220000000006,48,6915,2177,41,6,0,0,0,0,0,0,0,0,0,0,501,8,69162,0,0,0,0,0,0,0,0
10,16385,f,3583576816901266084,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,25.158648,25.158648,25.158648,25.158648,0,76,3736,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4194991235280545150,"COPY  ( SELECT parties AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE parties IS NOT NULL GROUP BY parties ORDER BY count DESC, parties LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,679.684585,679.684585,679.684585,679.684585,0,183,38,683,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2534716312390675673,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_weekly,0,0,0,0,0,0,2,381.599268,72.955356,308.643912,190.799634,117.844278,10940,11069,648,311,392,0,0,0,0,320,646,0,0,0,0,11515,43,2960716,0,0,0,0,0,0,0,0
10,16385,f,1025945129509657008,SELECT COUNT(*)                FROM pg_matviews WHERE schemaname = $1,0,0,0,0,0,0,5,612.093297,0.623112,608.452849,122.41865940000001,243.01716502830863,5,1024,633,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7042355885938574846,"COPY  ( SELECT indicator_value AS value, COUNT ( * ) AS count FROM world_bank_data WHERE indicator_value IS NOT NULL GROUP BY indicator_value ORDER BY count DESC, indicator_value LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,61.585737,61.585737,61.585737,61.585737,0,1000,112,10253,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1558782015711004274,SELECT COUNT(*) FROM public.view_riksdagen_party_coalation_against_annual_summary,0,0,0,0,0,0,1,15.343167,15.343167,15.343167,15.343167,0,1,0,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8472757511439754250,"SELECT $1 || $2 ||
       $3 || $4
WHERE EXISTS (SELECT $5 FROM information_schema.columns WHERE table_schema = $6 AND table_name = $7 AND column_name = $8)",0,0,0,0,0,0,1,0.057557,0.057557,0.057557,0.057557,0,1,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7919020755192368782,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,27.05234,27.05234,27.05234,27.05234,0,134,3736,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1727930464514963854,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document_summary,0,0,0,0,0,0,2,998.0174629999999,410.175588,587.841875,499.00873149999995,88.83314349999996,2700,9086,8032,101,134,0,0,0,0,3704,3716,0,0,0,0,3137,5,873845,0,0,0,0,0,0,0,0
10,16385,t,-741854569545780071,COPY  ( SELECT * FROM public.portal ORDER BY random ( ) LIMIT 2 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,51.853598,51.853598,51.853598,51.853598,0,2,55,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-491545499724467678,COPY  ( SELECT * FROM public.document_content_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,25763.681783,25763.681783,25763.681783,25763.681783,0,300,533,9338,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8435759371705437097,SELECT COUNT(*) FROM public.view_politician_behavioral_trends,0,0,0,0,0,0,1,33.278928,33.278928,33.278928,33.278928,0,1,2604,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4972366361168189952,COPY  ( SELECT * FROM public.qrtz_cron_triggers ORDER BY random ( ) LIMIT 4 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,63.548747,63.548747,63.548747,63.548747,0,4,58,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,996681340746246903,SELECT COUNT(*) FROM public.view_ministry_effectiveness_trends,0,0,0,0,0,0,1,258.508445,258.508445,258.508445,258.508445,0,1,3188,3964,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,58,2.456233,0,0,1,1.464991,1,23.932924
10,16385,f,8800264462073631566,"COPY  ( SELECT processed_in AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE processed_in IS NOT NULL GROUP BY processed_in ORDER BY count DESC, processed_in LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,19.58138,19.58138,19.58138,19.58138,0,1000,2725,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4957664379216357048,COPY  ( SELECT * FROM public.person_assignment_data ORDER BY random ( ) LIMIT 2487 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,5.724248,5.724248,5.724248,5.724248,0,2487,34,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8144817099404001016,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_annual LIMIT $2),0,0,0,0,0,0,1,0.0038770000000000002,0.0038770000000000002,0.0038770000000000002,0.0038770000000000002,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5679122347572929819,COPY  ( SELECT * FROM public.document_reference_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,49.502238,49.502238,49.502238,49.502238,0,300,0,3287,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6867926316604806813,COPY  ( SELECT * FROM public.document_activity_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,111.960742,111.960742,111.960742,111.960742,0,300,37,5001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,477413608862185355,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_ballot_decision_party_summary,0,0,0,0,0,0,2,3179.8662170000002,299.074583,2880.791634,1589.9331085000001,1290.8585255,69116,31917,7575,3671,3719,0,0,0,0,4667,4711,0,0,0,0,69780,92,31211031,0,0,0,0,0,0,0,0
10,16385,t,2341549750268375534,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_weekly ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,990.703618,990.703618,990.703618,990.703618,0,500,2202,636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8343709998364821431,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_summary_monthly LIMIT $2),0,0,0,0,0,0,1,0.004177,0.004177,0.004177,0.004177,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7438966839548707488,COPY  ( SELECT * FROM public.against_proposal_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,20.681371,20.681371,20.681371,20.681371,0,300,37,685,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5682503274876892782,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_data WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.726625,0.726625,0.726625,0.726625,0,63,340,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
16384,16385,f,1484064514370518425,"SELECT pg_catalog.upper(object_type),
       object_identity
  FROM pg_catalog.pg_event_trigger_dropped_objects()
 WHERE pg_catalog.lower(object_type) operator(pg_catalog.<>) $1
   AND schema_name operator(pg_catalog.<>) $2",0,0,0,0,0,0,2,1.655477,0.012845,1.642632,0.8277385,0.8148935,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6313085444931695791,"COPY  ( SELECT target AS value, COUNT ( * ) AS count FROM vote_meta_data WHERE target IS NOT NULL GROUP BY target ORDER BY count DESC, target LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.081142,0.081142,0.081142,0.081142,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3793578130696151253,"COPY  ( SELECT electoral_region AS value, COUNT ( * ) AS count FROM vote_data WHERE electoral_region IS NOT NULL GROUP BY electoral_region ORDER BY count DESC, electoral_region LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,298.31956,298.31956,298.31956,298.31956,0,30,18,87330,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4529174841376523073,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , decision_day ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , decision_day ) ORDER BY random ( ) ) AS rn FROM public.view_decision_temporal_trends ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 187 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,236.271914,236.271914,236.271914,236.271914,0,39,295636,8372,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4777256229279038567,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_ballot_decision_politician_summary LIMIT $2),0,0,0,0,0,0,1,0.01069,0.01069,0.01069,0.01069,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-345860135785742461,COPY  ( SELECT * FROM public.user_account ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.141816,2.141816,2.141816,2.141816,0,1,76,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5225463843642660833,COPY  ( SELECT * FROM public.application_configuration ORDER BY random ( ) LIMIT 14 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.410215,0.410215,0.410215,0.410215,0,14,65,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5957480074603075920,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_summary_monthly,0,0,0,0,0,0,2,27.548806,13.530388,14.018418,13.774403,0.24401500000000054,440,6768,918,17,22,0,0,0,0,0,0,0,0,0,0,891,8,145050,0,0,0,0,0,0,0,0
10,16385,f,-8199568919000454095,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.004237,0.004237,0.004237,0.004237,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2890738321363404,COPY  ( SELECT * FROM public.portal ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.558616,1.558616,1.558616,1.558616,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4161448351504743469,"DO $$
DECLARE
    table_count INTEGER;
    empty_count INTEGER := 0;
    non_empty_count INTEGER := 0;
    table_rec RECORD;
    row_count BIGINT;
BEGIN
    SELECT COUNT(*) INTO table_count 
    FROM pg_tables 
    WHERE schemaname = 'public';
    
    RAISE NOTICE 'Found % tables in public schema', table_count;
    RAISE NOTICE '';
    RAISE NOTICE 'Getting row counts from statistics (fast)...';
    RAISE NOTICE '';
    
    -- Count empty vs non-empty tables using pg_class statistics (fast)
    FOR table_rec IN 
        SELECT t.tablename,
               COALESCE(c.reltuples, 0)::BIGINT AS row_count
        FROM pg_tables t
        JOIN pg_class c ON c.relname = t.tablename
        JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
        WHERE t.schemaname = 'public'
        ORDER BY t.tablename
    LOOP
        IF table_rec.row_count > 0 THEN
            non_empty_count := non_empty_count + 1;
        ELSE
            empty_count := empty_count + 1;
        END IF;
    END LOOP;
    
    RAISE NOTICE '✓ Row count analysis complete';
    RAISE NOTICE '  Tables with data: %', non_empty_count;
    RAISE NOTICE '  Empty tables: %', empty_count;
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,2.62242,2.62242,2.62242,2.62242,0,0,1093,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1553221953313226905,"CREATE TEMP TABLE IF NOT EXISTS tmp_mv_refresh_state (
        schemaname  text NOT NULL,
        matviewname text NOT NULL,
        PRIMARY KEY (schemaname, matviewname)
    ) ON COMMIT PRESERVE ROWS",0,0,0,0,0,0,2,791.733743,20.148402,771.585341,395.8668715,375.71846949999997,0,1253,111,59,1,0,0,0,0,0,0,0,0,0,0,234,54,291911,0,0,0,0,0,0,0,0
10,16385,f,1685585884679675846,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM vote_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,346.206556,346.206556,346.206556,346.206556,0,24,112,87233,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.790823,0,0,1,0.423359,1,6.324693
10,16385,t,7943051336725749443,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC LIMIT 500 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.418662,7.418662,7.418662,7.418662,0,500,0,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7498069578485386973,ANALYZE public.view_riksdagen_committee_decision_type_summary,0,0,0,0,0,0,1,3.635759,3.635759,3.635759,3.635759,0,0,952,114,3,1,0,0,0,0,0,0,0,0,0,0,15,2,22089,0,0,0,0,0,0,0,0
10,16385,f,-3415800228619780236,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary_daily,0,0,0,0,0,0,2,601.07989,265.68882,335.39107,300.539945,34.85112499999998,21238,16329,163,713,773,0,0,0,0,3051,3057,0,0,0,0,21868,56,6583872,0,0,0,0,0,0,0,0
10,16385,f,-1655523342019290992,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.003836,0.003836,0.003836,0.003836,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7368150425044334427,COPY  ( SELECT * FROM public.person_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,19.958242000000002,19.958242000000002,19.958242000000002,19.958242000000002,0,2492,0,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5042802913910178751,ANALYZE public.view_riksdagen_committee_decisions,0,0,0,0,0,0,1,223.549621,223.549621,223.549621,223.549621,0,0,2751,1623,12,4,0,0,0,0,0,0,0,0,0,0,78,8,96470,0,0,0,0,0,0,0,0
10,16385,f,454986626092375764,COPY  ( SELECT * FROM public.committee_proposal_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,69.421338,69.421338,69.421338,69.421338,0,500,24,2836,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-141877066004497947,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary,0,0,0,0,0,0,1,585.794571,585.794571,585.794571,585.794571,0,0,5901,30416,25,7,0,0,0,0,0,0,0,0,0,0,148,17,180081,0,0,0,0,0,0,0,0
10,16385,f,-8881653396863016651,SELECT COUNT(*) FROM public.view_riksdagen_goverment_roles,0,0,0,0,0,0,1,5.901374,5.901374,5.901374,5.901374,0,1,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6891615386937920207,"COPY  ( SELECT gender AS value, COUNT ( * ) AS count FROM person_element WHERE gender IS NOT NULL GROUP BY gender ORDER BY count DESC, gender LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.0038569999999999998,0.0038569999999999998,0.0038569999999999998,0.0038569999999999998,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,7630280355707361936,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_politician_summary_annual ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,15.462019,15.462019,15.462019,15.462019,0,500,2895,994,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3033227397386527857,"COPY  ( SELECT detail_type AS value, COUNT ( * ) AS count FROM detail_data WHERE detail_type IS NOT NULL GROUP BY detail_type ORDER BY count DESC, detail_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3.934997,3.934997,3.934997,3.934997,0,6,516,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5516199160651666023,"COPY  ( SELECT process AS value, COUNT ( * ) AS count FROM document_activity_data WHERE process IS NOT NULL GROUP BY process ORDER BY count DESC, process LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,38.927832,38.927832,38.927832,38.927832,0,6,112,4896,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5386986995089442133,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM assignment_element WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.078116,0.078116,0.078116,0.078116,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8482561184163264767,ANALYZE public.view_riksdagen_politician_document_daily_summary,0,0,0,0,0,0,1,47.894179,47.894179,47.894179,47.894179,0,0,761,479,4,1,0,0,0,0,0,0,0,0,0,0,16,3,30927,0,0,0,0,0,0,0,0
10,16385,f,6035531942033281810,ANALYZE public.view_riksdagen_org_document_daily_summary,0,0,0,0,0,0,1,73.235057,73.235057,73.235057,73.235057,0,0,766,573,3,1,0,0,0,0,0,0,0,0,0,0,14,2,22975,0,0,0,0,0,0,0,0
10,16385,f,8525685650799091150,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_party_summary,0,0,0,0,0,0,2,48894.687871,3649.590751,45245.09712,24447.3439355,20797.753184499998,166996,46764,176954,5754,7430,0,0,0,0,184752,184990,0,0,0,0,168533,946,56640823,0,0,0,0,0,0,0,0
10,16385,f,-3692657799899278746,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM vote_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,339.181738,339.181738,339.181738,339.181738,0,9,8724,78621,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.75709,0,0,1,0.378346,1,6.045031
10,16385,f,8162883486582676232,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary,0,0,0,0,0,0,1,352.208377,352.208377,352.208377,352.208377,0,0,5253,3279,17,5,0,0,0,0,0,0,0,0,0,0,112,12,139738,0,0,0,0,0,0,0,0
10,16385,t,-3533040524696417580,"COPY  ( SELECT election_region AS value, COUNT ( * ) AS count FROM person_element WHERE election_region IS NOT NULL GROUP BY election_region ORDER BY count DESC, election_region LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.082564,0.082564,0.082564,0.082564,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8225590632394450009,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_modes_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $2 ) SELECT * FROM temporal_strata WHERE rn <= $3 LIMIT $4 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.319965,0.319965,0.319965,0.319965,0,10,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2589038814441208048,SELECT COUNT(*) FROM public.view_risk_score_evolution,0,0,0,0,0,0,1,4388.854309,4388.854309,4388.854309,4388.854309,0,1,66708,18692,0,0,0,0,0,0,6321,6374,0,0,0,0,0,0,0,86,6.875548,0,0,1,3.082998,1,51.286889
10,16385,f,9099451611194349596,"COPY  ( SELECT intressent_id AS value, COUNT ( * ) AS count FROM assignment_data WHERE intressent_id IS NOT NULL GROUP BY intressent_id ORDER BY count DESC LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,7.256119,7.256119,7.256119,7.256119,0,500,0,479,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-9060997590694032146,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM committee_document_data WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,48.907837,48.907837,48.907837,48.907837,0,31,0,300,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5598976059954092027,COPY  ( SELECT * FROM public.qrtz_scheduler_state ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,320.085405,320.085405,320.085405,320.085405,0,1,387,468,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1937960521282670458,COPY  ( SELECT * FROM public.jv_commit_property ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,19094.908423,19094.908423,19094.908423,19094.908423,0,200,114,26196,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3802367180998153294,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_monthly ORDER BY random ( ) LIMIT 220 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,383.648417,383.648417,383.648417,383.648417,0,220,1282,228,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8263829154062938930,COPY  ( SELECT * FROM public.databasechangelog ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,51.048474000000006,51.048474000000006,51.048474000000006,51.048474000000006,0,412,0,19,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4783393103489656493,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_ballot_decision_party_summary LIMIT $2),0,0,0,0,0,0,1,0.0045390000000000005,0.0045390000000000005,0.0045390000000000005,0.0045390000000000005,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6357806673740152695,SELECT COUNT(*)                      FROM pg_views WHERE schemaname = $1,0,0,0,0,0,0,1,0.5982459999999999,0.5982459999999999,0.5982459999999999,0.5982459999999999,0,1,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4246814279823315451,"COPY  ( SELECT document_format AS value, COUNT ( * ) AS count FROM document_element WHERE document_format IS NOT NULL GROUP BY document_format ORDER BY count DESC, document_format LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,54.654033,54.654033,54.654033,54.654033,0,1,808,35027,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-3625861076909970526,COPY  ( SELECT * FROM public.indicator_element ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.592845,11.592845,11.592845,11.592845,0,300,78,1202,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7817136189600111777,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,323.069036,323.069036,323.069036,323.069036,0,16,0,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6935556497914484849,COPY  ( SELECT * FROM public.document_activity_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,236.625626,236.625626,236.625626,236.625626,0,300,38,396,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-38141737868937864,"COPY  ( SELECT short_code AS value, COUNT ( * ) AS count FROM sweden_political_party WHERE short_code IS NOT NULL GROUP BY short_code ORDER BY count DESC, short_code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.029194,2.029194,2.029194,2.029194,0,30,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,5250530394949636798,SELECT COUNT(*) FROM public.view_riksdagen_voting_anomaly_detection,0,0,0,0,0,0,1,1127.13907,1127.13907,1127.13907,1127.13907,0,1,4773,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,4.551423,0,0,1,2.088765,1,47.891404
10,16385,f,-8956632759701949625,SELECT COUNT(*) FROM public.view_party_effectiveness_trends,0,0,0,0,0,0,1,42.554064000000004,42.554064000000004,42.554064000000004,42.554064000000004,0,1,0,2604,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6020268284620892884,"DROP FUNCTION IF EXISTS cia_tmp_rowcount(text, text)",0,0,0,0,0,0,2,201.784469,29.33118,172.453289,100.8922345,71.5610545,0,280,66,3,0,0,0,0,0,0,0,0,0,0,0,3,2,12424,0,0,0,0,0,0,0,0
10,16385,f,-2055942241530764054,COPY  ( SELECT * FROM public.jv_commit_property ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,18921.204294,18921.204294,18921.204294,18921.204294,0,200,0,26192,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0.181318,0,0,1,0.181408,1,1.565478
10,16385,t,6306562135648825081,COPY  ( SELECT * FROM public.document_proposal_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,377.709732,377.709732,377.709732,377.709732,0,300,38,456,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-247354889969116302,SELECT COUNT(*) FROM public.view_riksdagen_party_role_member,0,0,0,0,0,0,1,0.759075,0.759075,0.759075,0.759075,0,1,82,90,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,985150727636610821,"COPY  ( SELECT rm AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE rm IS NOT NULL GROUP BY rm ORDER BY count DESC, rm LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,12.053784,12.053784,12.053784,12.053784,0,26,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6865378226349601843,$1,0,0,0,0,0,0,2,0.006222,0.002785,0.003437,0.003111,0.0003259999999999999,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8973944630144950548,COPY  ( SELECT * FROM public.jv_snapshot ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,473018.050652,473018.050652,473018.050652,473018.050652,0,200,138,919032,598,568,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2944368422948160087,SELECT COUNT(*) FROM public.view_riksdagen_goverment,0,0,0,0,0,0,1,328.889321,328.889321,328.889321,328.889321,0,1,975,854,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,1.740643,1,20.810231,1,175.151763,1,111.538945
10,16385,t,2108515666852389996,"WITH table_counts AS (
    SELECT t.schemaname,
           t.tablename,
           COALESCE(c.reltuples, $1)::BIGINT AS row_count
    FROM pg_tables t
    JOIN pg_class c ON c.relname = t.tablename
    JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
    WHERE t.schemaname = $2
),
table_extract AS (
    SELECT schemaname,
           tablename,
           row_count,
           -- Smart sample size calculation:
           -- 1. Complete extraction for small tables (< threshold)
           -- 2. Extended samples for party/committee/person data
           -- 3. Extended samples for document/voting/worldbank data
           -- 4. Default sample size for others
           CASE 
               -- Complete extraction for small tables
               WHEN row_count <= $3::int THEN row_count
               -- Extended samples for party-related tables
               WHEN tablename ILIKE $4 OR tablename ILIKE $5 THEN 
                   LEAST($6::int, row_count)
               -- Extended samples for committee-related tables
               WHEN tablename ILIKE $7 OR tablename ILIKE $8 THEN 
                   LEAST($9::int, row_count)
               -- Extended samples for person/politician data
               WHEN tablename ILIKE $10 OR tablename ILIKE $11 
                   OR tablename ILIKE $12 THEN 
                   LEAST($13::int, row_count)
               -- Extended samples for document-related tables
               WHEN tablename ILIKE $14 OR tablename ILIKE $15 THEN 
                   LEAST($16::int, row_count)
               -- Extended samples for voting-related tables
               WHEN tablename ILIKE $17 OR tablename ILIKE $18 THEN 
                   LEAST($19::int, row_count)
               -- Extended samples for worldbank data
               WHEN tablename ILIKE $20 OR tablename ILIKE $21 
                   OR tablename ILIKE $22 THEN 
                   LEAST($23::int, row_count)
               -- Default sample size
               ELSE LEAST($24::int, row_count)
           END AS sample_rows,
           -- Extraction type for logging
           CASE 
               WHEN row_count <= $25::int THEN $26
               WHEN tablename ILIKE $27 OR tablename ILIKE $28 THEN $29
               WHEN tablename ILIKE $30 OR tablename ILIKE $31 THEN $32
               WHEN tablename ILIKE $33 OR tablename ILIKE $34 
                   OR tablename ILIKE $35 THEN $36
               WHEN tablename ILIKE $37 OR tablename ILIKE $38 THEN $39
               WHEN tablename ILIKE $40 OR tablename ILIKE $41 THEN $42
               WHEN tablename ILIKE $43 OR tablename ILIKE $44 
                   OR tablename ILIKE $45 THEN $46
               ELSE $47
           END AS extraction_type,
           CASE WHEN tablename LIKE $48 THEN tablename ELSE $49 || tablename END AS file_prefix
    FROM table_counts
    WHERE row_count > $50
)
SELECT format(
    $51 || $52 ||
    $53 || $54 ||
    $55 || $56,
    extraction_type,
    schemaname,
    tablename,
    sample_rows,
    row_count,
    schemaname,
    tablename,
    sample_rows,
    file_prefix,
    file_prefix
)
FROM table_extract
ORDER BY tablename",0,0,0,0,0,0,1,1.026535,1.026535,1.026535,1.026535,0,53,635,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1578374773981578026,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_party_summary_daily ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,12.547836,12.547836,12.547836,12.547836,0,500,0,354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,930417999954869239,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary_daily,0,0,0,0,0,0,1,156.629507,156.629507,156.629507,156.629507,0,0,5867,855,21,7,0,0,0,0,0,0,0,0,0,0,115,14,159651,0,0,0,0,0,0,0,0
10,16385,f,3407103995560819641,"COPY  ( SELECT parties AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE parties IS NOT NULL GROUP BY parties ORDER BY count DESC, parties LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,613.392304,613.392304,613.392304,613.392304,0,183,0,675,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,6033168451161270308,COPY  ( SELECT * FROM public.committee_proposal_component_0 ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.958712,1.958712,1.958712,1.958712,0,500,15,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3551006506809048098,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM person_element WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.077153,0.077153,0.077153,0.077153,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,8430272080165128853,COPY  ( SELECT * FROM public.document_data ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,57.247549,57.247549,57.247549,57.247549,0,300,80,3753,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3212356614368048969,COPY  ( SELECT 1 as test ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,0.12893,0.12893,0.12893,0.12893,0,1,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5548777905421293154,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE ( embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_daily_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL '30 days' ) SELECT * FROM temporal_strata WHERE rn <= 2 LIMIT 46 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.500543,0.500543,0.500543,0.500543,0,4,27,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7832858577965349251,COPY  ( SELECT * FROM public.detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,6.092420000000001,6.092420000000001,6.092420000000001,6.092420000000001,0,200,0,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4571491496811280543,REFRESH MATERIALIZED VIEW public.view_riksdagen_politician_document_daily_summary,0,0,0,0,0,0,2,264.81156699999997,117.943801,146.867766,132.40578349999998,14.461982499999994,117398,10104,8069,859,898,0,0,0,0,84,222,0,0,0,0,117729,2,10169818,0,0,0,0,0,0,0,0
10,16385,f,5312542210899176867,COPY  ( SELECT * FROM public.document_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,55.718257,55.718257,55.718257,55.718257,0,300,0,3736,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-1823732997129594085,"DO $$
DECLARE
    total_mvs INTEGER;
    mv_name TEXT;
BEGIN
    -- Get total count dynamically
    SELECT COUNT(*) INTO total_mvs FROM pg_matviews WHERE schemaname = 'public';
    
    RAISE NOTICE 'Found % materialized views in public schema', total_mvs;
    
    -- List all materialized views for reference
    FOR mv_name IN 
        SELECT matviewname FROM pg_matviews WHERE schemaname = 'public' ORDER BY matviewname
    LOOP
        RAISE NOTICE '  - %', mv_name;
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE 'Validation passed: All materialized views will be refreshed dynamically';
END $$",0,0,0,0,0,0,1,4.084074,4.084074,4.084074,4.084074,0,0,1418,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4536902960160041435,ANALYZE public.view_riksdagen_vote_data_ballot_politician_summary_annual,0,0,0,0,0,0,1,220.696191,220.696191,220.696191,220.696191,0,0,7638,1027,24,10,0,0,0,0,0,0,0,0,0,0,160,14,183686,0,0,0,0,0,0,0,0
10,16385,t,-3880936229158656698,"SELECT 
    m.schemaname || $1 || m.matviewname AS view_name,
    s.n_live_tup AS estimated_rows,
    pg_size_pretty(pg_total_relation_size(m.schemaname || $2 || m.matviewname)) AS total_size,
    s.last_analyze AS last_analyzed
FROM pg_matviews m
LEFT JOIN pg_stat_all_tables s ON s.schemaname = m.schemaname AND s.relname = m.matviewname
WHERE m.schemaname = $3
ORDER BY s.n_live_tup DESC NULLS LAST
LIMIT $4",0,0,0,0,0,0,1,10.075637,10.075637,10.075637,10.075637,0,10,1734,45,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-2009218746981338303,"COPY  ( WITH temporal_strata AS ( SELECT *, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( $1 , embedded_id_created_date ) ORDER BY random ( ) ) AS rn FROM public.view_application_action_event_page_element_weekly_summary WHERE embedded_id_created_date >= CURRENT_DATE - INTERVAL $2 ) SELECT * FROM temporal_strata WHERE rn <= $3 LIMIT $4 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.255697,0.255697,0.255697,0.255697,0,10,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4155045913258407966,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_decision_type_summary,0,0,0,0,0,0,2,78.927549,39.113708,39.813841,39.4637745,0.35006649999999695,6686,8203,38,59,68,0,0,0,0,0,0,0,0,0,0,7073,25,796988,0,0,0,0,0,0,0,0
10,16385,f,-6582359452251153988,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_data WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,301.276434,301.276434,301.276434,301.276434,0,17,0,514,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,2168659935316841993,"COPY  ( SELECT committee_report AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE committee_report IS NOT NULL GROUP BY committee_report ORDER BY count DESC, committee_report LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,12.791731,12.791731,12.791731,12.791731,0,778,2839,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1684364791864405861,SELECT COUNT(*) FROM public.view_riksdagen_committee_parliament_member_proposal,0,0,0,0,0,0,1,462.728273,462.728273,462.728273,462.728273,0,1,6516,18059,0,0,0,0,0,0,4186,4201,0,0,0,0,0,0,0,39,2.498453,0,0,1,0.891102,1,19.836435
10,16385,f,10833512468253048,COPY  ( SELECT * FROM public.person_detail_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.672571,1.672571,1.672571,1.672571,0,2487,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-6052507119043505398,"COPY  ( SELECT ballot_type AS value, COUNT ( * ) AS count FROM vote_data WHERE ballot_type IS NOT NULL GROUP BY ballot_type ORDER BY count DESC, ballot_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,268.591581,268.591581,268.591581,268.591581,0,1,8628,78717,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.569223,0,0,1,0.258011,1,4.518934
10,16385,t,-4761507056991347060,"COPY  ( SELECT org_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE org_code IS NOT NULL GROUP BY org_code ORDER BY count DESC, org_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.083846,0.083846,0.083846,0.083846,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3341724097351342929,COPY  ( SELECT * FROM public.qrtz_job_details ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.063428,0.063428,0.063428,0.063428,0,4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2952731628582728995,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_politician_document LIMIT $2),0,0,0,0,0,0,1,0.0074340000000000005,0.0074340000000000005,0.0074340000000000005,0.0074340000000000005,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1890428851672728953,SELECT COUNT(*) FROM public.view_riksdagen_crisis_resilience_indicators,0,0,0,0,0,0,1,3810.66192,3810.66192,3810.66192,3810.66192,0,1,25841,178243,0,0,0,0,0,0,11412,11432,0,0,0,0,0,0,0,59,4.560992,1,242.309399,1,429.151127,1,279.061545
10,16385,t,1786104445266805939,"COPY  ( SELECT code AS value, COUNT ( * ) AS count FROM detail_element WHERE code IS NOT NULL GROUP BY code ORDER BY count DESC, code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.606876,1.606876,1.606876,1.606876,0,0,37,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4158864888232333058,"SELECT schemaname, viewname AS object_name, $1 AS object_type
        FROM pg_views
        WHERE schemaname = $2
          AND viewname != $3
          AND viewname != $4
        UNION ALL
        SELECT schemaname, matviewname AS object_name, $5 AS object_type
        FROM pg_matviews
        WHERE schemaname = $6
        ORDER BY object_name",0,0,0,0,0,0,1,1.3048140000000001,1.3048140000000001,1.3048140000000001,1.3048140000000001,0,82,684,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8521507165795639581,"COPY  ( SELECT winner AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE winner IS NOT NULL GROUP BY winner ORDER BY count DESC, winner LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,16.246011,16.246011,16.246011,16.246011,0,44,2835,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1523430487889920892,COPY  ( SELECT * FROM public.qrtz_scheduler_state ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,312.557007,312.557007,312.557007,312.557007,0,1,0,139,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8446487192462210209,COPY  ( SELECT * FROM public.jv_commit ORDER BY random ( ) LIMIT 200 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,31121.795275,31121.795275,31121.795275,31121.795275,0,200,51,59571,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4335700726042933519,REFRESH MATERIALIZED VIEW public.view_riksdagen_vote_data_ballot_politician_summary_daily,0,0,0,0,0,0,2,41034.517510000005,19368.515555,21666.001955,20517.258755000003,1148.743199999998,917952,106179,319096,45170,86278,0,0,0,0,349897,350313,0,0,0,0,923172,4563,418673272,0,0,0,0,0,0,0,0
10,16385,f,7512864040217976531,"SELECT t.tablename,
               COALESCE(c.reltuples, $1)::BIGINT AS row_count
        FROM pg_tables t
        JOIN pg_class c ON c.relname = t.tablename
        JOIN pg_namespace n ON n.oid = c.relnamespace AND n.nspname = t.schemaname
        WHERE t.schemaname = $2
        ORDER BY t.tablename",0,0,0,0,0,0,1,0.764898,0.764898,0.764898,0.764898,0,93,634,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3626419790848417270,COPY  ( SELECT * FROM public.indicator_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,11.3326,11.3326,11.3326,11.3326,0,300,0,1191,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7201423780298819011,SELECT COUNT(*) FROM public.view_riksdagen_politician_influence_metrics,0,0,0,0,0,0,1,38991.629482000004,38991.629482000004,38991.629482000004,38991.629482000004,0,1,381,102790,0,0,0,0,0,0,767700,769039,0,0,0,0,0,0,0,63,2.819129,0,0,1,1.284556,1,28.96232
10,16385,t,-2099905429043383653,COPY  ( SELECT * FROM public.view_riksdagen_party_ballot_support_annual_summary ORDER BY random ( ) LIMIT 500 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,4628.198152,4628.198152,4628.198152,4628.198152,0,500,352502,3082,0,0,0,0,0,0,2112,2123,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-698687744414785459,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_element WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,149.343671,149.343671,149.343671,149.343671,0,43,16,35816,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4163036327226108106,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary_annual,0,0,0,0,0,0,1,5.783434,5.783434,5.783434,5.783434,0,0,4838,740,18,3,0,0,0,0,0,0,0,0,0,0,102,15,141331,0,0,0,0,0,0,0,0
10,16385,f,5081349731140873853,"SELECT COUNT(*)                       FROM pg_tables 
    WHERE schemaname = $1",0,0,0,0,0,0,1,0.5773659999999999,0.5773659999999999,0.5773659999999999,0.5773659999999999,0,1,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,606515503679124590,"DO $$
DECLARE
    mv_record RECORD;
    v_success INT := 0;
    v_failed INT := 0;
    v_start TIMESTAMP;
    v_duration INTERVAL;
    total_mvs INTEGER;
    mv_count INTEGER := 0;
BEGIN
    -- Get total count for progress reporting
    SELECT COUNT(*) INTO total_mvs FROM pg_matviews WHERE schemaname = 'public';
    
    -- Refresh all materialized views dynamically
    FOR mv_record IN 
        SELECT schemaname, matviewname
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY matviewname
    LOOP
        BEGIN
            mv_count := mv_count + 1;
            v_start := clock_timestamp();
            RAISE NOTICE '[%/%] Refreshing: %.%...', mv_count, total_mvs,
                mv_record.schemaname, mv_record.matviewname;
            
            EXECUTE format('REFRESH MATERIALIZED VIEW %I.%I', 
                mv_record.schemaname, mv_record.matviewname);
            
            v_duration := clock_timestamp() - v_start;
            RAISE NOTICE '✓ Refreshed %.% in %', 
                mv_record.schemaname, mv_record.matviewname, v_duration;
            v_success := v_success + 1;
        EXCEPTION WHEN OTHERS THEN
            RAISE WARNING '✗ Failed to refresh %.%: %', 
                mv_record.schemaname, mv_record.matviewname, SQLERRM;
            v_failed := v_failed + 1;
        END;
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE '===========================================';
    RAISE NOTICE '--- REFRESH SUMMARY ---';
    RAISE NOTICE '===========================================';
    RAISE NOTICE 'Total views: %', total_mvs;
    RAISE NOTICE 'Successful: %', v_success;
    RAISE NOTICE 'Failed: %', v_failed;
    RAISE NOTICE '===========================================';
    
    IF v_failed > 0 THEN
        RAISE WARNING 'Some view refreshes failed. Check logs above for details.';
    END IF;
END $$",0,0,0,0,0,0,1,338514.099036,338514.099036,338514.099036,338514.099036,0,0,834275,1394778,284477,556768,0,0,0,0,918363,921791,0,0,0,0,6513874,17083,2542343575,0,0,0,0,0,0,0,0
10,16385,t,-508207853896656025,COPY  ( SELECT * FROM public.person_data ORDER BY random ( ) LIMIT 2492 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,25.648482,25.648482,25.648482,25.648482,0,2492,100,349,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5042771115056134026,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,15.827991,15.827991,15.827991,15.827991,0,4,2729,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2496476059890724629,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_ballot_decision_politician_summary,0,0,0,0,0,0,2,148628.338418,27385.557572,121242.780846,74314.169209,46928.611636999995,3156356,388625,462880,183574,363019,0,0,0,0,282258,286768,0,0,0,0,3159809,2844,1552091328,0,0,0,0,0,0,0,0
10,16385,t,4301436274434778961,"SELECT $1 ||
       $2 ||
       $3",0,0,0,0,0,0,2,0.003516,0.001703,0.001813,0.001758,5.499999999999993e-05,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4425397151049427388,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM person_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1.4741190000000002,1.4741190000000002,1.4741190000000002,1.4741190000000002,0,246,331,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,5106495086450362632,COPY  ( SELECT * FROM public.document_reference_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,219.877996,219.877996,219.877996,219.877996,0,300,37,164,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,74559815457862905,COPY  ( SELECT * FROM public.databasechangeloglock ORDER BY random ( ) LIMIT 1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,3.536747,3.536747,3.536747,3.536747,0,1,45,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7431099454512653578,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_daily LIMIT $2),0,0,0,0,0,0,1,0.008296,0.008296,0.008296,0.008296,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-7412288205320054606,COPY  ( SELECT * FROM public.agency ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,2.683895,2.683895,2.683895,2.683895,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5567756162003004796,"COPY  ( SELECT status AS value, COUNT ( * ) AS count FROM document_activity_data WHERE status IS NOT NULL GROUP BY status ORDER BY count DESC, status LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,38.956986,38.956986,38.956986,38.956986,0,2,215,4801,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-7149767135925760901,DROP TABLE IF EXISTS cia_view_row_counts,0,0,0,0,0,0,1,5.867345,5.867345,5.867345,5.867345,0,0,51,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1047683920274307472,"COPY  ( SELECT iso_2code AS value, COUNT ( * ) AS count FROM country_element WHERE iso_2code IS NOT NULL GROUP BY iso_2code ORDER BY count DESC, iso_2code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.299388,0.299388,0.299388,0.299388,0,211,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3902833771723446276,ANALYZE public.view_riksdagen_vote_data_ballot_party_summary_weekly,0,0,0,0,0,0,1,76.675101,76.675101,76.675101,76.675101,0,0,5151,469,16,6,0,0,0,0,0,0,0,0,0,0,98,10,121731,0,0,0,0,0,0,0,0
10,16385,f,3347936750016142216,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_monthly LIMIT $2),0,0,0,0,0,0,1,0.00533,0.00533,0.00533,0.00533,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,3822409440667416686,"DO $$
DECLARE
    view_record RECORD;
    view_count INTEGER := 0;
    total_views INTEGER;
    row_count BIGINT;
    extract_count INTEGER := 0;
BEGIN
    -- Get total view count (excluding coalition alignment matrix)
    SELECT COUNT(*) INTO total_views
    FROM (
        SELECT viewname FROM pg_views 
        WHERE schemaname = 'public' 
          AND viewname != 'view_riksdagen_intelligence_dashboard'
        UNION ALL
        SELECT matviewname FROM pg_matviews 
        WHERE schemaname = 'public'
    ) v;
    
    RAISE NOTICE '';
    RAISE NOTICE 'Phase 1: Analyzing % views for row counts', total_views;
    RAISE NOTICE 'Excluding: view_riksdagen_coalition_alignment_matrix (complex query)';
    RAISE NOTICE 'This may take several minutes for complex views...';
    RAISE NOTICE '';
    
    -- Process each view with progress BEFORE the slow operation
    FOR view_record IN 
        SELECT schemaname, viewname AS object_name, 'VIEW' AS object_type
        FROM pg_views
        WHERE schemaname = 'public'
          AND viewname != 'view_riksdagen_coalition_alignment_matrix'
          AND viewname != 'view_riksdagen_intelligence_dashboard'
        UNION ALL
        SELECT schemaname, matviewname AS object_name, 'MATERIALIZED VIEW' AS object_type
        FROM pg_matviews
        WHERE schemaname = 'public'
        ORDER BY object_name
    LOOP
        view_count := view_count + 1;
        
        -- Always show what we're about to analyze
        RAISE NOTICE '→ [%/%] Analyzing: %.% (%)', 
            view_count, total_views, 
            view_record.schemaname, view_record.object_name,
            view_record.object_type;
        
        -- Use fast pg_class statistics for materialized views, slow COUNT for regular views
        IF view_record.object_type = 'MATERIALIZED VIEW' THEN
            -- Fast: use cached statistics from pg_class
            SELECT COALESCE(c.reltuples, 0)::BIGINT INTO row_count
            FROM pg_class c
            JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE n.nspname = view_record.schemaname
              AND c.relname = view_record.object_name;
        ELSE
            -- Regular views need actual COUNT (no cached stats)
            row_count := cia_tmp_rowcount(view_record.schemaname, view_record.object_name);
        END IF;
        
        -- Cache result in temp table for Phase 2 reuse
        INSERT INTO cia_view_row_counts(schemaname, viewname, view_type, row_count)
        VALUES (view_record.schemaname, view_record.object_name, view_record.object_type, row_count);
        
        -- Show result immediately after
        IF row_count > 0 THEN
            RAISE NOTICE '  ✓ Contains % rows', row_count;
            extract_count := extract_count + 1;
        ELSE
            RAISE NOTICE '  ⚠️  EMPTY (0 rows)';
        END IF;
        RAISE NOTICE '';
    END LOOP;
    
    RAISE NOTICE '';
    RAISE NOTICE '✓ Phase 1 complete: % of % views have data', extract_count, total_views;
    RAISE NOTICE '';
END $$",0,0,0,0,0,0,1,62209.624577,62209.624577,62209.624577,62209.624577,0,0,2763780,573956,5,15,81,0,1,1,835325,836843,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-2104824570254097199,"COPY  ( WITH temporal_buckets AS ( SELECT *, DATE_TRUNC ( 'month' , period_end ) AS time_bucket, ROW_NUMBER ( ) OVER ( PARTITION BY DATE_TRUNC ( 'month' , period_end ) ORDER BY random ( ) ) AS rn FROM public.view_politician_behavioral_trends ) SELECT * FROM temporal_buckets WHERE rn = 1 ORDER BY time_bucket DESC LIMIT 500 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,157.538873,157.538873,157.538873,157.538873,0,26,2632,5,0,0,0,0,0,0,523,524,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-910392483279635299,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_committee_decisions LIMIT $2),0,0,0,0,0,0,1,0.00527,0.00527,0.00527,0.00527,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4500833535435516029,"COPY  ( SELECT doc_type AS value, COUNT ( * ) AS count FROM document_element WHERE doc_type IS NOT NULL GROUP BY doc_type ORDER BY count DESC, doc_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,62.175978,62.175978,62.175978,62.175978,0,92,517,35315,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3036083325023429857,"COPY  ( SELECT proposal_type AS value, COUNT ( * ) AS count FROM against_proposal_data WHERE proposal_type IS NOT NULL GROUP BY proposal_type ORDER BY count DESC, proposal_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,13.907843,13.907843,13.907843,13.907843,0,1,675,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4523880390929294716,"COPY  ( SELECT sub_type AS value, COUNT ( * ) AS count FROM document_data WHERE sub_type IS NOT NULL GROUP BY sub_type ORDER BY count DESC, sub_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,24.885589,24.885589,24.885589,24.885589,0,16,3738,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,6322041146789395679,"COPY  ( SELECT document_type AS value, COUNT ( * ) AS count FROM document_data WHERE document_type IS NOT NULL GROUP BY document_type ORDER BY count DESC, document_type LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,151.783582,151.783582,151.783582,151.783582,0,4,0,3736,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4715837110055084275,"COPY  ( SELECT decision_type AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE decision_type IS NOT NULL GROUP BY decision_type ORDER BY count DESC, decision_type LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,56.800496,56.800496,56.800496,56.800496,0,7,44,2839,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6922475090301816933,COPY  ( SELECT * FROM public.person_detail_data ORDER BY random ( ) LIMIT 2487 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,50.41928,50.41928,50.41928,50.41928,0,2487,34,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,1327778340389237711,"COPY  ( SELECT short_code AS value, COUNT ( * ) AS count FROM sweden_political_party WHERE short_code IS NOT NULL GROUP BY short_code ORDER BY count DESC, short_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,3.775141,3.775141,3.775141,3.775141,0,30,37,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8574416491844127116,"COPY  ( SELECT schemaname AS schema, matviewname AS view_name, ( SELECT n_live_tup FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS estimated_rows, ( SELECT n_dead_tup FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS dead_rows, ( SELECT last_analyze FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS last_analyzed, ( SELECT last_autoanalyze FROM pg_stat_all_tables WHERE schemaname = m.schemaname AND relname = m.matviewname ) AS last_auto_analyzed FROM pg_matviews m WHERE schemaname = $1 ORDER BY estimated_rows DESC NULLS LAST ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,2.77334,2.77334,2.77334,2.77334,0,28,6270,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,4505663544546256099,COPY  ( SELECT * FROM public.against_proposal_data ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,12.427071,12.427071,12.427071,12.427071,0,300,0,675,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,1213370246401210228,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_org_document_daily_summary LIMIT $2),0,0,0,0,0,0,1,0.004769000000000001,0.004769000000000001,0.004769000000000001,0.004769000000000001,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-8024243936388867082,"COPY  ( SELECT org AS value, COUNT ( * ) AS count FROM document_element WHERE org IS NOT NULL GROUP BY org ORDER BY count DESC, org LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,57.472088,57.472088,57.472088,57.472088,0,311,232,35606,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4742177102316246047,"COPY  ( SELECT chamber AS value, COUNT ( * ) AS count FROM document_proposal_data WHERE chamber IS NOT NULL GROUP BY chamber ORDER BY count DESC, chamber LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,1954.763018,1954.763018,1954.763018,1954.763018,0,25,64,2731,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-3834726387479177005,"COPY  ( SELECT winner AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE winner IS NOT NULL GROUP BY winner ORDER BY count DESC, winner LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,16.066135,16.066135,16.066135,16.066135,0,44,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-76139388212076228,"SELECT format(
    $1 || $2 ||
    $3 || $4,
    col, col, col, col, col, col
)
FROM unnest(ARRAY[$5, $6]) AS col
WHERE EXISTS (SELECT $7 FROM information_schema.columns WHERE table_schema = $8 AND table_name = $9 AND column_name = col)",0,0,0,0,0,0,1,0.069249,0.069249,0.069249,0.069249,0,2,63,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-5489678730941963521,"COPY  ( SELECT person_person_container_data_0 AS value, COUNT ( * ) AS count FROM person_container_data WHERE person_person_container_data_0 IS NOT NULL GROUP BY person_person_container_data_0 ORDER BY count DESC, person_person_container_data_0 LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.008234,0.008234,0.008234,0.008234,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7187836880505548044,"COPY  ( SELECT vote AS value, COUNT ( * ) AS count FROM vote_data WHERE vote IS NOT NULL GROUP BY vote ORDER BY count DESC, vote LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,360.599031,360.599031,360.599031,360.599031,0,4,8532,78813,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0.81005,0,0,1,0.424261,1,6.534733
10,16385,f,3804950293618760755,SELECT COUNT(*) FROM public.view_riksdagen_person_signed_document_summary,0,0,0,0,0,0,1,53.461729999999996,53.461729999999996,53.461729999999996,53.461729999999996,0,1,3578,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5032403635021082081,COPY  ( SELECT * FROM public.committee_proposal_container ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,54.05116,54.05116,54.05116,54.05116,0,500,42,50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-1236184392896316324,"EXISTS (
                    SELECT $18
                    FROM tmp_mv_refresh_state s
                    WHERE s.schemaname  = mv_record.schemaname
                      AND s.matviewname = mv_record.matviewname
                )",0,0,0,0,0,0,1,0.007994,0.007994,0.007994,0.007994,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3349374830294349948,"COPY  ( SELECT lang AS value, COUNT ( * ) AS count FROM document_element WHERE lang IS NOT NULL GROUP BY lang ORDER BY count DESC, lang LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,58.557401,58.557401,58.557401,58.557401,0,23,1094,34738,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,646875433578360539,COPY  ( SELECT * FROM public.document_status_container ORDER BY random ( ) LIMIT 300 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,26.009966,26.009966,26.009966,26.009966,0,300,23,1100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-5448743280689360884,COPY  ( SELECT * FROM public.view_riksdagen_party_momentum_analysis ORDER BY random ( ) LIMIT 441 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,3939.957956,3939.957956,3939.957956,3939.957956,0,441,155,87331,0,0,0,0,0,0,39502,39567,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,487241132909465451,SELECT COUNT(*) FROM public.view_committee_productivity,0,0,0,0,0,0,1,428.811975,428.811975,428.811975,428.811975,0,1,479,8651,0,0,0,0,0,0,1395,1400,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,4827987536070876738,"COPY  ( SELECT party AS value, COUNT ( * ) AS count FROM vote_data WHERE party IS NOT NULL GROUP BY party ORDER BY count DESC, party LIMIT 2000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,340.187724,340.187724,340.187724,340.187724,0,9,8727,78621,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,8204129127152496996,"COPY  ( SELECT ballot_summary_item AS value, COUNT ( * ) AS count FROM committee_proposal_data WHERE ballot_summary_item IS NOT NULL GROUP BY ballot_summary_item ORDER BY count DESC, ballot_summary_item LIMIT $1 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,26.626185,26.626185,26.626185,26.626185,0,1000,2831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-6310021986213910992,COPY  ( SELECT * FROM public.document_person_reference_da_0 ORDER BY random ( ) LIMIT 500 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,67.995809,67.995809,67.995809,67.995809,0,500,41,3586,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,3624007798430595726,SELECT EXISTS(SELECT $1 FROM public.view_riksdagen_vote_data_ballot_politician_summary_weekly LIMIT $2),0,0,0,0,0,0,1,0.007613,0.007613,0.007613,0.007613,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-4523881574894664531,REFRESH MATERIALIZED VIEW public.view_riksdagen_committee_decisions,0,0,0,0,0,0,2,2114.18921,316.785402,1797.403808,1057.094605,740.309203,89668,16715,6495,2759,4880,0,0,0,0,621,613,0,0,0,0,90677,573,28363379,0,0,0,0,0,0,0,0
10,16385,t,1902870634554830662,COPY  ( SELECT * FROM public.sweden_political_party ORDER BY random ( ) LIMIT 40 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,1.950379,1.950379,1.950379,1.950379,0,40,39,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,-8152647009651529817,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_weekly ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,132.001759,132.001759,132.001759,132.001759,0,670,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,2089709053049058085,COPY  ( SELECT * FROM public.country_element ORDER BY random ( ) LIMIT $1 ) TO STDOUT CSV HEADER,0,0,0,0,0,0,1,0.32813200000000003,0.32813200000000003,0.32813200000000003,0.32813200000000003,0,211,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,t,-4641253426442325352,"COPY  ( SELECT role_code AS value, COUNT ( * ) AS count FROM assignment_element WHERE role_code IS NOT NULL GROUP BY role_code ORDER BY count DESC, role_code LIMIT 1000 ) TO STDOUT WITH CSV HEADER",0,0,0,0,0,0,1,0.082473,0.082473,0.082473,0.082473,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
10,16385,f,7323889942907913181,COPY  ( SELECT * FROM public.view_riksdagen_vote_data_ballot_summary_annual ORDER BY random ( ) LIMIT $1 ) TO STDOUT WITH CSV HEADER,0,0,0,0,0,0,1,2.560735,2.560735,2.560735,2.560735,0,24,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
