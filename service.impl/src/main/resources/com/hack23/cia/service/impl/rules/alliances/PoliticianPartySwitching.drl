package com.hack23.cia.service.impl.rules.alliances

import org.kie.api.runtime.KieRuntime

import com.hack23.cia.model.internal.application.data.politician.impl.ViewRiksdagenPolitician
import com.hack23.cia.model.internal.application.data.rules.impl.Status
import com.hack23.cia.service.impl.rules.PoliticianComplianceCheckImpl
import com.hack23.cia.service.api.action.kpi.ComplianceCheck

rule "Politician changed party multiple times"
    dialect "java"
    when
        $p : PoliticianComplianceCheckImpl(
            politician.activeParliament && 
            politician.party != "-" && 
            eval( $p.getFrequentPartySwitchingCount() > 2 )
        )
    then
        $p.addViolation(
            Status.CRITICAL, 
            "PoliticianPartySwitching", 
            "Behavior", 
            kcontext.getRule().getName(), 
            "Multiple party switches"
        );
end

rule "Rule #10: Politician changed party multiple times (annual check)"
    when
        $p : PoliticianComplianceCheckImpl(
              annualSummary != null,
              // Possibly a method that returns how many party switches this year
              eval( $p.getAnnualSummary().getPartySwitchCount() > 2 )
        )
    then
        $p.addViolation(
            Status.MAJOR,
            "Alliances",
            "FrequentPartySwitch",
            kcontext.getRule().getName(),
            "Politician changed party more than twice this year"
        );
end
