package com.hack23.cia.service.impl.rules.politician

import org.kie.api.runtime.KieRuntime

import com.hack23.cia.model.internal.application.data.politician.impl.ViewRiksdagenPolitician
import com.hack23.cia.model.internal.application.data.rules.impl.Status
import com.hack23.cia.service.impl.rules.PoliticianComplianceCheckImpl

rule "Politician with extremely low collaboration - below 1%"
	dialect "java"
	salience 10
    when
        // Threshold validated: P90 = 1.3%, capturing bottom 10% truly isolated politicians
        // Empirical data: 99.2% of politicians have <10% collaboration (old threshold meaningless)
        // New threshold <1% identifies genuinely isolated behavior in partisan environment
        $p : PoliticianComplianceCheckImpl(politician.active && politician.totalDocuments > 10 && politician.collaborationPercentage < 1.0 && politician.collaborationPercentage > 0)
    then
    	$p.addViolation( Status.MINOR, "PoliticianIsolatedBehavior","Behavior", kcontext.getRule().getName(),"ExtremelyLowCollaboration");
end

rule "Politician with zero collaboration"
	dialect "java"
	salience 50
    when
        // Threshold validated: 84.4% of active politicians have 0% collaboration
        // This reflects highly partisan Swedish Parliament, but still warrants flagging
        // Distinguishes complete isolation from minimal cross-party engagement
        $p : PoliticianComplianceCheckImpl(politician.active && politician.totalDocuments > 20 && politician.collaborationPercentage == 0)
    then
    	$p.addViolation( Status.MAJOR, "PoliticianIsolatedBehavior","Behavior", kcontext.getRule().getName(),"ZeroCollaboration");
end

rule "Politician with no multi-party collaboration"
	dialect "java"
	salience 100
    when
        // Threshold validated: 83.2% of politicians with >20 docs have 0 multi-party motions
        // Binary indicator of structural isolation - most severe collaboration failure
        // Distinguishes partisan operators from true consensus-builders
        $p : PoliticianComplianceCheckImpl(politician.active && politician.totalDocuments > 20 && politician.multiPartyMotions == 0)
    then
    	$p.addViolation( Status.CRITICAL, "PoliticianIsolatedBehavior","Behavior", kcontext.getRule().getName(),"NoMultiPartyCollaboration");
end
