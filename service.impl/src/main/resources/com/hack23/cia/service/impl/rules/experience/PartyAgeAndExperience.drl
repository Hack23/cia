package com.hack23.cia.service.impl.rules.experience

import org.kie.api.runtime.KieRuntime

import com.hack23.cia.model.internal.application.data.party.impl.ViewRiksdagenPartySummary
import com.hack23.cia.model.internal.application.data.rules.impl.Status
import com.hack23.cia.service.impl.rules.PartyComplianceCheckImpl

rule "Party with low headcount but claims nationwide reach"
    dialect "java"
    when
        $p : PartyComplianceCheckImpl(
            party.activeParliament && 
            party.headCount < 10 && 
            party.claimsNationwideReach
        )
    then
        $p.addViolation(
            Status.MAJOR, 
            "PartyLowHeadcount", 
            "Compliance", 
            kcontext.getRule().getName(), 
            "Low headcount but claims nationwide reach"
        );
end

rule "Party reliant on very small headcount"
    when
        $p : PartyComplianceCheckImpl(
              annualSummary != null,
              eval( $p.getParty().getParty() != null ), 
              // Suppose we interpret 'headCount' for that party
              eval( $p.getParty().getHeadCount() < 5 )
        )
    then
        $p.addViolation(
            Status.MINOR,
            "Compliance",
            "SmallHeadcount",
            kcontext.getRule().getName(),
            "Party's membership is extremely small"
        );
end

rule "Party reliant on a small headcount"
    when
        $p : PartyComplianceCheckImpl(
              annualSummary != null,
              eval( $p.getParty().getParty() != null ), 
              eval( $p.getParty().getHeadCount() < 5 )
        )
    then
        $p.addViolation(
            Status.MINOR,
            "Compliance",
            "SmallHeadcount",
            kcontext.getRule().getName(),
            "Party's membership is extremely small"
        );
end
