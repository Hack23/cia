<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PartyLeaderUtil.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Citizen Intelligence Agency</a> &gt; <a href="index.source.html" class="el_package">com.hack23.cia.web.impl.ui.application.views.common.pagemode</a> &gt; <span class="el_source">PartyLeaderUtil.java</span></div><h1>PartyLeaderUtil.java</h1><pre class="source lang-java linenums">package com.hack23.cia.web.impl.ui.application.views.common.pagemode;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.hack23.cia.model.internal.application.data.party.impl.ViewRiksdagenPartyRoleMember;
import com.hack23.cia.model.internal.application.data.party.impl.ViewRiksdagenPartyRoleMember_;
import com.hack23.cia.service.api.ApplicationManager;

/**
 * Utility class for handling party leader related operations.
 */
public final class PartyLeaderUtil {

    /** The Constant ROLE_CODE_PARTILEDARE. */
    private static final String ROLE_CODE_PARTILEDARE = &quot;Partiledare&quot;;

    /**
     * Instantiates a new party leader util.
     */
    private PartyLeaderUtil() {
        // Utility class, no instantiation
    }

    /**
     * Checks if a person is a party leader.
     *
     * @param applicationManager the application manager
     * @param personId the person id
     * @return true, if the person is a party leader
     */
    public static boolean isPartyLeader(final ApplicationManager applicationManager, final String personId) {
<span class="fc" id="L34">        return getActiveRoles(applicationManager, personId).stream()</span>
<span class="fc" id="L35">                .anyMatch(PartyLeaderUtil::isPartyLeaderRole);</span>
    }

    /**
     * Fetches the party leader role for a person.
     *
     * @param applicationManager the application manager
     * @param personId the person id
     * @return the party leader role, or null if not found
     */
    public static ViewRiksdagenPartyRoleMember getPartyLeaderRole(final ApplicationManager applicationManager, final String personId) {
<span class="fc" id="L46">        return getActiveRoles(applicationManager, personId).stream()</span>
<span class="fc" id="L47">                .filter(PartyLeaderUtil::isPartyLeaderRole)</span>
<span class="fc" id="L48">                .findFirst()</span>
<span class="fc" id="L49">                .orElse(null);</span>
    }

    /**
     * Computes party leaders for a list of person IDs.
     *
     * @param applicationManager the application manager
     * @param personIds the person ids
     * @return a map of person ids to boolean indicating if they are party leaders
     */
    public static Map&lt;String, Boolean&gt; computePartyLeaders(final ApplicationManager applicationManager, final Iterable&lt;String&gt; personIds) {
<span class="fc" id="L60">        final Map&lt;String, Boolean&gt; result = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L61" title="All 2 branches covered.">        for (final String personId : personIds) {</span>
<span class="fc" id="L62">            result.put(personId, isPartyLeader(applicationManager, personId));</span>
<span class="fc" id="L63">        }</span>
<span class="fc" id="L64">        return result;</span>
    }

    /**
     * Gets the active roles.
     *
     * @param applicationManager the application manager
     * @param personId the person id
     * @return the active roles
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    private static List&lt;ViewRiksdagenPartyRoleMember&gt; getActiveRoles(final ApplicationManager applicationManager, final String personId) {
<span class="fc" id="L76">        return applicationManager.getDataContainer(ViewRiksdagenPartyRoleMember.class)</span>
<span class="fc" id="L77">                .findListByProperty(</span>
                    new Object[] { personId, Boolean.TRUE },
                    ViewRiksdagenPartyRoleMember_.personId,
                    ViewRiksdagenPartyRoleMember_.active
                );
    }

    /**
     * Checks if is party leader role.
     *
     * @param role the role
     * @return true, if is party leader role
     */
    private static boolean isPartyLeaderRole(final ViewRiksdagenPartyRoleMember role) {
<span class="pc bpc" id="L91" title="1 of 4 branches missed.">        return role.getRoleCode() != null &amp;&amp; ROLE_CODE_PARTILEDARE.equalsIgnoreCase(role.getRoleCode().trim());</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>